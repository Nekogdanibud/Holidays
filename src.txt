–û–¢–ß–ï–¢ –û –§–ê–ô–õ–ê–•
–ü–∞–ø–∫–∞: /OTPUSK/otpusk-app/Holidays/src
–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: 10/12/2025, 12:09:53 AM
–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤: 61
–ò—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ –ø–∞–ø–∫–∏: node_modules, dist, build, .git, .next, cache, temp
–ò—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã: global.css, favicon.ico
================================================================================


================================================================================
–§–ê–ô–õ: app/api/auth/login/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/auth/login/route.js
–†–ê–ó–ú–ï–†: 2408 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/auth/login/route.js
import { NextResponse } from 'next/server';
import { verifyPassword, createSession } from '../../../../lib/auth';
import { prisma } from '../../../../lib/prisma';

export async function POST(request) {
  try {
    const { email, password, rememberMe = false } = await request.json();

    // –í–∞–ª–∏–¥–∞—Ü–∏—è
    if (!email || !password) {
      return NextResponse.json(
        { message: 'Email –∏ –ø–∞—Ä–æ–ª—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã' },
        { status: 400 }
      );
    }

    // –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const user = await prisma.user.findUnique({
      where: { email }
    });

    if (!user) {
      return NextResponse.json(
        { message: '–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å' },
        { status: 401 }
      );
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è
    const isPasswordValid = await verifyPassword(password, user.password);
    if (!isPasswordValid) {
      return NextResponse.json(
        { message: '–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å' },
        { status: 401 }
      );
    }

    // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∏–µ–Ω—Ç–µ
    const userAgent = request.headers.get('user-agent');
    const ipAddress = request.headers.get('x-forwarded-for') || request.ip;

    // –°–æ–∑–¥–∞–µ–º —Å–µ—Å—Å–∏—é —Å —É—á–µ—Ç–æ–º rememberMe
    const { accessToken, refreshToken, sessionId } = await createSession(
      user.id, 
      userAgent, 
      ipAddress,
      rememberMe
    );

    const userData = {
      id: user.id,
      name: user.name,
      email: user.email,
      createdAt: user.createdAt
    };

    const response = NextResponse.json(
      { 
        message: '–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ',
        user: userData
      },
      { status: 200 }
    );

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º httpOnly –∫—É–∫–∏ —Å —Ä–∞–∑–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏
    response.cookies.set('accessToken', accessToken, {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
      sameSite: 'lax',
      maxAge: 60 * 60 * 1000 // 1 —á–∞—Å
    });

    response.cookies.set('refreshToken', refreshToken, {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
      sameSite: 'lax',
      maxAge: rememberMe 
        ? 365 * 24 * 60 * 60 * 1000 // 1 –≥–æ–¥ –¥–ª—è "–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è"
        : 30 * 24 * 60 * 60 * 1000 // 30 –¥–Ω–µ–π –¥–ª—è –æ–±—ã—á–Ω–æ–π —Å–µ—Å—Å–∏–∏
    });

    return response;

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/auth/logout/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/auth/logout/route.js
–†–ê–ó–ú–ï–†: 1175 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/auth/logout/route.js
import { NextResponse } from 'next/server';
import { deleteSession } from '../../../../lib/auth';

export async function POST(request) {
  try {
    const accessToken = request.cookies.get('accessToken')?.value;

    if (accessToken) {
      const { verifyAccessToken } = await import('../../../../lib/auth');
      const decoded = verifyAccessToken(accessToken);
      
      if (decoded?.sessionId) {
        await deleteSession(decoded.sessionId);
      }
    }

    const response = NextResponse.json(
      { message: '–í—ã—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ' },
      { status: 200 }
    );

    // –û—á–∏—â–∞–µ–º –∫—É–∫–∏
    response.cookies.set('accessToken', '', {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
      sameSite: 'lax',
      maxAge: 0
    });

    response.cookies.set('refreshToken', '', {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
      sameSite: 'lax',
      maxAge: 0
    });

    return response;

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/auth/me/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/auth/me/route.js
–†–ê–ó–ú–ï–†: 1570 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/auth/me/route.js
import { NextResponse } from 'next/server';
import { verifyAccessToken } from '../../../../lib/auth';
import { prisma } from '../../../../lib/prisma';

export async function GET(request) {
  try {
    console.log('üîç Checking auth...');
    
    const accessToken = request.cookies.get('accessToken')?.value;
    console.log('Access token exists:', !!accessToken);

    if (!accessToken) {
      console.log('‚ùå No access token');
      return NextResponse.json(
        { message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' },
        { status: 401 }
      );
    }

    const decoded = verifyAccessToken(accessToken);
    console.log('Decoded token:', decoded);

    if (!decoded) {
      console.log('‚ùå Invalid token');
      return NextResponse.json(
        { message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' },
        { status: 401 }
      );
    }

    // –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –±–∞–∑—ã
    console.log('üë§ Fetching user:', decoded.userId);
    const user = await prisma.user.findUnique({
      where: { id: decoded.userId },
      select: {
        id: true,
        name: true,
        email: true,
        avatar: true,
        createdAt: true
      }
    });

    console.log('User found:', !!user);

    if (!user) {
      return NextResponse.json(
        { message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω' },
        { status: 404 }
      );
    }

    return NextResponse.json(user);

  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/auth/refresh/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/auth/refresh/route.js
–†–ê–ó–ú–ï–†: 1271 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/auth/refresh/route.js
import { NextResponse } from 'next/server';
import { verifySession, generateAccessToken } from '../../../../lib/auth';

export async function POST(request) {
  try {
    const refreshToken = request.cookies.get('refreshToken')?.value;

    if (!refreshToken) {
      return NextResponse.json(
        { message: 'Refresh token –Ω–µ –Ω–∞–π–¥–µ–Ω' },
        { status: 401 }
      );
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ—Å—Å–∏—é
    const session = await verifySession(refreshToken);
    if (!session) {
      return NextResponse.json(
        { message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞—è —Å–µ—Å—Å–∏—è' },
        { status: 401 }
      );
    }

    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π access token
    const newAccessToken = generateAccessToken(session.userId, session.id);

    const response = NextResponse.json(
      { message: 'Token –æ–±–Ω–æ–≤–ª–µ–Ω' },
      { status: 200 }
    );

    response.cookies.set('accessToken', newAccessToken, {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
      sameSite: 'lax',
      maxAge: 60 * 60 * 1000 // 1 —á–∞—Å
    });

    return response;

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/auth/register/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/auth/register/route.js
–†–ê–ó–ú–ï–†: 2835 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/auth/register/route.js
import { NextResponse } from 'next/server';
import { hashPassword, createSession } from '../../../../lib/auth';
import { prisma } from '../../../../lib/prisma';

export async function POST(request) {
  try {
    const { name, email, password, rememberMe = false } = await request.json();

    // –í–∞–ª–∏–¥–∞—Ü–∏—è
    if (!name || !email || !password) {
      return NextResponse.json(
        { message: '–í—Å–µ –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è' },
        { status: 400 }
      );
    }

    if (password.length < 6) {
      return NextResponse.json(
        { message: '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤' },
        { status: 400 }
      );
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const existingUser = await prisma.user.findUnique({
      where: { email }
    });

    if (existingUser) {
      return NextResponse.json(
        { message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç' },
        { status: 409 }
      );
    }

    // –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è
    const hashedPassword = await hashPassword(password);

    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const newUser = await prisma.user.create({
      data: {
        name,
        email,
        password: hashedPassword,
      },
      select: {
        id: true,
        name: true,
        email: true,
        createdAt: true
      }
    });

    // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª–∏–µ–Ω—Ç–µ
    const userAgent = request.headers.get('user-agent');
    const ipAddress = request.headers.get('x-forwarded-for') || request.ip;

    // –°–æ–∑–¥–∞–µ–º —Å–µ—Å—Å–∏—é —Å —É—á–µ—Ç–æ–º rememberMe
    const { accessToken, refreshToken, sessionId } = await createSession(
      newUser.id, 
      userAgent, 
      ipAddress,
      rememberMe
    );

    const response = NextResponse.json(
      { 
        message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω',
        user: newUser
      },
      { status: 201 }
    );

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º httpOnly –∫—É–∫–∏ —Å —Ä–∞–∑–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏
    response.cookies.set('accessToken', accessToken, {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
      sameSite: 'lax',
      maxAge: 60 * 60 * 1000 // 1 —á–∞—Å
    });

    response.cookies.set('refreshToken', refreshToken, {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
      sameSite: 'lax',
      maxAge: rememberMe 
        ? 365 * 24 * 60 * 60 * 1000 // 1 –≥–æ–¥ –¥–ª—è "–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è"
        : 30 * 24 * 60 * 60 * 1000 // 30 –¥–Ω–µ–π –¥–ª—è –æ–±—ã—á–Ω–æ–π —Å–µ—Å—Å–∏–∏
    });

    return response;

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
    
    if (error.code === 'P2002') {
      return NextResponse.json(
        { message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç' },
        { status: 409 }
      );
    }

    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/auth/sessions/all/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/auth/sessions/all/route.js
–†–ê–ó–ú–ï–†: 1334 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/auth/sessions/all/route.js
import { NextResponse } from 'next/server';
import { deleteAllUserSessions } from '../../../../../lib/auth';
import { verifyAccessToken } from '../../../../../lib/auth';

// –£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫—Ä–æ–º–µ —Ç–µ–∫—É—â–µ–π)
export async function DELETE(request) {
  try {
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json(
        { message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' },
        { status: 401 }
      );
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json(
        { message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' },
        { status: 401 }
      );
    }

    // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const { getUserSessions, deleteSession } = await import('../../../../../lib/auth');
    const sessions = await getUserSessions(decoded.userId);

    // –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å–µ—Å—Å–∏–∏ –∫—Ä–æ–º–µ —Ç–µ–∫—É—â–µ–π
    for (const session of sessions) {
      if (session.id !== decoded.sessionId) {
        await deleteSession(session.id);
      }
    }

    return NextResponse.json({ message: '–í—Å–µ –¥—Ä—É–≥–∏–µ —Å–µ—Å—Å–∏–∏ —É–¥–∞–ª–µ–Ω—ã' });

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–π:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/auth/sessions/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/auth/sessions/route.js
–†–ê–ó–ú–ï–†: 1817 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/auth/sessions/route.js
import { NextResponse } from 'next/server';
import { getUserSessions, deleteSession, deleteAllUserSessions } from '../../../../lib/auth';
import { verifyAccessToken } from '../../../../lib/auth';

// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
export async function GET(request) {
  try {
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json(
        { message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' },
        { status: 401 }
      );
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json(
        { message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' },
        { status: 401 }
      );
    }

    const sessions = await getUserSessions(decoded.userId);

    return NextResponse.json({ sessions });

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Å—Å–∏–π:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}

// –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Å–µ—Å—Å–∏—é
export async function DELETE(request) {
  try {
    const accessToken = request.cookies.get('accessToken')?.value;
    const { sessionId } = await request.json();

    if (!accessToken) {
      return NextResponse.json(
        { message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' },
        { status: 401 }
      );
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json(
        { message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' },
        { status: 401 }
      );
    }

    await deleteSession(sessionId);

    return NextResponse.json({ message: '–°–µ—Å—Å–∏—è —É–¥–∞–ª–µ–Ω–∞' });

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/invitations/[id]/respond/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/invitations/[id]/respond/route.js
–†–ê–ó–ú–ï–†: 4777 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/invitations/[id]/respond/route.js
import { NextResponse } from 'next/server';
import { verifyAccessToken } from '@/lib/auth';
import { prisma } from '@/lib/prisma';

export async function POST(request, { params }) {
  try {
    const { id: invitationId } = await params;
    const { accept } = await request.json();
    
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json({ message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' }, { status: 401 });
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json({ message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' }, { status: 401 });
    }

    // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏–∑ –±–∞–∑—ã
    const user = await prisma.user.findUnique({
      where: { id: decoded.userId },
      select: { id: true, name: true, email: true }
    });

    if (!user) {
      return NextResponse.json({ message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω' }, { status: 404 });
    }

    // –ù–∞—Ö–æ–¥–∏–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
    const invitation = await prisma.invitation.findFirst({
      where: {
        id: invitationId,
        email: user.email // –ò—Å–ø–æ–ª—å–∑—É–µ–º email –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
      },
      include: {
        vacation: true,
        invitedBy: {
          select: { name: true }
        }
      }
    });

    if (!invitation) {
      return NextResponse.json({ message: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ' }, { status: 404 });
    }

    if (invitation.status !== 'pending') {
      return NextResponse.json({ message: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ' }, { status: 400 });
    }

    if (new Date() > invitation.expiresAt) {
      return NextResponse.json({ message: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –∏—Å—Ç–µ–∫–ª–æ' }, { status: 400 });
    }

    if (accept) {
      // –ü—Ä–∏–Ω–∏–º–∞–µ–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
      await prisma.$transaction(async (tx) => {
        // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ —É—á–∞—Å—Ç–Ω–∏–∫–∞
        await tx.vacationMember.create({
          data: {
            vacationId: invitation.vacationId,
            userId: user.id,
            role: 'member',
            status: 'accepted',
            joinedAt: new Date()
          }
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
        await tx.invitation.update({
          where: { id: invitationId },
          data: { status: 'accepted' }
        });

        // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞
        await tx.notification.create({
          data: {
            userId: invitation.invitedById,
            type: 'info',
            title: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ',
            message: `${user.name} –ø—Ä–∏–Ω—è–ª(–∞) –≤–∞—à–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –æ—Ç–ø—É—Å–∫ "${invitation.vacation.title}"`,
            data: {
              vacationId: invitation.vacationId,
              acceptedByName: user.name
            }
          }
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        await tx.notification.updateMany({
          where: {
            userId: user.id,
            type: 'invitation',
            data: {
              path: ['invitationId'],
              equals: invitationId
            }
          },
          data: {
            data: {
              ...invitation.data,
              status: 'accepted'
            }
          }
        });
      });

      return NextResponse.json({ 
        message: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ',
        vacationId: invitation.vacationId
      });
    } else {
      // –û—Ç–∫–ª–æ–Ω—è–µ–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
      await prisma.$transaction(async (tx) => {
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
        await tx.invitation.update({
          where: { id: invitationId },
          data: { status: 'rejected' }
        });

        // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞
        await tx.notification.create({
          data: {
            userId: invitation.invitedById,
            type: 'info',
            title: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ',
            message: `${user.name} –æ—Ç–∫–ª–æ–Ω–∏–ª(–∞) –≤–∞—à–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –æ—Ç–ø—É—Å–∫ "${invitation.vacation.title}"`,
            data: {
              vacationId: invitation.vacationId,
              rejectedByName: user.name
            }
          }
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        await tx.notification.updateMany({
          where: {
            userId: user.id,
            type: 'invitation',
            data: {
              path: ['invitationId'],
              equals: invitationId
            }
          },
          data: {
            data: {
              ...invitation.data,
              status: 'rejected'
            }
          }
        });
      });

      return NextResponse.json({ message: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ' });
    }

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/invitations/[id]/respond/route.js1
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/invitations/[id]/respond/route.js1
–†–ê–ó–ú–ï–†: 4583 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/invitations/[id]/respond/route.js
import { NextResponse } from 'next/server';
import { verifyAccessToken } from '@/lib/auth';
import { prisma } from '@/lib/prisma';

export async function POST(request, { params }) {
  try {
    // Await params –¥–ª—è Next.js 15
    const { id: invitationId } = await params;
    const { accept } = await request.json();
    
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json({ message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' }, { status: 401 });
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json({ message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' }, { status: 401 });
    }

    // –ù–∞—Ö–æ–¥–∏–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
    const invitation = await prisma.invitation.findFirst({
      where: {
        id: invitationId,
        email: decoded.user.email // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      },
      include: {
        vacation: true,
        invitedBy: {
          select: { name: true }
        }
      }
    });

    if (!invitation) {
      return NextResponse.json({ message: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ' }, { status: 404 });
    }

    if (invitation.status !== 'pending') {
      return NextResponse.json({ message: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ' }, { status: 400 });
    }

    if (new Date() > invitation.expiresAt) {
      return NextResponse.json({ message: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –∏—Å—Ç–µ–∫–ª–æ' }, { status: 400 });
    }

    if (accept) {
      // –ü—Ä–∏–Ω–∏–º–∞–µ–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
      await prisma.$transaction(async (tx) => {
        // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ —É—á–∞—Å—Ç–Ω–∏–∫–∞
        await tx.vacationMember.create({
          data: {
            vacationId: invitation.vacationId,
            userId: decoded.userId,
            role: 'member',
            status: 'accepted',
            joinedAt: new Date()
          }
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
        await tx.invitation.update({
          where: { id: invitationId },
          data: { status: 'accepted' }
        });

        // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞
        await tx.notification.create({
          data: {
            userId: invitation.invitedById,
            type: 'info',
            title: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ',
            message: `${decoded.user.name} –ø—Ä–∏–Ω—è–ª(–∞) –≤–∞—à–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –æ—Ç–ø—É—Å–∫ "${invitation.vacation.title}"`,
            data: {
              vacationId: invitation.vacationId,
              acceptedByName: decoded.user.name
            }
          }
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        await tx.notification.updateMany({
          where: {
            userId: decoded.userId,
            type: 'invitation',
            data: {
              path: ['invitationId'],
              equals: invitationId
            }
          },
          data: {
            data: {
              ...invitation.data,
              status: 'accepted'
            }
          }
        });
      });

      return NextResponse.json({ 
        message: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ',
        vacationId: invitation.vacationId
      });
    } else {
      // –û—Ç–∫–ª–æ–Ω—è–µ–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
      await prisma.$transaction(async (tx) => {
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
        await tx.invitation.update({
          where: { id: invitationId },
          data: { status: 'rejected' }
        });

        // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞
        await tx.notification.create({
          data: {
            userId: invitation.invitedById,
            type: 'info',
            title: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ',
            message: `${decoded.user.name} –æ—Ç–∫–ª–æ–Ω–∏–ª(–∞) –≤–∞—à–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –æ—Ç–ø—É—Å–∫ "${invitation.vacation.title}"`,
            data: {
              vacationId: invitation.vacationId,
              rejectedByName: decoded.user.name
            }
          }
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        await tx.notification.updateMany({
          where: {
            userId: decoded.userId,
            type: 'invitation',
            data: {
              path: ['invitationId'],
              equals: invitationId
            }
          },
          data: {
            data: {
              ...invitation.data,
              status: 'rejected'
            }
          }
        });
      });

      return NextResponse.json({ message: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ' });
    }

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/memories/capture/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/memories/capture/route.js
–†–ê–ó–ú–ï–†: 3546 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/memories/capture/route.js
import { NextResponse } from 'next/server';
import { writeFile, mkdir } from 'fs/promises';
import { join } from 'path';
import { verifyAccessToken } from '../../../lib/auth';
import { prisma } from '../../../lib/prisma';

export async function POST(request) {
  try {
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json({ message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' }, { status: 401 });
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json({ message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' }, { status: 401 });
    }

    const formData = await request.formData();
    const vacationId = formData.get('vacationId');
    const photos = formData.getAll('photos');

    if (!vacationId || photos.length === 0) {
      return NextResponse.json(
        { message: '–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ' },
        { status: 400 }
      );
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø –∫ –æ—Ç–ø—É—Å–∫—É
    const vacationAccess = await prisma.vacation.findFirst({
      where: {
        id: vacationId,
        OR: [
          { userId: decoded.userId },
          { members: { some: { userId: decoded.userId, status: 'accepted' } } }
        ]
      }
    });

    if (!vacationAccess) {
      return NextResponse.json({ message: '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω' }, { status: 403 });
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–∏–º–∏—Ç —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –Ω–∞ –¥–µ–Ω—å (3 —Ñ–æ—Ç–æ)
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    const tomorrow = new Date(today);
    tomorrow.setDate(tomorrow.getDate() + 1);

    const todayMemories = await prisma.memory.count({
      where: {
        vacationId,
        authorId: decoded.userId,
        createdAt: {
          gte: today,
          lt: tomorrow
        }
      }
    });

    if (todayMemories + photos.length > 3) {
      return NextResponse.json(
        { message: '–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –≤ 3 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –≤ –¥–µ–Ω—å' },
        { status: 400 }
      );
    }

    const createdMemories = [];

    // –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –∑–∞–≥—Ä—É–∑–æ–∫ –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
    const uploadDir = join(process.cwd(), 'public', 'uploads', 'memories');
    try {
      await mkdir(uploadDir, { recursive: true });
    } catch (error) {
      // –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    }

    for (const photo of photos) {
      const bytes = await photo.arrayBuffer();
      const buffer = Buffer.from(bytes);
      
      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞
      const timestamp = Date.now();
      const filename = `${timestamp}-${photo.name}`;
      const filepath = join(uploadDir, filename);

      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª
      await writeFile(filepath, buffer);

      // –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å –≤ –±–∞–∑–µ
      const memory = await prisma.memory.create({
        data: {
          title: `–§–æ—Ç–æ –¥–Ω—è - ${new Date().toLocaleDateString('ru-RU')}`,
          description: '–ó–∞–ø–µ—á–∞—Ç–ª–µ–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç',
          imageUrl: `/uploads/memories/${filename}`,
          takenAt: new Date(),
          vacationId,
          authorId: decoded.userId,
          tags: ['captured_moment']
        },
        include: {
          author: {
            select: { id: true, name: true, avatar: true }
          }
        }
      });

      createdMemories.push(memory);
    }

    return NextResponse.json({ 
      message: '–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã',
      memories: createdMemories 
    }, { status: 201 });

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/notifications/invite/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/notifications/invite/route.js
–†–ê–ó–ú–ï–†: 1259 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/notifications/invite/route.js
import { NextResponse } from 'next/server';
import { prisma } from '../../../../lib/prisma';

export async function POST(request) {
  try {
    const { userId, vacationId, invitedByName, vacationTitle } = await request.json();

    if (!userId || !vacationId || !invitedByName) {
      return NextResponse.json(
        { message: '–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ' },
        { status: 400 }
      );
    }

    // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–∏
    const notification = await prisma.notification.create({
      data: {
        userId,
        type: 'invitation',
        title: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –æ—Ç–ø—É—Å–∫',
        message: `${invitedByName} –ø—Ä–∏–≥–ª–∞—Å–∏–ª(–∞) –≤–∞—Å –≤ –æ—Ç–ø—É—Å–∫ "${vacationTitle}"`,
        data: {
          vacationId,
          invitedByName,
          vacationTitle
        }
      },
      include: {
        user: {
          select: { 
            id: true, 
            name: true, 
            avatar: true 
          }
        }
      }
    });

    return NextResponse.json(notification, { status: 201 });

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/notifications/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/notifications/route.js
–†–ê–ó–ú–ï–†: 2505 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/notifications/route.js
import { NextResponse } from 'next/server';
import { verifyAccessToken } from '../../../lib/auth';
import { prisma } from '../../../lib/prisma';

// –ü–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
export async function GET(request) {
  try {
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json({ message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' }, { status: 401 });
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json({ message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' }, { status: 401 });
    }

    const notifications = await prisma.notification.findMany({
      where: { 
        userId: decoded.userId 
      },
      orderBy: { 
        createdAt: 'desc' 
      },
      include: {
        user: {
          select: { 
            id: true, 
            name: true, 
            avatar: true 
          }
        }
      },
      take: 50
    });

    return NextResponse.json(notifications);

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}

// –ü–æ–º–µ—Ç–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
export async function PUT(request) {
  try {
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json({ message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' }, { status: 401 });
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json({ message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' }, { status: 401 });
    }

    const { notificationIds } = await request.json();

    if (notificationIds && notificationIds.length > 0) {
      // –ü–æ–º–µ—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
      await prisma.notification.updateMany({
        where: { 
          id: { in: notificationIds },
          userId: decoded.userId 
        },
        data: { isRead: true }
      });
    } else {
      // –ü–æ–º–µ—Ç–∏—Ç—å –≤—Å–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
      await prisma.notification.updateMany({
        where: { 
          userId: decoded.userId,
          isRead: false 
        },
        data: { isRead: true }
      });
    }

    return NextResponse.json({ message: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ' });

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/notifications/test/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/notifications/test/route.js
–†–ê–ó–ú–ï–†: 2783 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/notifications/test/route.js
import { NextResponse } from 'next/server';
import { verifyAccessToken } from '../../../../lib/auth';
import { prisma } from '../../../../lib/prisma';

export async function POST(request) {
  try {
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json({ message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' }, { status: 401 });
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json({ message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' }, { status: 401 });
    }

    const { type = 'info' } = await request.json();

    // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    let notificationData;

    switch (type) {
      case 'invitation':
        notificationData = {
          userId: decoded.userId,
          type: 'invitation',
          title: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –æ—Ç–ø—É—Å–∫',
          message: '–ê–Ω–Ω–∞ –ø—Ä–∏–≥–ª–∞—Å–∏–ª–∞ –≤–∞—Å –≤ –æ—Ç–ø—É—Å–∫ "–û—Ç–¥—ã—Ö –Ω–∞ –ë–∞–ª–∏"',
          data: {
            invitationId: 'test-invitation-123',
            vacationId: 'test-vacation-456',
            invitedByName: '–ê–Ω–Ω–∞',
            vacationTitle: '–û—Ç–¥—ã—Ö –Ω–∞ –ë–∞–ª–∏'
          }
        };
        break;

      case 'activity_update':
        notificationData = {
          userId: decoded.userId,
          type: 'activity_update',
          title: '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤',
          message: '–í –≤–∞—à–µ–º –æ—Ç–ø—É—Å–∫–µ "–ì–æ—Ä–Ω—ã–µ –ø–æ—Ö–æ–¥—ã" –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
          data: {
            vacationId: 'test-vacation-789',
            activityId: 'test-activity-123'
          }
        };
        break;

      case 'memory_comment':
        notificationData = {
          userId: decoded.userId,
          type: 'memory_comment',
          title: '–ù–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π',
          message: '–ò–≤–∞–Ω –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª –≤–∞—à–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ',
          data: {
            memoryId: 'test-memory-123',
            commentId: 'test-comment-456'
          }
        };
        break;

      default:
        notificationData = {
          userId: decoded.userId,
          type: 'info',
          title: '–¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ',
          message: '–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏—Å—Ç–µ–º—ã',
          data: {
            test: true
          }
        };
    }

    const notification = await prisma.notification.create({
      data: notificationData,
      include: {
        user: {
          select: { 
            id: true, 
            name: true, 
            avatar: true 
          }
        }
      }
    });

    return NextResponse.json({
      message: '–¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ',
      notification
    });

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/route.js
–†–ê–ó–ú–ï–†: 2924 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/activities/route.js
import { NextResponse } from 'next/server';
import { verifyAccessToken } from '../../../lib/auth';
import { prisma } from '../../../lib/prisma';

export async function POST(request) {
  try {
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json({ message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' }, { status: 401 });
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json({ message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' }, { status: 401 });
    }

    const { title, description, date, type, vacationId, locationId } = await request.json();

    if (!title || !date || !type || !vacationId) {
      return NextResponse.json(
        { message: '–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: –Ω–∞–∑–≤–∞–Ω–∏–µ, –¥–∞—Ç–∞, —Ç–∏–ø –∏ ID –æ—Ç–ø—É—Å–∫–∞' },
        { status: 400 }
      );
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø –∫ –æ—Ç–ø—É—Å–∫—É
    const vacationAccess = await prisma.vacation.findFirst({
      where: {
        id: vacationId,
        OR: [
          { userId: decoded.userId },
          { members: { some: { userId: decoded.userId, status: 'accepted' } } }
        ]
      }
    });

    if (!vacationAccess) {
      return NextResponse.json({ message: '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω' }, { status: 403 });
    }

    // –°–æ–∑–¥–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
    const activity = await prisma.activity.create({
      data: {
        title,
        description,
        date: new Date(date),
        type,
        vacationId,
        locationId: locationId || null
      },
      include: {
        location: {
          select: { id: true, name: true, address: true }
        },
        participants: {
          include: {
            user: {
              select: { id: true, name: true, avatar: true }
            }
          }
        }
      }
    });

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º —Å–æ–∑–¥–∞—Ç–µ–ª—è –∫–∞–∫ —É—á–∞—Å—Ç–Ω–∏–∫–∞
    await prisma.activityParticipant.create({
      data: {
        activityId: activity.id,
        userId: decoded.userId,
        status: 'going'
      }
    });

    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏
    const updatedActivity = await prisma.activity.findUnique({
      where: { id: activity.id },
      include: {
        location: {
          select: { id: true, name: true, address: true }
        },
        participants: {
          include: {
            user: {
              select: { id: true, name: true, avatar: true }
            }
          }
        }
      }
    });

    // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–ª—è –æ—Ç–≤–µ—Ç–∞
    const formattedActivity = {
      ...updatedActivity,
      author: updatedActivity.participants[0]?.user || null,
      participants: updatedActivity.participants.map(p => p.user)
    };

    return NextResponse.json(formattedActivity, { status: 201 });

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/vacations/[id]/activities/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/vacations/[id]/activities/route.js
–†–ê–ó–ú–ï–†: 2063 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/vacations/[id]/activities/route.js
import { NextResponse } from 'next/server';
import { verifyAccessToken } from '../../../../../lib/auth';
import { prisma } from '../../../../../lib/prisma';

export async function GET(request, { params }) {
  try {
    const { id } = await params;
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json({ message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' }, { status: 401 });
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json({ message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' }, { status: 401 });
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø –∫ –æ—Ç–ø—É—Å–∫—É
    const vacationAccess = await prisma.vacation.findFirst({
      where: {
        id: id,
        OR: [
          { userId: decoded.userId },
          { members: { some: { userId: decoded.userId, status: 'accepted' } } }
        ]
      }
    });

    if (!vacationAccess) {
      return NextResponse.json({ message: '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω' }, { status: 403 });
    }

    // –ò–°–ü–†–ê–í–õ–ï–ù–û: –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –º–æ–¥–µ–ª–∏ Activity
    const activities = await prisma.activity.findMany({
      where: { vacationId: id },
      orderBy: { date: 'asc' },
      include: {
        location: {
          select: { id: true, name: true, address: true }
        },
        participants: {
          include: {
            user: {
              select: { id: true, name: true, avatar: true }
            }
          }
        }
      }
    });

    // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    const formattedActivities = activities.map(activity => ({
      ...activity,
      // –ë–µ—Ä–µ–º –ø–µ—Ä–≤–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∫–∞–∫ "–∞–≤—Ç–æ—Ä–∞" –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
      author: activity.participants[0]?.user || null,
      participants: activity.participants.map(p => p.user)
    }));

    return NextResponse.json(formattedActivities);

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/vacations/[id]/invite/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/vacations/[id]/invite/route.js
–†–ê–ó–ú–ï–†: 3568 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/vacations/[id]/invite/route.js
import { NextResponse } from 'next/server';
import { verifyAccessToken } from '../../../../../lib/auth';
import { prisma } from '../../../../../lib/prisma';
import { randomBytes } from 'crypto';

export async function POST(request, { params }) {
  try {
    // Await params –¥–ª—è Next.js 15
    const { id: vacationId } = await params;
    const { email } = await request.json();
    
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json({ message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' }, { status: 401 });
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json({ message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' }, { status: 401 });
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å - –≤–ª–∞–¥–µ–ª–µ—Ü –æ—Ç–ø—É—Å–∫–∞
    const vacation = await prisma.vacation.findFirst({
      where: {
        id: vacationId,
        userId: decoded.userId
      },
      include: {
        user: {
          select: { name: true }
        }
      }
    });

    if (!vacation) {
      return NextResponse.json({ message: '–û—Ç–ø—É—Å–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ—Ç –ø—Ä–∞–≤' }, { status: 404 });
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email
    const invitedUser = await prisma.user.findUnique({
      where: { email }
    });

    if (!invitedUser) {
      return NextResponse.json({ message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω' }, { status: 404 });
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω –ª–∏ —É–∂–µ —ç—Ç–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    const existingInvitation = await prisma.invitation.findFirst({
      where: {
        vacationId,
        email
      }
    });

    if (existingInvitation) {
      return NextResponse.json({ message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω' }, { status: 409 });
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–º
    const existingMember = await prisma.vacationMember.findFirst({
      where: {
        vacationId,
        userId: invitedUser.id
      }
    });

    if (existingMember) {
      return NextResponse.json({ message: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —è–≤–ª—è–µ—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–º' }, { status: 409 });
    }

    // –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
    const token = randomBytes(32).toString('hex');
    const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000); // 7 –¥–Ω–µ–π

    const invitation = await prisma.invitation.create({
      data: {
        vacationId,
        email,
        token,
        invitedById: decoded.userId,
        expiresAt
      }
    });

    // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const notification = await prisma.notification.create({
      data: {
        userId: invitedUser.id,
        type: 'invitation',
        title: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –æ—Ç–ø—É—Å–∫',
        message: `${vacation.user.name} –ø—Ä–∏–≥–ª–∞—Å–∏–ª(–∞) –≤–∞—Å –≤ –æ—Ç–ø—É—Å–∫ "${vacation.title}"`,
        data: {
          invitationId: invitation.id,
          vacationId: vacation.id,
          invitedByName: vacation.user.name,
          vacationTitle: vacation.title
        }
      },
      include: {
        user: {
          select: { 
            id: true, 
            name: true, 
            avatar: true 
          }
        }
      }
    });

    return NextResponse.json({ 
      message: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ',
      invitation: {
        id: invitation.id,
        email: invitation.email,
        status: invitation.status
      },
      notification
    });

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/vacations/[id]/members/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/vacations/[id]/members/route.js
–†–ê–ó–ú–ï–†: 1629 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/vacations/[id]/members/route.js
import { NextResponse } from 'next/server';
import { verifyAccessToken } from '../../../../../lib/auth';
import { prisma } from '../../../../../lib/prisma';

export async function GET(request, { params }) {
  try {
    // Await params –¥–ª—è Next.js 15
    const { id } = await params;
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json({ message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' }, { status: 401 });
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json({ message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' }, { status: 401 });
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø –∫ –æ—Ç–ø—É—Å–∫—É
    const vacationAccess = await prisma.vacation.findFirst({
      where: {
        id: id,
        OR: [
          { userId: decoded.userId },
          { members: { some: { userId: decoded.userId, status: 'accepted' } } }
        ]
      }
    });

    if (!vacationAccess) {
      return NextResponse.json({ message: '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω' }, { status: 403 });
    }

    const members = await prisma.vacationMember.findMany({
      where: { vacationId: id },
      include: {
        user: {
          select: { 
            id: true, 
            name: true, 
            email: true, 
            avatar: true 
          }
        }
      },
      orderBy: { createdAt: 'asc' }
    });

    return NextResponse.json(members);

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/vacations/[id]/memories/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/vacations/[id]/memories/route.js
–†–ê–ó–ú–ï–†: 1553 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/vacations/[id]/memories/route.js
import { NextResponse } from 'next/server';
import { verifyAccessToken } from '../../../../../lib/auth';
import { prisma } from '../../../../../lib/prisma';

export async function GET(request, { params }) {
  try {
    // Await params –¥–ª—è Next.js 15
    const { id } = await params;
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json({ message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' }, { status: 401 });
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json({ message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' }, { status: 401 });
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø –∫ –æ—Ç–ø—É—Å–∫—É
    const vacationAccess = await prisma.vacation.findFirst({
      where: {
        id: id,
        OR: [
          { userId: decoded.userId },
          { members: { some: { userId: decoded.userId, status: 'accepted' } } }
        ]
      }
    });

    if (!vacationAccess) {
      return NextResponse.json({ message: '–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω' }, { status: 403 });
    }

    const memories = await prisma.memory.findMany({
      where: { vacationId: id },
      orderBy: { createdAt: 'desc' },
      include: {
        author: {
          select: { id: true, name: true, avatar: true }
        }
      }
    });

    return NextResponse.json(memories);

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/vacations/[id]/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/vacations/[id]/route.js
–†–ê–ó–ú–ï–†: 3109 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/vacations/[id]/route.js
import { NextResponse } from 'next/server';
import { verifyAccessToken } from '../../../../lib/auth';
import { prisma } from '../../../../lib/prisma';

export async function GET(request, { params }) {
  try {
    const { id } = await params;
    console.log('üîç –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–ø—É—Å–∫–∞ —Å ID:', id);
    
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      console.log('‚ùå –ù–µ—Ç access token');
      return NextResponse.json({ message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' }, { status: 401 });
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      console.log('‚ùå –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π —Ç–æ–∫–µ–Ω');
      return NextResponse.json({ message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' }, { status: 401 });
    }

    console.log('üë§ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', decoded.userId);

    const vacation = await prisma.vacation.findFirst({
      where: {
        id: id,
        OR: [
          { userId: decoded.userId },
          { members: { some: { userId: decoded.userId, status: 'accepted' } } }
        ]
      },
      include: {
        user: {
          select: { id: true, name: true, email: true, avatar: true }
        },
        members: {
          where: { status: 'accepted' },
          include: {
            user: {
              select: { id: true, name: true, email: true, avatar: true }
            }
          }
        },
        activities: {
          orderBy: { date: 'asc' },
          take: 10,
          include: {
            // –ò–°–ü–†–ê–í–õ–ï–ù–û: –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –º–æ–¥–µ–ª–∏ Activity
            location: {
              select: { id: true, name: true, address: true }
            },
            participants: {
              include: {
                user: {
                  select: { id: true, name: true, avatar: true }
                }
              }
            }
          }
        },
        memories: {
          orderBy: { createdAt: 'desc' },
          take: 12,
          include: {
            author: {
              select: { id: true, name: true, avatar: true }
            }
          }
        },
        _count: {
          select: {
            activities: true,
            memories: true,
            members: true,
            locations: true
          }
        }
      }
    });

    if (!vacation) {
      console.log('‚ùå –û—Ç–ø—É—Å–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞');
      return NextResponse.json({ message: '–û—Ç–ø—É—Å–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω' }, { status: 404 });
    }

    // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
    const formattedVacation = {
      ...vacation,
      activities: vacation.activities.map(activity => ({
        ...activity,
        // –ë–µ—Ä–µ–º –ø–µ—Ä–≤–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∫–∞–∫ "–∞–≤—Ç–æ—Ä–∞" –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        author: activity.participants[0]?.user || null,
        participants: activity.participants.map(p => p.user)
      }))
    };

    console.log('‚úÖ –û—Ç–ø—É—Å–∫ –Ω–∞–π–¥–µ–Ω:', formattedVacation.title);
    return NextResponse.json(formattedVacation);

  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–ø—É—Å–∫–∞:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/api/vacations/route.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/api/vacations/route.js
–†–ê–ó–ú–ï–†: 4163 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/api/vacations/route.js
import { NextResponse } from 'next/server';
import { verifyAccessToken } from '../../../lib/auth';
import { prisma } from '../../../lib/prisma';

// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ—Ç–ø—É—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
export async function GET(request) {
  try {
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json(
        { message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' },
        { status: 401 }
      );
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json(
        { message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' },
        { status: 401 }
      );
    }

    // –ü–æ–ª—É—á–∞–µ–º –æ—Ç–ø—É—Å–∫–∏ –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–º
    const vacations = await prisma.vacation.findMany({
      where: {
        OR: [
          { userId: decoded.userId }, // –í–ª–∞–¥–µ–ª–µ—Ü
          { members: { some: { userId: decoded.userId, status: 'accepted' } } } // –£—á–∞—Å—Ç–Ω–∏–∫
        ]
      },
      include: {
        user: {
          select: {
            id: true,
            name: true,
            email: true
          }
        },
        members: {
          where: {
            status: 'accepted'
          },
          include: {
            user: {
              select: {
                id: true,
                name: true,
                email: true,
                avatar: true
              }
            }
          }
        },
        activities: {
          orderBy: { date: 'asc' }
        },
        memories: true,
        locations: true,
        _count: {
          select: {
            activities: true,
            memories: true,
            members: true,
            locations: true
          }
        }
      },
      orderBy: { startDate: 'asc' }
    });

    return NextResponse.json(vacations);

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–ø—É—Å–∫–æ–≤:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}

// –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –æ—Ç–ø—É—Å–∫
export async function POST(request) {
  try {
    const accessToken = request.cookies.get('accessToken')?.value;

    if (!accessToken) {
      return NextResponse.json(
        { message: '–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω' },
        { status: 401 }
      );
    }

    const decoded = verifyAccessToken(accessToken);
    if (!decoded) {
      return NextResponse.json(
        { message: '–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω' },
        { status: 401 }
      );
    }

    const { title, description, destination, startDate, endDate } = await request.json();

    if (!title || !startDate || !endDate) {
      return NextResponse.json(
        { message: '–ù–∞–∑–≤–∞–Ω–∏–µ –∏ –¥–∞—Ç—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã' },
        { status: 400 }
      );
    }

    // –°–æ–∑–¥–∞–µ–º –æ—Ç–ø—É—Å–∫
    const vacation = await prisma.vacation.create({
      data: {
        title,
        description,
        destination,
        startDate: new Date(startDate),
        endDate: new Date(endDate),
        userId: decoded.userId,
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∫–∞–∫ —É—á–∞—Å—Ç–Ω–∏–∫–∞
        members: {
          create: {
            userId: decoded.userId,
            role: 'owner',
            status: 'accepted'
          }
        }
      },
      include: {
        user: {
          select: {
            id: true,
            name: true,
            email: true
          }
        },
        members: {
          where: {
            status: 'accepted'
          },
          include: {
            user: {
              select: {
                id: true,
                name: true,
                email: true,
                avatar: true
              }
            }
          }
        },
        activities: true,
        memories: true,
        locations: true,
        _count: {
          select: {
            activities: true,
            memories: true,
            members: true,
            locations: true
          }
        }
      }
    });

    return NextResponse.json(vacation, { status: 201 });

  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–ø—É—Å–∫–∞:', error);
    return NextResponse.json(
      { message: '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' },
      { status: 500 }
    );
  }
}



================================================================================
–§–ê–ô–õ: app/create-vacation/page.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/create-vacation/page.js
–†–ê–ó–ú–ï–†: 14361 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/create-vacation/page.js
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import ProtectedRoute from '../../components/ProtectedRoute';
import Notification from '../../components/Notification';

export default function CreateVacationPage() {
  const router = useRouter();
  const [formData, setFormData] = useState({
    title: '',
    description: '',
    destination: '',
    startDate: '',
    endDate: ''
  });
  const [errors, setErrors] = useState({});
  const [isLoading, setIsLoading] = useState(false);
  const [notification, setNotification] = useState({ message: '', type: '' });

  const validateForm = () => {
    const newErrors = {};

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–∑–≤–∞–Ω–∏—è
    if (!formData.title.trim()) {
      newErrors.title = '–ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ';
    } else if (formData.title.length < 2) {
      newErrors.title = '–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞';
    } else if (formData.title.length > 100) {
      newErrors.title = '–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–µ–≤—ã—à–∞—Ç—å 100 —Å–∏–º–≤–æ–ª–æ–≤';
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç
    if (!formData.startDate) {
      newErrors.startDate = '–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞';
    }

    if (!formData.endDate) {
      newErrors.endDate = '–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞';
    }

    if (formData.startDate && formData.endDate) {
      const start = new Date(formData.startDate);
      const end = new Date(formData.endDate);
      const today = new Date();
      today.setHours(0, 0, 0, 0);

      if (start < today) {
        newErrors.startDate = '–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –ø—Ä–æ—à–ª–æ–º';
      }

      if (end < start) {
        newErrors.endDate = '–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–Ω—å—à–µ –¥–∞—Ç—ã –Ω–∞—á–∞–ª–∞';
      }

      if ((end - start) / (1000 * 60 * 60 * 24) > 365) {
        newErrors.endDate = '–û—Ç–ø—É—Å–∫ –Ω–µ –º–æ–∂–µ—Ç –¥–ª–∏—Ç—å—Å—è –±–æ–ª—å—à–µ –≥–æ–¥–∞';
      }
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Å—Ç–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
    if (formData.destination && formData.destination.length > 200) {
      newErrors.destination = '–ú–µ—Å—Ç–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–µ–≤—ã—à–∞—Ç—å 200 —Å–∏–º–≤–æ–ª–æ–≤';
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–∏—Å–∞–Ω–∏—è
    if (formData.description && formData.description.length > 500) {
      newErrors.description = '–û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–µ–≤—ã—à–∞—Ç—å 500 —Å–∏–º–≤–æ–ª–æ–≤';
    }

    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({
      ...prev,
      [name]: value
    }));

    // –û—á–∏—â–∞–µ–º –æ—à–∏–±–∫—É –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª—è
    if (errors[name]) {
      setErrors(prev => ({
        ...prev,
        [name]: ''
      }));
    }
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    
    console.log('üîÑ –ù–∞—á–∞–ª–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–ø—É—Å–∫–∞...');
    console.log('üìã –î–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã:', formData);

    if (!validateForm()) {
      console.log('‚ùå –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–∞:', errors);
      return;
    }

    setIsLoading(true);

    try {
      const response = await fetch('/api/vacations', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(formData),
        credentials: 'include'
      });

      console.log('üì° –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', {
        status: response.status,
        statusText: response.statusText,
        ok: response.ok
      });

      const data = await response.json();
      console.log('üìÑ –î–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞:', data);

      if (response.ok) {
        console.log('‚úÖ –û—Ç–ø—É—Å–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω:', data.id);
        
        setNotification({ 
          message: '–û—Ç–ø—É—Å–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º...', 
          type: 'success' 
        });
        
        // –î–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —É–≤–∏–¥–µ—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
        setTimeout(() => {
          router.push(`/vacations/${data.id}`);
        }, 1500);
      } else {
        console.log('‚ùå –û—à–∏–±–∫–∞ API:', data.message);
        setNotification({ 
          message: data.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ—Ç–ø—É—Å–∫–∞', 
          type: 'error' 
        });
      }
    } catch (error) {
      console.error('‚ùå –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞:', error);
      setNotification({ 
        message: '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.', 
        type: 'error' 
      });
    } finally {
      setIsLoading(false);
    }
  };

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã (—Å–µ–≥–æ–¥–Ω—è)
  const getMinDate = () => {
    const today = new Date();
    return today.toISOString().split('T')[0];
  };

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã (–≥–æ–¥ –æ—Ç —Å–µ–≥–æ–¥–Ω—è)
  const getMaxDate = () => {
    const nextYear = new Date();
    nextYear.setFullYear(nextYear.getFullYear() + 1);
    return nextYear.toISOString().split('T')[0];
  };

  return (
    <ProtectedRoute>
      <Notification 
        message={notification.message} 
        type={notification.type}
        onClose={() => setNotification({ message: '', type: '' })}
      />

      <div className="min-h-screen bg-gray-50 py-8">
        <div className="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="bg-white rounded-2xl shadow-lg p-8">
            {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */}
            <div className="mb-8 text-center">
              <h1 className="text-3xl font-bold text-gray-900 mb-2">
                –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –æ—Ç–ø—É—Å–∫
              </h1>
              <p className="text-gray-600">
                –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–º —Å–ª–µ–¥—É—é—â–µ–º –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–∏
              </p>
            </div>

            <form onSubmit={handleSubmit} className="space-y-6">
              {/* –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ç–ø—É—Å–∫–∞ */}
              <div>
                <label htmlFor="title" className="block text-sm font-medium text-gray-700 mb-2">
                  –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ç–ø—É—Å–∫–∞ *
                </label>
                <input
                  type="text"
                  id="title"
                  name="title"
                  value={formData.title}
                  onChange={handleChange}
                  required
                  maxLength={100}
                  className={`w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                    errors.title ? 'border-red-500' : 'border-gray-300'
                  }`}
                  placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û—Ç–ø—É—Å–∫ –≤ –≥–æ—Ä–∞—Ö, –ü–ª—è–∂–Ω—ã–π –æ—Ç–¥—ã—Ö –Ω–∞ –ë–∞–ª–∏..."
                />
                <div className="flex justify-between mt-1">
                  {errors.title ? (
                    <p className="text-sm text-red-600">{errors.title}</p>
                  ) : (
                    <div className="text-sm text-gray-500">
                      –ú–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞
                    </div>
                  )}
                  <div className="text-sm text-gray-500">
                    {formData.title.length}/100
                  </div>
                </div>
              </div>

              {/* –ú–µ—Å—Ç–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è */}
              <div>
                <label htmlFor="destination" className="block text-sm font-medium text-gray-700 mb-2">
                  –ú–µ—Å—Ç–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
                </label>
                <input
                  type="text"
                  id="destination"
                  name="destination"
                  value={formData.destination}
                  onChange={handleChange}
                  maxLength={200}
                  className={`w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                    errors.destination ? 'border-red-500' : 'border-gray-300'
                  }`}
                  placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–∞—Ä–∏–∂, –§—Ä–∞–Ω—Ü–∏—è –∏–ª–∏ –¢–∞–π–ª–∞–Ω–¥, –ü—Ö—É–∫–µ—Ç..."
                />
                <div className="flex justify-between mt-1">
                  {errors.destination ? (
                    <p className="text-sm text-red-600">{errors.destination}</p>
                  ) : (
                    <div></div>
                  )}
                  <div className="text-sm text-gray-500">
                    {formData.destination.length}/200
                  </div>
                </div>
              </div>

              {/* –û–ø–∏—Å–∞–Ω–∏–µ */}
              <div>
                <label htmlFor="description" className="block text-sm font-medium text-gray-700 mb-2">
                  –û–ø–∏—Å–∞–Ω–∏–µ
                </label>
                <textarea
                  id="description"
                  name="description"
                  value={formData.description}
                  onChange={handleChange}
                  rows={4}
                  maxLength={500}
                  className={`w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                    errors.description ? 'border-red-500' : 'border-gray-300'
                  }`}
                  placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–∏—Ö –ø–ª–∞–Ω–∞—Ö, —Ü–µ–ª—è—Ö –ø–æ–µ–∑–¥–∫–∏ –∏–ª–∏ –æ—Å–æ–±—ã—Ö –ø–æ–∂–µ–ª–∞–Ω–∏—è—Ö..."
                />
                <div className="flex justify-between mt-1">
                  {errors.description ? (
                    <p className="text-sm text-red-600">{errors.description}</p>
                  ) : (
                    <div></div>
                  )}
                  <div className="text-sm text-gray-500">
                    {formData.description.length}/500
                  </div>
                </div>
              </div>

              {/* –î–∞—Ç—ã */}
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label htmlFor="startDate" className="block text-sm font-medium text-gray-700 mb-2">
                    –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ *
                  </label>
                  <input
                    type="date"
                    id="startDate"
                    name="startDate"
                    value={formData.startDate}
                    onChange={handleChange}
                    required
                    min={getMinDate()}
                    max={getMaxDate()}
                    className={`w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                      errors.startDate ? 'border-red-500' : 'border-gray-300'
                    }`}
                  />
                  {errors.startDate && (
                    <p className="mt-1 text-sm text-red-600">{errors.startDate}</p>
                  )}
                </div>

                <div>
                  <label htmlFor="endDate" className="block text-sm font-medium text-gray-700 mb-2">
                    –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è *
                  </label>
                  <input
                    type="date"
                    id="endDate"
                    name="endDate"
                    value={formData.endDate}
                    onChange={handleChange}
                    required
                    min={formData.startDate || getMinDate()}
                    max={getMaxDate()}
                    className={`w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                      errors.endDate ? 'border-red-500' : 'border-gray-300'
                    }`}
                  />
                  {errors.endDate && (
                    <p className="mt-1 text-sm text-red-600">{errors.endDate}</p>
                  )}
                </div>
              </div>

              {/* –ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ */}
              {formData.startDate && formData.endDate && !errors.startDate && !errors.endDate && (
                <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
                  <div className="flex items-center">
                    <svg className="w-5 h-5 text-blue-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <span className="text-blue-800 text-sm">
                      –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç–ø—É—Å–∫–∞: {' '}
                      {Math.ceil((new Date(formData.endDate) - new Date(formData.startDate)) / (1000 * 60 * 60 * 24)) + 1} –¥–Ω–µ–π
                    </span>
                  </div>
                </div>
              )}

              {/* –ö–Ω–æ–ø–∫–∏ */}
              <div className="flex flex-col sm:flex-row gap-4 pt-6">
                <button
                  type="button"
                  onClick={() => router.push('/my-vacations')}
                  disabled={isLoading}
                  className="flex-1 border border-gray-300 text-gray-700 py-3 px-6 rounded-lg font-medium hover:border-gray-400 hover:bg-gray-50 transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  –û—Ç–º–µ–Ω–∞
                </button>
                <button
                  type="submit"
                  disabled={isLoading}
                  className="flex-1 bg-gradient-to-r from-emerald-600 to-teal-500 text-white py-3 px-6 rounded-lg font-medium hover:from-emerald-700 hover:to-teal-600 transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2 shadow-lg hover:shadow-xl"
                >
                  {isLoading ? (
                    <>
                      <div className="w-5 h-5 border-t-2 border-white rounded-full animate-spin"></div>
                      <span>–°–æ–∑–¥–∞–Ω–∏–µ...</span>
                    </>
                  ) : (
                    <>
                      <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                      </svg>
                      <span>–°–æ–∑–¥–∞—Ç—å –æ—Ç–ø—É—Å–∫</span>
                    </>
                  )}
                </button>
              </div>

              {/* –ü–æ–¥—Å–∫–∞–∑–∫–∞ */}
              <div className="text-center">
                <p className="text-sm text-gray-500">
                  –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã —Å–º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –ø–ª–∞–Ω—ã –∏ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è
                </p>
              </div>
            </form>
          </div>
        </div>
      </div>
    </ProtectedRoute>
  );
}



================================================================================
–§–ê–ô–õ: app/globals.css
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/globals.css
–†–ê–ó–ú–ï–†: 1010 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

@import "tailwindcss";

:root {
  --background: #ffffff;
  --foreground: #171717;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #0a0a0a;
    --foreground: #ededed;
  }
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: Arial, Helvetica, sans-serif;
}
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
/* –í globals.css */
.notification-panel {
  position: fixed;
  top: 0;
  right: 0;
  height: 100vh;
  width: 384px; /* 96 * 4 */
  max-width: 100vw;
  background: white;
  z-index: 100;
}

/* –î–µ–ª–∞–µ–º —Ç–µ–∫—Å—Ç –≤ input —á–µ—Ä–Ω—ã–º */
input, textarea, select {
  color: #000000 !important;
}

/* –ü–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –¥–µ–ª–∞–µ–º —Å–µ—Ä—ã–º–∏ */
input::placeholder, textarea::placeholder {
  color: #6b7280 !important;
  opacity: 1;
}



================================================================================
–§–ê–ô–õ: app/layout.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/layout.js
–†–ê–ó–ú–ï–†: 976 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/layout.js
import { Geist, Geist_Mono } from "next/font/google";
import "./globals.css";
import Header from '../components/Header';
import Footer from '../components/Footer';
import { AuthProvider } from '../contexts/AuthContext';

const geistSans = Geist({
  variable: "--font-geist-sans",
  subsets: ["latin"],
});

const geistMono = Geist_Mono({
  variable: "--font-geist-mono",
  subsets: ["latin"],
});

export const metadata = {
  title: "Breezeway - –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–ø—É—Å–∫–æ–≤",
  description: "–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –æ—Ç–ø—É—Å–∫–∞ –≤–º–µ—Å—Ç–µ —Å –¥—Ä—É–∑—å—è–º–∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ. –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –º–∞—Ä—à—Ä—É—Ç—ã, –¥–µ–ª–∏—Ç–µ—Å—å –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏ –∏ –Ω–∞—Ö–æ–¥–∏—Ç–µ –ø–æ–ø—É—Ç—á–∏–∫–æ–≤.",
};

export default function RootLayout({ children }) {
  return (
    <html lang="ru">
      <body className={`${geistSans.variable} ${geistMono.variable} antialiased`}>
        <AuthProvider>
          <Header />
          <main>{children}</main>
          <Footer />
        </AuthProvider>
      </body>
    </html>
  );
}



================================================================================
–§–ê–ô–õ: app/login/page.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/login/page.js
–†–ê–ó–ú–ï–†: 8367 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/login/page.js
'use client';

import { useState } from 'react';
import Link from 'next/link';
import { useAuth } from '../../contexts/AuthContext';
import Notification from '../../components/Notification';
import GuestRoute from '../../components/GuestRoute';

export default function LoginPage() {
  const [formData, setFormData] = useState({
    email: '',
    password: '',
    rememberMe: false
  });
  const [errors, setErrors] = useState({});
  const [isLoading, setIsLoading] = useState(false);
  const [notification, setNotification] = useState({ message: '', type: '' });
  
  const { login } = useAuth();

  const validateForm = () => {
    const newErrors = {};

    if (!formData.email.trim()) {
      newErrors.email = 'Email –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω';
    } else if (!/\S+@\S+\.\S+/.test(formData.email)) {
      newErrors.email = '–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email';
    }

    if (!formData.password) {
      newErrors.password = '–ü–∞—Ä–æ–ª—å –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω';
    }

    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleChange = (e) => {
    const { name, value, type, checked } = e.target;
    setFormData(prev => ({
      ...prev,
      [name]: type === 'checkbox' ? checked : value
    }));
    
    if (errors[name]) {
      setErrors(prev => ({
        ...prev,
        [name]: ''
      }));
    }
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    
    if (!validateForm()) {
      return;
    }

    setIsLoading(true);

    try {
      const result = await login(formData.email, formData.password, formData.rememberMe);

      if (result.success) {
        setNotification({ 
          message: '–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º...', 
          type: 'success' 
        });
        
        // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ GuestRoute
      } else {
        setNotification({ 
          message: result.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ', 
          type: 'error' 
        });
      }
    } catch (error) {
      setNotification({ 
        message: '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.', 
        type: 'error' 
      });
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <GuestRoute>
      <>
        <Notification 
          message={notification.message} 
          type={notification.type}
          onClose={() => setNotification({ message: '', type: '' })}
        />

        <div className="min-h-screen bg-gradient-to-br from-emerald-50 via-white to-teal-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
          <div className="max-w-md w-full space-y-8">
            <div className="text-center">
              <Link href="/" className="inline-flex items-center space-x-2 mb-8">
                <div className="w-10 h-10 bg-gradient-to-r from-emerald-500 to-teal-400 rounded-lg flex items-center justify-center">
                  <span className="text-white font-bold text-sm">BW</span>
                </div>
                <span className="text-2xl font-bold bg-gradient-to-r from-emerald-600 to-teal-500 bg-clip-text text-transparent">
                  Breezeway
                </span>
              </Link>
              
              <h2 className="text-3xl font-bold text-gray-900">
                –í—Ö–æ–¥ –≤ –∞–∫–∫–∞—É–Ω—Ç
              </h2>
              <p className="mt-2 text-gray-600">
                –í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
              </p>
            </div>
            
            <div className="bg-white rounded-2xl shadow-xl p-8">
              <form onSubmit={handleSubmit} className="space-y-6">
                {/* –ü–æ–ª–µ email */}
                <div>
                  <label htmlFor="email" className="block text-sm font-medium text-gray-700 mb-2">
                    Email
                  </label>
                  <input
                    type="email"
                    id="email"
                    name="email"
                    value={formData.email}
                    onChange={handleChange}
                    className={`text-gray-900 w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                      errors.email ? 'border-red-500' : 'border-gray-300'
                    }`}
                    placeholder="your@email.com"
                  />
                  {errors.email && (
                    <p className="mt-2 text-sm text-red-600">{errors.email}</p>
                  )}
                </div>

                {/* –ü–æ–ª–µ –ø–∞—Ä–æ–ª—è */}
                <div>
                  <label htmlFor="password" className="block text-sm font-medium text-gray-700 mb-2">
                    –ü–∞—Ä–æ–ª—å
                  </label>
                  <input
                    type="password"
                    id="password"
                    name="password"
                    value={formData.password}
                    onChange={handleChange}
                    className={`text-gray-900 w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                      errors.password ? 'border-red-500' : 'border-gray-300'
                    }`}
                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ø–∞—Ä–æ–ª—å"
                  />
                  {errors.password && (
                    <p className="mt-2 text-sm text-red-600">{errors.password}</p>
                  )}
                </div>

                {/* –ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è */}
                <div className="flex items-center justify-between">
                  <div className="flex items-center">
                    <input
                      id="rememberMe"
                      name="rememberMe"
                      type="checkbox"
                      checked={formData.rememberMe}
                      onChange={handleChange}
                      className="h-4 w-4 text-emerald-600 focus:ring-emerald-500 border-gray-300 rounded"
                    />
                    <label htmlFor="rememberMe" className="ml-2 block text-sm text-gray-700">
                      –ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è
                    </label>
                  </div>

                  <Link href="/forgot-password" className="text-sm text-emerald-600 hover:text-emerald-500">
                    –ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?
                  </Link>
                </div>

                {/* –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ */}
                <button
                  type="submit"
                  disabled={isLoading}
                  className="w-full bg-gradient-to-r from-emerald-600 to-teal-500 text-white py-4 px-6 rounded-lg text-lg font-semibold hover:from-emerald-700 hover:to-teal-600 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                >
                  {isLoading ? (
                    <div className="flex items-center justify-center">
                      <div className="w-5 h-5 border-t-2 border-white rounded-full animate-spin mr-2"></div>
                      –í—Ö–æ–¥...
                    </div>
                  ) : (
                    '–í–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç'
                  )}
                </button>

                <div className="text-center">
                  <div className="inline-flex items-center space-x-2 bg-emerald-50 text-emerald-700 px-4 py-2 rounded-full text-sm">
                    <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                      <path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" />
                    </svg>
                    <span>–ú—ã —É–∂–µ –∂–¥—ë–º</span>
                  </div>
                </div>
              </form>

              <div className="mt-8 text-center">
                <p className="text-gray-600">
                  –ï—â–µ –Ω–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞?{' '}
                  <Link href="/registration" className="text-emerald-600 hover:text-emerald-500 font-semibold transition duration-200">
                    –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å
                  </Link>
                </p>
              </div>
            </div>
          </div>
        </div>
      </>
    </GuestRoute>
  );
}



================================================================================
–§–ê–ô–õ: app/my-vacations/page.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/my-vacations/page.js
–†–ê–ó–ú–ï–†: 10888 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/my-vacations/page.js
'use client';

import { useState, useEffect } from 'react';
import Link from 'next/link';
import ProtectedRoute from '../../components/ProtectedRoute';
import { useAuth } from '../../contexts/AuthContext';
import VacationCard from '../../components/VacationCard';
import Notification from '../../components/Notification';

export default function MyVacationsPage() {
  const { user } = useAuth();
  const [vacations, setVacations] = useState([]);
  const [isLoading, setIsLoading] = useState(true);
  const [filter, setFilter] = useState('all'); // all, upcoming, current, past
  const [notification, setNotification] = useState({ message: '', type: '' });

  useEffect(() => {
    fetchVacations();
  }, []);

  const fetchVacations = async () => {
    try {
      const response = await fetch('/api/vacations', {
        credentials: 'include'
      });

      if (response.ok) {
        const data = await response.json();
        setVacations(data);
      } else {
        setNotification({
          message: '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç–ø—É—Å–∫–æ–≤',
          type: 'error'
        });
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç–ø—É—Å–∫–æ–≤:', error);
      setNotification({
        message: '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –æ—Ç–ø—É—Å–∫–æ–≤',
        type: 'error'
      });
    } finally {
      setIsLoading(false);
    }
  };

  const getFilteredVacations = () => {
    const today = new Date();
    
    return vacations.filter(vacation => {
      const startDate = new Date(vacation.startDate);
      const endDate = new Date(vacation.endDate);
      
      switch (filter) {
        case 'upcoming':
          return startDate > today;
        case 'current':
          return startDate <= today && endDate >= today;
        case 'past':
          return endDate < today;
        default:
          return true;
      }
    });
  };

  const getStats = () => {
    const today = new Date();
    return {
      all: vacations.length,
      upcoming: vacations.filter(v => new Date(v.startDate) > today).length,
      current: vacations.filter(v => new Date(v.startDate) <= today && new Date(v.endDate) >= today).length,
      past: vacations.filter(v => new Date(v.endDate) < today).length,
    };
  };

  const stats = getStats();
  const filteredVacations = getFilteredVacations();

  return (
    <ProtectedRoute>
      <Notification 
        message={notification.message} 
        type={notification.type}
        onClose={() => setNotification({ message: '', type: '' })}
      />

      <div className="min-h-screen bg-gray-50">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
          {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∫–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è */}
          <div className="mb-8">
            <div className="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
              <div>
                <h1 className="text-3xl font-bold text-gray-900">–ú–æ–∏ –æ—Ç–ø—É—Å–∫–∏</h1>
                <p className="text-gray-600 mt-2">
                  –ü—Ä–∏–≤–µ—Ç, {user?.name}! –£–ø—Ä–∞–≤–ª—è–π —Å–≤–æ–∏–º–∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è–º–∏
                </p>
              </div>
              <Link 
                href="/create-vacation" 
                className="bg-gradient-to-r from-emerald-600 to-teal-500 text-white px-6 py-3 rounded-full hover:from-emerald-700 hover:to-teal-600 transition duration-200 shadow-lg hover:shadow-xl flex items-center justify-center lg:justify-start space-x-2 w-full lg:w-auto"
              >
                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                </svg>
                <span>–°–æ–∑–¥–∞—Ç—å –æ—Ç–ø—É—Å–∫</span>
              </Link>
            </div>
          </div>

          {/* –§–∏–ª—å—Ç—Ä—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ - –ê–î–ê–ü–¢–ò–í–ù–ê–Ø –í–ï–†–°–ò–Ø */}
          <div className="mb-8">
            <div className="flex flex-col lg:flex-row lg:items-start lg:justify-between gap-6">
              {/* –§–∏–ª—å—Ç—Ä—ã - –≤–æ –≤—Å—é —à–∏—Ä–∏–Ω—É –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö, –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –Ω–∞ –ü–ö */}
              <div className="w-full lg:w-auto">
                <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-2 w-full">
                  <div className="grid grid-cols-2 sm:grid-cols-4 gap-1 w-full">
                    {[
                      { key: 'all', label: '–í—Å–µ', count: stats.all },
                      { key: 'upcoming', label: '–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ', count: stats.upcoming },
                      { key: 'current', label: '–¢–µ–∫—É—â–∏–µ', count: stats.current },
                      { key: 'past', label: '–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ', count: stats.past }
                    ].map(({ key, label, count }) => (
                      <button
                        key={key}
                        onClick={() => setFilter(key)}
                        className={`px-3 py-3 rounded-lg text-sm font-medium transition-all duration-200 flex flex-col items-center justify-center ${
                          filter === key
                            ? 'bg-emerald-500 text-white shadow-sm'
                            : 'text-gray-600 hover:text-gray-900 hover:bg-gray-50'
                        }`}
                      >
                        <span className="font-semibold">{count}</span>
                        <span className="text-xs mt-1">{label}</span>
                      </button>
                    ))}
                  </div>
                </div>
              </div>

              {/* –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ - –ø–æ–¥ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö, —Å–ø—Ä–∞–≤–∞ –Ω–∞ –ü–ö */}
              <div className="flex items-center justify-center lg:justify-start space-x-6 text-sm text-gray-600">
                <div className="flex items-center space-x-2">
                  <div className="w-3 h-3 bg-blue-500 rounded-full"></div>
                  <span>{stats.upcoming} –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö</span>
                </div>
                <div className="flex items-center space-x-2">
                  <div className="w-3 h-3 bg-green-500 rounded-full"></div>
                  <span>{stats.current} —Ç–µ–∫—É—â–∏—Ö</span>
                </div>
                <div className="flex items-center space-x-2">
                  <div className="w-3 h-3 bg-gray-400 rounded-full"></div>
                  <span>{stats.past} –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö</span>
                </div>
              </div>
            </div>
          </div>

          {/* –°–µ—Ç–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ */}
          {isLoading ? (
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
              {[...Array(8)].map((_, i) => (
                <div key={i} className="bg-white rounded-2xl shadow-lg p-6 animate-pulse">
                  <div className="h-48 bg-gray-200 rounded-xl mb-4"></div>
                  <div className="w-3/4 h-6 bg-gray-200 rounded mb-2"></div>
                  <div className="w-1/2 h-4 bg-gray-200 rounded mb-4"></div>
                  <div className="flex justify-between">
                    <div className="w-1/4 h-4 bg-gray-200 rounded"></div>
                    <div className="w-1/4 h-4 bg-gray-200 rounded"></div>
                  </div>
                </div>
              ))}
            </div>
          ) : filteredVacations.length === 0 ? (
            <div className="text-center py-16 bg-white rounded-2xl shadow-sm border border-gray-200">
              <div className="w-24 h-24 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-6">
                <span className="text-3xl">üèùÔ∏è</span>
              </div>
              
              {filter === 'all' ? (
                <>
                  <h3 className="text-xl font-semibold text-gray-900 mb-3">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ—Ç–ø—É—Å–∫–æ–≤</h3>
                  <p className="text-gray-600 mb-8 max-w-md mx-auto">
                    –°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –æ—Ç–ø—É—Å–∫, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π –≤–º–µ—Å—Ç–µ —Å –¥—Ä—É–∑—å—è–º–∏
                  </p>
                  <Link 
                    href="/create-vacation" 
                    className="bg-gradient-to-r from-emerald-600 to-teal-500 text-white px-8 py-3 rounded-full hover:from-emerald-700 hover:to-teal-600 transition duration-200 shadow-lg hover:shadow-xl inline-flex items-center space-x-2"
                  >
                    <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                    </svg>
                    <span>–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –æ—Ç–ø—É—Å–∫</span>
                  </Link>
                </>
              ) : (
                <>
                  <h3 className="text-xl font-semibold text-gray-900 mb-3">
                    {filter === 'upcoming' && '–ù–µ—Ç –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö –æ—Ç–ø—É—Å–∫–æ–≤'}
                    {filter === 'current' && '–ù–µ—Ç —Ç–µ–∫—É—â–∏—Ö –æ—Ç–ø—É—Å–∫–æ–≤'}
                    {filter === 'past' && '–ù–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –æ—Ç–ø—É—Å–∫–æ–≤'}
                  </h3>
                  <p className="text-gray-600 mb-8">
                    {filter === 'upcoming' && '–í—Å–µ –≤–∞—à–∏ –æ—Ç–ø—É—Å–∫–∏ —É–∂–µ –Ω–∞—á–∞–ª–∏—Å—å –∏–ª–∏ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å'}
                    {filter === 'current' && '–°–µ–π—á–∞—Å —É –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ—Ç–ø—É—Å–∫–æ–≤'}
                    {filter === 'past' && '–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –æ—Ç–ø—É—Å–∫–æ–≤'}
                  </p>
                  <button
                    onClick={() => setFilter('all')}
                    className="text-emerald-600 hover:text-emerald-500 font-medium"
                  >
                    –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –æ—Ç–ø—É—Å–∫–∏
                  </button>
                </>
              )}
            </div>
          ) : (
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
              {filteredVacations.map((vacation) => (
                <VacationCard key={vacation.id} vacation={vacation} />
              ))}
              
              {/* –ö–∞—Ä—Ç–æ—á–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –æ—Ç–ø—É—Å–∫–∞ */}
              <Link 
                href="/create-vacation" 
                className="group border-2 border-dashed border-gray-300 rounded-2xl p-8 hover:border-emerald-400 hover:bg-emerald-50 transition-all duration-300 flex flex-col items-center justify-center text-gray-500 hover:text-emerald-600 min-h-[300px]"
              >
                <div className="w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mb-4 group-hover:bg-emerald-200 transition-colors">
                  <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                  </svg>
                </div>
                <span className="font-semibold text-lg mb-2">–î–æ–±–∞–≤–∏—Ç—å –æ—Ç–ø—É—Å–∫</span>
                <span className="text-sm text-center">–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ</span>
              </Link>
            </div>
          )}
        </div>
      </div>
    </ProtectedRoute>
  );
}



================================================================================
–§–ê–ô–õ: app/notification-test/page.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/notification-test/page.js
–†–ê–ó–ú–ï–†: 8111 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/notifications-test/page.js
'use client';

import { useState } from 'react';
import { useAuth } from '../../contexts/AuthContext';
import ProtectedRoute from '../../components/ProtectedRoute';

export default function NotificationsTestPage() {
  const { user } = useAuth();
  const [isLoading, setIsLoading] = useState(false);
  const [result, setResult] = useState(null);

  const testNotifications = [
    {
      type: 'invitation',
      title: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –æ—Ç–ø—É—Å–∫',
      message: '–ê–Ω–Ω–∞ –ø—Ä–∏–≥–ª–∞—Å–∏–ª–∞ –≤–∞—Å –≤ –æ—Ç–ø—É—Å–∫ "–û—Ç–¥—ã—Ö –Ω–∞ –ë–∞–ª–∏"',
      buttonText: 'üì® –¢–µ—Å—Ç –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è',
      description: '–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π —Å –∫–Ω–æ–ø–∫–∞–º–∏ –ø—Ä–∏–Ω—è—Ç–∏—è/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è'
    },
    {
      type: 'activity_update', 
      title: '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤',
      message: '–í –≤–∞—à–µ–º –æ—Ç–ø—É—Å–∫–µ "–ì–æ—Ä–Ω—ã–µ –ø–æ—Ö–æ–¥—ã" –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
      buttonText: 'üîÑ –¢–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è',
      description: '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ –ø–ª–∞–Ω–∞—Ö –æ—Ç–ø—É—Å–∫–∞'
    },
    {
      type: 'memory_comment',
      title: '–ù–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π',
      message: '–ò–≤–∞–Ω –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª –≤–∞—à–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ',
      buttonText: 'üí¨ –¢–µ—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è',
      description: '–û–ø–æ–≤–µ—â–µ–Ω–∏–µ –æ –Ω–æ–≤—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –∫ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º'
    },
    {
      type: 'info',
      title: '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ',
      message: '–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏—Å—Ç–µ–º—ã',
      buttonText: '‚ÑπÔ∏è –¢–µ—Å—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏',
      description: '–ü—Ä–æ—Å—Ç–æ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –±–µ–∑ –¥–µ–π—Å—Ç–≤–∏–π'
    }
  ];

  const sendTestNotification = async (type) => {
    setIsLoading(true);
    setResult(null);
    
    try {
      const response = await fetch('/api/notifications/test', {
        method: 'POST',
        headers: { 
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ type }),
        credentials: 'include'
      });

      const data = await response.json();

      if (response.ok) {
        setResult({
          type: 'success',
          message: `‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "${type}" —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!`,
          notification: data.notification
        });
      } else {
        setResult({
          type: 'error', 
          message: `‚ùå –û—à–∏–±–∫–∞: ${data.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`
        });
      }
    } catch (error) {
      setResult({
        type: 'error',
        message: `‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}`
      });
    } finally {
      setIsLoading(false);
    }
  };

  const clearResult = () => {
    setResult(null);
  };

  return (
    <ProtectedRoute>
      <div className="min-h-screen bg-gradient-to-br from-blue-50 to-cyan-50 py-8">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
          
          {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */}
          <div className="text-center mb-12">
            <h1 className="text-4xl font-bold text-gray-900 mb-4">
              –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            </h1>
            <p className="text-lg text-gray-600 max-w-2xl mx-auto">
              –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π Breezeway. 
              –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–∞–∫ –æ–Ω–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è.
            </p>
            {user && (
              <div className="mt-4 inline-flex items-center space-x-2 bg-white px-4 py-2 rounded-full text-sm text-gray-600 shadow-sm">
                <span>–¢–µ—Å—Ç–∏—Ä—É–µ—Ç–µ –∫–∞–∫:</span>
                <span className="font-semibold text-emerald-600">{user.name}</span>
                <span className="text-gray-400">‚Ä¢</span>
                <span className="text-gray-500">{user.email}</span>
              </div>
            )}
          </div>

          {/* –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ */}
          {result && (
            <div className={`mb-6 p-4 rounded-xl border-2 ${
              result.type === 'success' 
                ? 'bg-green-50 border-green-200 text-green-800' 
                : 'bg-red-50 border-red-200 text-red-800'
            }`}>
              <div className="flex justify-between items-start">
                <div className="flex-1">
                  <p className="font-semibold">{result.message}</p>
                  {result.notification && (
                    <div className="mt-2 text-sm opacity-80">
                      <p><strong>–¢–∏–ø:</strong> {result.notification.type}</p>
                      <p><strong>–ó–∞–≥–æ–ª–æ–≤–æ–∫:</strong> {result.notification.title}</p>
                      <p><strong>–°–æ–æ–±—â–µ–Ω–∏–µ:</strong> {result.notification.message}</p>
                    </div>
                  )}
                </div>
                <button
                  onClick={clearResult}
                  className="ml-4 p-1 hover:opacity-70 transition-opacity"
                >
                  ‚úï
                </button>
              </div>
            </div>
          )}

          {/* –ö–Ω–æ–ø–∫–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è */}
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12">
            {testNotifications.map((notification) => (
              <div
                key={notification.type}
                className="bg-white rounded-2xl shadow-lg border border-gray-200 p-6 hover:shadow-xl transition-all duration-300"
              >
                <div className="flex flex-col h-full">
                  <div className="flex-1">
                    <h3 className="text-xl font-semibold text-gray-900 mb-3">
                      {notification.title}
                    </h3>
                    <p className="text-gray-600 mb-2">
                      {notification.description}
                    </p>
                    <div className="text-sm text-gray-500 bg-gray-50 rounded-lg p-3">
                      <strong>–°–æ–æ–±—â–µ–Ω–∏–µ:</strong> "{notification.message}"
                    </div>
                  </div>
                  
                  <button
                    onClick={() => sendTestNotification(notification.type)}
                    disabled={isLoading}
                    className="w-full mt-4 bg-gradient-to-r from-emerald-500 to-teal-400 text-white py-3 px-6 rounded-xl font-semibold hover:from-emerald-600 hover:to-teal-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                  >
                    {isLoading ? (
                      <div className="flex items-center justify-center">
                        <div className="w-5 h-5 border-t-2 border-white rounded-full animate-spin mr-2"></div>
                        –û—Ç–ø—Ä–∞–≤–∫–∞...
                      </div>
                    ) : (
                      notification.buttonText
                    )}
                  </button>
                </div>
              </div>
            ))}
          </div>

          {/* –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è */}
          <div className="bg-white rounded-2xl shadow-lg border border-gray-200 p-6">
            <h2 className="text-2xl font-bold text-gray-900 mb-4">–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç?</h2>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div className="space-y-3">
                <h3 className="font-semibold text-gray-900">üì± –ù–∞ –º–æ–±–∏–ª—å–Ω–æ–º:</h3>
                <ul className="text-gray-600 space-y-2">
                  <li>‚Ä¢ –û—Ç–∫—Ä–æ–π—Ç–µ –º–µ–Ω—é (—Ç—Ä–∏ –ª–∏–Ω–∏–∏ –≤–≤–µ—Ä—Ö—É)</li>
                  <li>‚Ä¢ –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π üîî</li>
                  <li>‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—è–≤–∏–≤—à–∏–µ—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</li>
                </ul>
              </div>
              <div className="space-y-3">
                <h3 className="font-semibold text-gray-900">üíª –ù–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:</h3>
                <ul className="text-gray-600 space-y-2">
                  <li>‚Ä¢ –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É</li>
                  <li>‚Ä¢ –û—Ç–∫—Ä–æ–µ—Ç—Å—è –ø–∞–Ω–µ–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</li>
                  <li>‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</li>
                </ul>
              </div>
            </div>
          </div>

          {/* –ü–æ–¥—Å–∫–∞–∑–∫–∞ */}
          <div className="mt-8 text-center">
            <p className="text-gray-500 text-sm">
              –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–∫—Ä–æ–π—Ç–µ —Ü–µ–Ω—Ç—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–∏–∫–æ–Ω–∫–∞ –∫–æ–ª–æ–∫–æ–ª—å—á–∏–∫–∞ –≤ —à–∞–ø–∫–µ —Å–∞–π—Ç–∞)
            </p>
          </div>

        </div>
      </div>
    </ProtectedRoute>
  );
}



================================================================================
–§–ê–ô–õ: app/page.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/page.js
–†–ê–ó–ú–ï–†: 436 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/page.js
import Header from '../components/Header';
import HeroSection from '../components/HeroSection';
import FeaturesSection from '../components/FeaturesSection';
import CTASection from '../components/CTASection';

export default function Home() {
  return (
    <div className="min-h-screen bg-white">
      <main>
        <HeroSection />
        <FeaturesSection />
        <CTASection />
      </main>
    </div>
  );
}



================================================================================
–§–ê–ô–õ: app/profile/page.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/profile/page.js
–†–ê–ó–ú–ï–†: 2467 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/profile/page.js
'use client';

import ProtectedRoute from '../../components/ProtectedRoute';
import { useAuth } from '../../contexts/AuthContext';

export default function ProfilePage() {
  const { user, logout } = useAuth();

  const handleLogout = async () => {
    await logout();
  };

  return (
    <ProtectedRoute>
      <div className="min-h-screen bg-gray-50">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
          <div className="bg-white rounded-2xl shadow-lg p-8">
            <div className="flex items-center space-x-6 mb-8">
              <div className="w-20 h-20 bg-gradient-to-r from-emerald-500 to-teal-400 rounded-full flex items-center justify-center text-white text-2xl font-bold">
                {user?.name ? user.name.charAt(0).toUpperCase() : 'U'}
              </div>
              <div>
                <h1 className="text-3xl font-bold text-gray-900">{user?.name}</h1>
                <p className="text-gray-600">{user?.email}</p>
                <p className="text-sm text-gray-500">
                  –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: {user?.createdAt ? new Date(user.createdAt).toLocaleDateString('ru-RU') : ''}
                </p>
              </div>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
              <div className="bg-emerald-50 rounded-lg p-4 text-center">
                <div className="text-2xl font-bold text-emerald-600">2</div>
                <div className="text-sm text-emerald-700">–ê–∫—Ç–∏–≤–Ω—ã—Ö –æ—Ç–ø—É—Å–∫–∞</div>
              </div>
              <div className="bg-blue-50 rounded-lg p-4 text-center">
                <div className="text-2xl font-bold text-blue-600">15</div>
                <div className="text-sm text-blue-700">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–µ—Å—Ç</div>
              </div>
              <div className="bg-purple-50 rounded-lg p-4 text-center">
                <div className="text-2xl font-bold text-purple-600">47</div>
                <div className="text-sm text-purple-700">–í–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π</div>
              </div>
            </div>

            <div className="border-t border-gray-200 pt-6">
              <button
                onClick={handleLogout}
                className="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition duration-200"
              >
                –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
              </button>
            </div>
          </div>
        </div>
      </div>
    </ProtectedRoute>
  );
}



================================================================================
–§–ê–ô–õ: app/registration/page.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/registration/page.js
–†–ê–ó–ú–ï–†: 10345 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/registration/page.js
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import Link from 'next/link';
import Notification from '../../components/Notification';
import GuestRoute from '../../components/GuestRoute';

export default function RegistrationPage() {
  const router = useRouter();
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    password: '',
    confirmPassword: ''
  });
  const [errors, setErrors] = useState({});
  const [isLoading, setIsLoading] = useState(false);
  const [notification, setNotification] = useState({ message: '', type: '' });

  const validateForm = () => {
    const newErrors = {};

    if (!formData.name.trim()) {
      newErrors.name = '–ò–º—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ';
    } else if (formData.name.length < 2) {
      newErrors.name = '–ò–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞';
    }

    if (!formData.email.trim()) {
      newErrors.email = 'Email –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω';
    } else if (!/\S+@\S+\.\S+/.test(formData.email)) {
      newErrors.email = '–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email';
    }

    if (!formData.password) {
      newErrors.password = '–ü–∞—Ä–æ–ª—å –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω';
    } else if (formData.password.length < 6) {
      newErrors.password = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤';
    }

    if (!formData.confirmPassword) {
      newErrors.confirmPassword = '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ';
    } else if (formData.password !== formData.confirmPassword) {
      newErrors.confirmPassword = '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç';
    }

    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({
      ...prev,
      [name]: value
    }));
    
    if (errors[name]) {
      setErrors(prev => ({
        ...prev,
        [name]: ''
      }));
    }
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    
    if (!validateForm()) {
      return;
    }

    setIsLoading(true);

    try {
      const response = await fetch('/api/auth/register', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          name: formData.name,
          email: formData.email,
          password: formData.password,
        }),
        credentials: 'include'
      });

      const data = await response.json();

      if (response.ok) {
        setNotification({ 
          message: '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º...', 
          type: 'success' 
        });
        
        setTimeout(() => {
          router.push('/my-vacations');
        }, 1000);
      } else {
        setNotification({ 
          message: data.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏', 
          type: 'error' 
        });
      }
    } catch (error) {
      setNotification({ 
        message: '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.', 
        type: 'error' 
      });
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <GuestRoute>
      <>
        <Notification 
          message={notification.message} 
          type={notification.type}
          onClose={() => setNotification({ message: '', type: '' })}
        />

        <div className="min-h-screen bg-gradient-to-br from-emerald-50 via-white to-teal-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
          <div className="max-w-md w-full space-y-8">
            <div className="text-center">
              <Link href="/" className="inline-flex items-center space-x-2 mb-8">
                <div className="w-10 h-10 bg-gradient-to-r from-emerald-500 to-teal-400 rounded-lg flex items-center justify-center">
                  <span className="text-white font-bold text-sm">BW</span>
                </div>
                <span className="text-2xl font-bold bg-gradient-to-r from-emerald-600 to-teal-500 bg-clip-text text-transparent">
                  Breezeway
                </span>
              </Link>
              
              <h2 className="text-3xl font-bold text-gray-900">
                –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç
              </h2>
              <p className="mt-2 text-gray-600">
                –ù–∞—á–Ω–∏—Ç–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è
              </p>
            </div>
            
            <div className="bg-white rounded-2xl shadow-xl p-8">
              <form onSubmit={handleSubmit} className="space-y-6">
                {/* –ü–æ–ª–µ –∏–º–µ–Ω–∏ */}
                <div>
                  <label htmlFor="name" className="block text-sm font-medium text-gray-700 mb-2">
                    –ò–º—è
                  </label>
                  <input
                    type="text"
                    id="name"
                    name="name"
                    value={formData.name}
                    onChange={handleChange}
                    className={`text-gray-900 w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                      errors.name ? 'border-red-500' : 'border-gray-300'
                    }`}
                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è"
                  />
                  {errors.name && (
                    <p className="mt-2 text-sm text-red-600">{errors.name}</p>
                  )}
                </div>

                {/* –ü–æ–ª–µ email */}
                <div>
                  <label htmlFor="email" className="block text-sm font-medium text-gray-700 mb-2">
                    Email
                  </label>
                  <input
                    type="email"
                    id="email"
                    name="email"
                    value={formData.email}
                    onChange={handleChange}
                    className={`text-gray-900 w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                      errors.email ? 'border-red-500' : 'border-gray-300'
                    }`}
                    placeholder="your@email.com"
                  />
                  {errors.email && (
                    <p className="mt-2 text-sm text-red-600">{errors.email}</p>
                  )}
                </div>

                {/* –ü–æ–ª–µ –ø–∞—Ä–æ–ª—è */}
                <div>
                  <label htmlFor="password" className="block text-sm font-medium text-gray-700 mb-2">
                    –ü–∞—Ä–æ–ª—å
                  </label>
                  <input
                    type="password"
                    id="password"
                    name="password"
                    value={formData.password}
                    onChange={handleChange}
                    className={`text-gray-900 w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                      errors.password ? 'border-red-500' : 'border-gray-300'
                    }`}
                    placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤"
                  />
                  {errors.password && (
                    <p className="mt-2 text-sm text-red-600">{errors.password}</p>
                  )}
                </div>

                {/* –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è */}
                <div>
                  <label htmlFor="confirmPassword" className="block text-sm font-medium text-gray-700 mb-2">
                    –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å
                  </label>
                  <input
                    type="password"
                    id="confirmPassword"
                    name="confirmPassword"
                    value={formData.confirmPassword}
                    onChange={handleChange}
                    className={`text-gray-900 w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                      errors.confirmPassword ? 'border-red-500' : 'border-gray-300'
                    }`}
                    placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
                  />
                  {errors.confirmPassword && (
                    <p className="mt-2 text-sm text-red-600">{errors.confirmPassword}</p>
                  )}
                </div>

                {/* –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ */}
                <button
                  type="submit"
                  disabled={isLoading}
                  className="w-full bg-gradient-to-r from-emerald-600 to-teal-500 text-white py-4 px-6 rounded-lg text-lg font-semibold hover:from-emerald-700 hover:to-teal-600 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                >
                  {isLoading ? (
                    <div className="flex items-center justify-center">
                      <div className="w-5 h-5 border-t-2 border-white rounded-full animate-spin mr-2"></div>
                      –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è...
                    </div>
                  ) : (
                    '–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç –±–µ—Å–ø–ª–∞—Ç–Ω–æ'
                  )}
                </button>

                {/* –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –Ω–∞–≤—Å–µ–≥–¥–∞ */}
                <div className="text-center">
                  <div className="inline-flex items-center space-x-2 bg-emerald-50 text-emerald-700 px-4 py-2 rounded-full text-sm">
                    <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                      <path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" />
                    </svg>
                    <span>–ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ ‚Ä¢ –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π</span>
                  </div>
                </div>
              </form>

              <div className="mt-8 text-center">
                <p className="text-gray-600">
                  –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç?{' '}
                  <Link href="/login" className="text-emerald-600 hover:text-emerald-500 font-semibold transition duration-200">
                    –í–æ–π–¥–∏—Ç–µ
                  </Link>
                </p>
              </div>
            </div>
          </div>
        </div>
      </>
    </GuestRoute>
  );
}



================================================================================
–§–ê–ô–õ: app/vacations/[id]/page.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/app/vacations/[id]/page.js
–†–ê–ó–ú–ï–†: 7444 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/app/vacations/[id]/page.js
'use client';

import { useState, useEffect } from 'react';
import { useParams, useRouter } from 'next/navigation';
import ProtectedRoute from '@/components/ProtectedRoute';
import VacationTimer from '@/components/vacation/VacationTimer';
import CaptureMoment from '@/components/vacation/CaptureMoment';
import PlanSection from '@/components/vacation/PlanSection';
import MemoriesSection from '@/components/vacation/MemoriesSection';
import VacationManagement from '@/components/vacation/VacationManagement';

export default function VacationDetailPage() {
  const params = useParams();
  const router = useRouter();
  const [vacation, setVacation] = useState(null);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState('');
  const [activeTab, setActiveTab] = useState('overview');

  useEffect(() => {
    if (params.id) {
      fetchVacation();
    }
  }, [params.id]);

  const fetchVacation = async () => {
    try {
      const response = await fetch(`/api/vacations/${params.id}`, {
        credentials: 'include'
      });

      if (response.ok) {
        const data = await response.json();
        setVacation(data);
      } else if (response.status === 404) {
        setError('–û—Ç–ø—É—Å–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω');
      } else if (response.status === 401) {
        setError('–ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è');
        router.push('/login');
      } else {
        const errorData = await response.json();
        setError(errorData.message || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç–ø—É—Å–∫–∞');
      }
    } catch (error) {
      console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç–ø—É—Å–∫–∞:', error);
      setError('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç–ø—É—Å–∫–∞');
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <ProtectedRoute>
      <VacationContent 
        vacation={vacation}
        isLoading={isLoading}
        error={error}
        activeTab={activeTab}
        setActiveTab={setActiveTab}
        onRefresh={fetchVacation}
        router={router}
      />
    </ProtectedRoute>
  );
}

function VacationContent({ vacation, isLoading, error, activeTab, setActiveTab, onRefresh, router }) {
  if (isLoading) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 flex items-center justify-center">
        <div className="text-center">
          <div className="w-16 h-16 border-t-4 border-gray-400 border-solid rounded-full animate-spin mx-auto mb-4"></div>
          <p className="text-gray-600">–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–ø—É—Å–∫–∞...</p>
        </div>
      </div>
    );
  }

  if (error) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 flex items-center justify-center">
        <div className="text-center">
          <h2 className="text-2xl font-bold text-gray-900 mb-4">–û—à–∏–±–∫–∞</h2>
          <p className="text-gray-600 mb-6">{error}</p>
          <button 
            onClick={() => router.push('/my-vacations')}
            className="bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 transition duration-200"
          >
            –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –º–æ–∏–º –æ—Ç–ø—É—Å–∫–∞–º
          </button>
        </div>
      </div>
    );
  }

  if (!vacation) {
    return (
      <div className="min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100 flex items-center justify-center">
        <div className="text-center">
          <h2 className="text-2xl font-bold text-gray-900 mb-4">–û—Ç–ø—É—Å–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω</h2>
          <p className="text-gray-600 mb-6">–í–æ–∑–º–æ–∂–Ω–æ, —É –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É –æ—Ç–ø—É—Å–∫—É –∏–ª–∏ –æ–Ω –±—ã–ª —É–¥–∞–ª–µ–Ω</p>
          <button 
            onClick={() => router.push('/my-vacations')}
            className="bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 transition duration-200"
          >
            –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –º–æ–∏–º –æ—Ç–ø—É—Å–∫–∞–º
          </button>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100">
      <div className="bg-white/95 backdrop-blur-lg border-b border-gray-200 sticky top-0 z-50 shadow-sm">
        <div className="max-w-7xl mx-auto">
          <div className="px-4 sm:px-6 lg:px-8 py-4">
            <div className="flex items-center space-x-3">
              <button 
                onClick={() => router.push('/my-vacations')}
                className="flex-shrink-0 p-2 hover:bg-gray-100 rounded-lg transition-colors"
              >
                <svg className="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                </svg>
              </button>
              <div className="min-w-0 flex-1">
                <h1 className="text-xl font-bold text-gray-900 truncate">{vacation.title}</h1>
                {vacation.destination && (
                  <p className="text-gray-600 text-sm truncate flex items-center mt-1">
                    <svg className="w-4 h-4 mr-1 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                    </svg>
                    {vacation.destination}
                  </p>
                )}
              </div>
            </div>
          </div>

          <div className="border-t border-gray-100">
            <div className="px-4 sm:px-6 lg:px-8">
              <nav className="flex space-x-1 -mb-px overflow-x-auto">
                {[
                  { id: 'overview', label: '–û–±–∑–æ—Ä', icon: 'üìä' },
                  { id: 'plans', label: '–ü–ª–∞–Ω—ã', icon: 'üìÖ' },
                  { id: 'memories', label: '–í–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è', icon: 'üì∏' },
                  { id: 'management', label: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ', icon: '‚öôÔ∏è' }
                ].map((tab) => (
                  <button
                    key={tab.id}
                    onClick={() => setActiveTab(tab.id)}
                    className={`px-4 py-3 text-sm font-medium whitespace-nowrap border-b-2 transition-colors flex items-center space-x-2 ${
                      activeTab === tab.id
                        ? 'border-gray-600 text-gray-900'
                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                    }`}
                  >
                    <span className="text-base">{tab.icon}</span>
                    <span>{tab.label}</span>
                  </button>
                ))}
              </nav>
            </div>
          </div>
        </div>
      </div>

      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        {activeTab === 'overview' && (
          <div className="space-y-6">
            <VacationTimer vacation={vacation} />
            <CaptureMoment vacation={vacation} />
            <PlanSection vacation={vacation} preview={true} />
            <MemoriesSection vacation={vacation} preview={true} />
          </div>
        )}

        {activeTab === 'plans' && (
          <PlanSection vacation={vacation} preview={false} />
        )}

        {activeTab === 'memories' && (
          <MemoriesSection vacation={vacation} preview={false} />
        )}

        {activeTab === 'management' && (
          <VacationManagement vacation={vacation} onUpdate={onRefresh} />
        )}
      </div>
    </div>
  );
}



================================================================================
–§–ê–ô–õ: components/CTASection.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/CTASection.js
–†–ê–ó–ú–ï–†: 1747 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/CTASection.js
import Link from 'next/link';

export default function CTASection() {
  return (
    <section className="py-20 bg-gradient-to-r from-blue-600 to-cyan-500">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 className="text-3xl md:text-4xl font-bold text-white mb-6">
          –ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ?
        </h2>
        <p className="text-xl text-blue-100 mb-10 max-w-2xl mx-auto">
          –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ —Ç—ã—Å—è—á–∞–º –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ —Å–æ–∑–¥–∞—é—Ç 
          –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è —Å Vacation Social
        </p>
        
        <div className="flex flex-col sm:flex-row gap-4 justify-center">
          <Link 
            href="/registration" 
            className="bg-white text-blue-600 px-8 py-4 rounded-full text-lg font-semibold hover:bg-blue-50 transition duration-200 shadow-2xl hover:shadow-3xl transform hover:-translate-y-1 inline-flex items-center justify-center"
          >
            –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç –±–µ—Å–ø–ª–∞—Ç–Ω–æ
            <svg className="ml-2 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7l5 5m0 0l-5 5m5-5H6" />
            </svg>
          </Link>
          
          <Link 
            href="/features" 
            className="border border-white text-white px-8 py-4 rounded-full text-lg font-semibold hover:bg-white hover:bg-opacity-10 transition duration-200 inline-flex items-center justify-center"
          >
            –£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ
          </Link>
        </div>
        
        <p className="mt-6 text-blue-200 text-sm">
          –ë–µ–∑ –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∫–∞—Ä—Ç—ã ‚Ä¢ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –Ω–∞–≤—Å–µ–≥–¥–∞
        </p>
      </div>
    </section>
  );
}



================================================================================
–§–ê–ô–õ: components/FeaturesSection.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/FeaturesSection.js
–†–ê–ó–ú–ï–†: 4372 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/FeaturesSection.js
export default function FeaturesSection() {
  const features = [
    {
      icon: (
        <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      ),
      title: "–¢–∞–π–º–µ—Ä –æ—Ç–ø—É—Å–∫–∞",
      description: "–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –≤—Ä–µ–º—è –¥–æ –Ω–∞—á–∞–ª–∞ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è —Å –∫—Ä–∞—Å–∏–≤—ã–º —Ç–∞–π–º–µ—Ä–æ–º"
    },
    {
      icon: (
        <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
        </svg>
      ),
      title: "–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞",
      description: "–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ø–ª–∞–Ω—ã –ø–æ—Ö–æ–¥–æ–≤ —Å –∫–∞—Ä—Ç–∞–º–∏ –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º"
    },
    {
      icon: (
        <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
        </svg>
      ),
      title: "–í–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è",
      description: "–î–µ–ª–∏—Ç–µ—Å—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ –∏ –∏—Å—Ç–æ—Ä–∏—è–º–∏ –∏–∑ –≤–∞—à–∏—Ö –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π"
    },
    {
      icon: (
        <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
        </svg>
      ),
      title: "–°–æ–æ–±—â–µ—Å—Ç–≤–æ",
      description: "–ù–∞—Ö–æ–¥–∏—Ç–µ –ø–æ–ø—É—Ç—á–∏–∫–æ–≤ –∏ –¥–µ–ª–∏—Ç–µ—Å—å –æ–ø—ã—Ç–æ–º —Å –¥—Ä—É–≥–∏–º–∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º–∏"
    },
    {
      icon: (
        <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
      ),
      title: "–£–º–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å",
      description: "–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞ –∫—Ä–∞—Å–∏–≤–æ–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª–µ"
    },
    {
      icon: (
        <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
        </svg>
      ),
      title: "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å",
      description: "–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã –∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –≤–∞–º –∏ –≤–∞—à–∏–º –¥—Ä—É–∑—å—è–º"
    }
  ];

  return (
    <section className="py-20 bg-white">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="text-center">
          <h2 className="text-3xl md:text-4xl font-bold text-gray-900">
            –í—Å–µ –¥–ª—è –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ –æ—Ç–ø—É—Å–∫–∞
          </h2>
          <p className="mt-4 text-xl text-gray-600 max-w-3xl mx-auto">
            –û—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π - –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
          </p>
        </div>

        <div className="mt-16 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {features.map((feature, index) => (
            <div 
              key={index}
              className="bg-gradient-to-br from-white to-blue-50 p-6 rounded-2xl shadow-lg hover:shadow-xl transition duration-300 border border-blue-100"
            >
              <div className="w-12 h-12 bg-gradient-to-r from-blue-500 to-cyan-400 rounded-lg flex items-center justify-center text-white mb-4">
                {feature.icon}
              </div>
              <h3 className="text-xl font-semibold text-gray-900 mb-2">
                {feature.title}
              </h3>
              <p className="text-gray-600">
                {feature.description}
              </p>
            </div>
          ))}
        </div>
      </div>
    </section>
  );
}



================================================================================
–§–ê–ô–õ: components/Footer.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/Footer.js
–†–ê–ó–ú–ï–†: 1179 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/Footer.js
import Link from 'next/link';

export default function Footer() {
  return (
    <footer className="bg-gray-900 text-white py-12">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div className="md:col-span-2">
            <div className="flex items-center space-x-2 mb-4">
              <div className="w-8 h-8 bg-gradient-to-r from-emerald-500 to-teal-400 rounded-lg flex items-center justify-center">
                <span className="text-white font-bold text-sm">BW</span>
              </div>
              <span className="text-xl font-bold">Breezeway</span>
            </div>
            <p className="text-gray-400 max-w-md">
              –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–ø—É—Å–∫–æ–≤ –≤–º–µ—Å—Ç–µ —Å –¥—Ä—É–∑—å—è–º–∏. 
              –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è, –¥–µ–ª–∏—Ç–µ—Å—å –º–æ–º–µ–Ω—Ç–∞–º–∏, –Ω–∞—Ö–æ–¥–∏—Ç–µ –ø–æ–ø—É—Ç—á–∏–∫–æ–≤.
            </p>
          </div>
        </div>
        
        <div className="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
          <p>&copy; 2024 Breezeway. –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤.</p>
        </div>
      </div>
    </footer>
  );
}



================================================================================
–§–ê–ô–õ: components/GuestRoute.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/GuestRoute.js
–†–ê–ó–ú–ï–†: 1251 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/GuestRoute.js
'use client';

import { useEffect } from 'react';
import { useRouter } from 'next/navigation';
import { useAuth } from '../contexts/AuthContext';

export default function GuestRoute({ children }) {
  const { user, isLoading } = useAuth();
  const router = useRouter();

  useEffect(() => {
    if (!isLoading && user) {
      // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é
      router.push('/my-vacations');
    }
  }, [user, isLoading, router]);

  if (isLoading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-center">
          <div className="w-16 h-16 border-t-4 border-emerald-500 border-solid rounded-full animate-spin mx-auto mb-4"></div>
          <p className="text-gray-600">–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...</p>
        </div>
      </div>
    );
  }

  if (user) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-center">
          <div className="w-16 h-16 border-t-4 border-emerald-500 border-solid rounded-full animate-spin mx-auto mb-4"></div>
          <p className="text-gray-600">–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ...</p>
        </div>
      </div>
    );
  }

  return children;
}



================================================================================
–§–ê–ô–õ: components/Header.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/Header.js
–†–ê–ó–ú–ï–†: 11477 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/Header.js
'use client';

import Link from 'next/link';
import { useState, useEffect } from 'react';
import { useAuth } from '../contexts/AuthContext';
import NotificationCenter from './NotificationCenter';

export default function Header() {
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const [isNotificationOpen, setIsNotificationOpen] = useState(false);
  const [unreadCount, setUnreadCount] = useState(0);
  const { user, isLoading, logout } = useAuth();

  useEffect(() => {
    if (user) {
      fetchUnreadCount();
    }
  }, [user]);

  const fetchUnreadCount = async () => {
    try {
      const response = await fetch('/api/notifications', {
        credentials: 'include'
      });
      
      if (response.ok) {
        const notifications = await response.json();
        const unread = notifications.filter(n => !n.isRead).length;
        setUnreadCount(unread);
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:', error);
    }
  };

  const handleLogout = async () => {
    await logout();
    setIsMenuOpen(false);
  };

  if (isLoading) {
    return (
      <header className="bg-white shadow-sm sticky top-0 z-50">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between items-center h-16">
            <div className="flex items-center">
              <div className="w-8 h-8 bg-gray-200 rounded-lg animate-pulse"></div>
              <div className="ml-2 w-24 h-6 bg-gray-200 rounded animate-pulse"></div>
            </div>
            <div className="flex space-x-4">
              <div className="w-16 h-8 bg-gray-200 rounded animate-pulse"></div>
              <div className="w-24 h-8 bg-gray-200 rounded animate-pulse"></div>
            </div>
          </div>
        </div>
      </header>
    );
  }

  const isLoggedIn = !!user;

  return (
    <>
      <header className="bg-white shadow-sm sticky top-0 z-40">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between items-center h-16">
            {/* –õ–æ–≥–æ—Ç–∏–ø */}
            <div className="flex items-center">
              <Link href="/" className="flex items-center space-x-2">
                <div className="w-8 h-8 bg-gradient-to-r from-emerald-500 to-teal-400 rounded-lg flex items-center justify-center">
                  <span className="text-white font-bold text-sm">BW</span>
                </div>
                <span className="text-xl font-bold bg-gradient-to-r from-emerald-600 to-teal-500 bg-clip-text text-transparent">
                  Breezeway
                </span>
              </Link>
            </div>

            {/* –ù–∞–≤–∏–≥–∞—Ü–∏—è –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ */}
            <nav className="hidden md:flex items-center space-x-8">
              <Link href="/features" className="text-gray-600 hover:text-emerald-600 transition duration-200 font-medium">
                –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
              </Link>
              <Link href="/about" className="text-gray-600 hover:text-emerald-600 transition duration-200 font-medium">
                –û –Ω–∞—Å
              </Link>
              <Link href="/community" className="text-gray-600 hover:text-emerald-600 transition duration-200 font-medium">
                –°–æ–æ–±—â–µ—Å—Ç–≤–æ
              </Link>
            </nav>

            {/* –ö–Ω–æ–ø–∫–∏ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ */}
            <div className="hidden md:flex items-center space-x-4">
              {isLoggedIn ? (
                <>
                  {/* –¶–µ–Ω—Ç—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */}
                  <button 
                    onClick={() => setIsNotificationOpen(true)}
                    className="relative p-2 text-gray-600 hover:text-emerald-600 transition duration-200"
                  >
                    <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 17h5l-5 5v-5zM10.24 8.56a5.97 5.97 0 01-3.79 2.93A2 2 0 004 13.46v.54a2 2 0 002 2h8a2 2 0 002-2v-.54a2 2 0 00-1.45-1.97 5.97 5.97 0 01-3.79-2.93 2 2 0 00-3.52 0z" />
                    </svg>
                    {unreadCount > 0 && (
                      <span className="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
                        {unreadCount > 9 ? '9+' : unreadCount}
                      </span>
                    )}
                  </button>

                  <Link 
                    href="/my-vacations" 
                    className="text-emerald-600 hover:text-emerald-700 font-medium transition duration-200"
                  >
                    –ú–æ–∏ –æ—Ç–ø—É—Å–∫–∏
                  </Link>
                  <Link 
                    href="/profile" 
                    className="bg-gradient-to-r from-emerald-600 to-teal-500 text-white px-6 py-2 rounded-full hover:from-emerald-700 hover:to-teal-600 transition duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                  >
                    {user?.name || '–ü—Ä–æ—Ñ–∏–ª—å'}
                  </Link>
                  <button 
                    onClick={handleLogout}
                    className="text-gray-600 hover:text-red-600 font-medium transition duration-200"
                  >
                    –í—ã–π—Ç–∏
                  </button>
                </>
              ) : (
                <>
                  <Link 
                    href="/login" 
                    className="text-emerald-600 hover:text-emerald-700 font-medium transition duration-200"
                  >
                    –í—Ö–æ–¥
                  </Link>
                  <Link 
                    href="/registration" 
                    className="bg-gradient-to-r from-emerald-600 to-teal-500 text-white px-6 py-2 rounded-full hover:from-emerald-700 hover:to-teal-600 transition duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                  >
                    –ù–∞—á–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ
                  </Link>
                </>
              )}
            </div>

            {/* –ö–Ω–æ–ø–∫–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é */}
            <button 
              className="md:hidden p-2 rounded-md text-gray-600 hover:text-emerald-600 hover:bg-gray-100 transition duration-200"
              onClick={() => setIsMenuOpen(!isMenuOpen)}
            >
              <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                {isMenuOpen ? (
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                ) : (
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" />
                )}
              </svg>
            </button>
          </div>

          {/* –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é */}
          {isMenuOpen && (
            <div className="md:hidden py-4 border-t border-gray-200 bg-white">
              <div className="flex flex-col space-y-4">
                <Link 
                  href="/features" 
                  className="text-gray-600 hover:text-emerald-600 transition duration-200 font-medium py-2"
                  onClick={() => setIsMenuOpen(false)}
                >
                  –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
                </Link>
                <Link 
                  href="/about" 
                  className="text-gray-600 hover:text-emerald-600 transition duration-200 font-medium py-2"
                  onClick={() => setIsMenuOpen(false)}
                >
                  –û –Ω–∞—Å
                </Link>
                <Link 
                  href="/community" 
                  className="text-gray-600 hover:text-emerald-600 transition duration-200 font-medium py-2"
                  onClick={() => setIsMenuOpen(false)}
                >
                  –°–æ–æ–±—â–µ—Å—Ç–≤–æ
                </Link>
                
                <div className="pt-4 border-t border-gray-200 space-y-3">
                  {isLoggedIn ? (
                    <>
                      <button 
                        onClick={() => {
                          setIsNotificationOpen(true);
                          setIsMenuOpen(false);
                        }}
                        className="flex items-center space-x-2 text-gray-600 hover:text-emerald-600 transition duration-200 py-2 w-full text-left"
                      >
                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 17h5l-5 5v-5zM10.24 8.56a5.97 5.97 0 01-3.79 2.93A2 2 0 004 13.46v.54a2 2 0 002 2h8a2 2 0 002-2v-.54a2 2 0 00-1.45-1.97 5.97 5.97 0 01-3.79-2.93 2 2 0 00-3.52 0z" />
                        </svg>
                        <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                        {unreadCount > 0 && (
                          <span className="bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
                            {unreadCount}
                          </span>
                        )}
                      </button>

                      <Link 
                        href="/my-vacations" 
                        className="block text-emerald-600 hover:text-emerald-700 font-medium transition duration-200 py-2"
                        onClick={() => setIsMenuOpen(false)}
                      >
                        –ú–æ–∏ –æ—Ç–ø—É—Å–∫–∏
                      </Link>
                      <Link 
                        href="/profile" 
                        className="block bg-gradient-to-r from-emerald-600 to-teal-500 text-white text-center px-6 py-3 rounded-full hover:from-emerald-700 hover:to-teal-600 transition duration-200 shadow-lg"
                        onClick={() => setIsMenuOpen(false)}
                      >
                        {user?.name || '–ü—Ä–æ—Ñ–∏–ª—å'}
                      </Link>
                      <button 
                        onClick={handleLogout}
                        className="block w-full text-gray-600 hover:text-red-600 text-center font-medium transition duration-200 py-2"
                      >
                        –í—ã–π—Ç–∏
                      </button>
                    </>
                  ) : (
                    <>
                      <Link 
                        href="/login" 
                        className="block text-emerald-600 hover:text-emerald-700 font-medium transition duration-200 py-2"
                        onClick={() => setIsMenuOpen(false)}
                      >
                        –í—Ö–æ–¥
                      </Link>
                      <Link 
                        href="/registration" 
                        className="block bg-gradient-to-r from-emerald-600 to-teal-500 text-white text-center px-6 py-3 rounded-full hover:from-emerald-700 hover:to-teal-600 transition duration-200 shadow-lg"
                        onClick={() => setIsMenuOpen(false)}
                      >
                        –ù–∞—á–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ
                      </Link>
                    </>
                  )}
                </div>
              </div>
            </div>
          )}
        </div>
      </header>

      {/* –¶–µ–Ω—Ç—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */}
      <NotificationCenter 
        isOpen={isNotificationOpen}
        onClose={() => setIsNotificationOpen(false)}
        onUpdate={fetchUnreadCount}
      />
    </>
  );
}



================================================================================
–§–ê–ô–õ: components/Header.jsssss
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/Header.jsssss
–†–ê–ó–ú–ï–†: 11536 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/Header.js
'use client';

import Link from 'next/link';
import { useState, useEffect } from 'react';
import { useAuth } from '../contexts/AuthContext';
import NotificationCenter from './NotificationCenter';

export default function Header() {
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const [isNotificationOpen, setIsNotificationOpen] = useState(false);
  const [unreadCount, setUnreadCount] = useState(0);
  const { user, isLoading, logout } = useAuth();

  useEffect(() => {
    if (user) {
      fetchUnreadCount();
    }
  }, [user]);

  const fetchUnreadCount = async () => {
    try {
      const response = await fetch('/api/notifications', {
        credentials: 'include'
      });
      
      if (response.ok) {
        const notifications = await response.json();
        const unread = notifications.filter(n => !n.isRead).length;
        setUnreadCount(unread);
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:', error);
    }
  };

  const handleLogout = async () => {
    await logout();
    setIsMenuOpen(false);
  };

  if (isLoading) {
    return (
      <header className="bg-white shadow-sm sticky top-0 z-50">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between items-center h-16">
            <div className="flex items-center">
              <div className="w-8 h-8 bg-gray-200 rounded-lg animate-pulse"></div>
              <div className="ml-2 w-24 h-6 bg-gray-200 rounded animate-pulse"></div>
            </div>
            <div className="flex space-x-4">
              <div className="w-16 h-8 bg-gray-200 rounded animate-pulse"></div>
              <div className="w-24 h-8 bg-gray-200 rounded animate-pulse"></div>
            </div>
          </div>
        </div>
      </header>
    );
  }

  const isLoggedIn = !!user;

  return (
    <>
      <header className="bg-white shadow-sm sticky top-0 z-40">
        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div className="flex justify-between items-center h-16">
            {/* –õ–æ–≥–æ—Ç–∏–ø */}
            <div className="flex items-center">
              <Link href="/" className="flex items-center space-x-2">
                <div className="w-8 h-8 bg-gradient-to-r from-emerald-500 to-teal-400 rounded-lg flex items-center justify-center">
                  <span className="text-white font-bold text-sm">BW</span>
                </div>
                <span className="text-xl font-bold bg-gradient-to-r from-emerald-600 to-teal-500 bg-clip-text text-transparent">
                  Breezeway
                </span>
              </Link>
            </div>

            {/* –ù–∞–≤–∏–≥–∞—Ü–∏—è –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ */}
            <nav className="hidden md:flex items-center space-x-8">
              <Link href="/features" className="text-gray-600 hover:text-emerald-600 transition duration-200 font-medium">
                –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
              </Link>
              <Link href="/about" className="text-gray-600 hover:text-emerald-600 transition duration-200 font-medium">
                –û –Ω–∞—Å
              </Link>
              <Link href="/community" className="text-gray-600 hover:text-emerald-600 transition duration-200 font-medium">
                –°–æ–æ–±—â–µ—Å—Ç–≤–æ
              </Link>
            </nav>

            {/* –ö–Ω–æ–ø–∫–∏ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ */}
            <div className="hidden md:flex items-center space-x-4">
              {isLoggedIn ? (
                <>
                  {/* –¶–µ–Ω—Ç—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */}
                  <button 
                    onClick={() => setIsNotificationOpen(true)}
                    className="relative p-2 text-gray-600 hover:text-emerald-600 transition duration-200"
                  >
                    <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 17h5l-5 5v-5zM10.24 8.56a5.97 5.97 0 01-3.79 2.93A2 2 0 004 13.46v.54a2 2 0 002 2h8a2 2 0 002-2v-.54a2 2 0 00-1.45-1.97 5.97 5.97 0 01-3.79-2.93 2 2 0 00-3.52 0z" />
                    </svg>
                    {unreadCount > 0 && (
                      <span className="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
                        {unreadCount > 9 ? '9+' : unreadCount}
                      </span>
                    )}
                  </button>

                  <Link 
                    href="/my-vacations" 
                    className="text-emerald-600 hover:text-emerald-700 font-medium transition duration-200"
                  >
                    –ú–æ–∏ –æ—Ç–ø—É—Å–∫–∏
                  </Link>
                  <Link 
                    href="/profile" 
                    className="bg-gradient-to-r from-emerald-600 to-teal-500 text-white px-6 py-2 rounded-full hover:from-emerald-700 hover:to-teal-600 transition duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                  >
                    {user?.name || '–ü—Ä–æ—Ñ–∏–ª—å'}
                  </Link>
                  <button 
                    onClick={handleLogout}
                    className="text-gray-600 hover:text-red-600 font-medium transition duration-200"
                  >
                    –í—ã–π—Ç–∏
                  </button>
                </>
              ) : (
                <>
                  <Link 
                    href="/login" 
                    className="text-emerald-600 hover:text-emerald-700 font-medium transition duration-200"
                  >
                    –í—Ö–æ–¥
                  </Link>
                  <Link 
                    href="/registration" 
                    className="bg-gradient-to-r from-emerald-600 to-teal-500 text-white px-6 py-2 rounded-full hover:from-emerald-700 hover:to-teal-600 transition duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                  >
                    –ù–∞—á–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ
                  </Link>
                </>
              )}
            </div>

            {/* –ö–Ω–æ–ø–∫–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é */}
            <button 
              className="md:hidden p-2 rounded-md text-gray-600 hover:text-emerald-600 hover:bg-gray-100 transition duration-200"
              onClick={() => setIsMenuOpen(!isMenuOpen)}
            >
              <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                {isMenuOpen ? (
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                ) : (
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" />
                )}
              </svg>
            </button>
          </div>

          {/* –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é */}
          {isMenuOpen && (
            <div className="md:hidden py-4 border-t border-gray-200 bg-white">
              <div className="flex flex-col space-y-4">
                <Link 
                  href="/features" 
                  className="text-gray-600 hover:text-emerald-600 transition duration-200 font-medium py-2"
                  onClick={() => setIsMenuOpen(false)}
                >
                  –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
                </Link>
                <Link 
                  href="/about" 
                  className="text-gray-600 hover:text-emerald-600 transition duration-200 font-medium py-2"
                  onClick={() => setIsMenuOpen(false)}
                >
                  –û –Ω–∞—Å
                </Link>
                <Link 
                  href="/community" 
                  className="text-gray-600 hover:text-emerald-600 transition duration-200 font-medium py-2"
                  onClick={() => setIsMenuOpen(false)}
                >
                  –°–æ–æ–±—â–µ—Å—Ç–≤–æ
                </Link>
                
                <div className="pt-4 border-t border-gray-200 space-y-3">
                  {isLoggedIn ? (
                    <>
                      {/* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –º–æ–±–∏–ª—å–Ω–æ–º –º–µ–Ω—é */}
                      <button 
                        onClick={() => {
                          setIsNotificationOpen(true);
                          setIsMenuOpen(false);
                        }}
                        className="flex items-center space-x-2 text-gray-600 hover:text-emerald-600 transition duration-200 py-2 w-full text-left"
                      >
                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 17h5l-5 5v-5zM10.24 8.56a5.97 5.97 0 01-3.79 2.93A2 2 0 004 13.46v.54a2 2 0 002 2h8a2 2 0 002-2v-.54a2 2 0 00-1.45-1.97 5.97 5.97 0 01-3.79-2.93 2 2 0 00-3.52 0z" />
                        </svg>
                        <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                        {unreadCount > 0 && (
                          <span className="bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center">
                            {unreadCount}
                          </span>
                        )}
                      </button>

                      <Link 
                        href="/my-vacations" 
                        className="block text-emerald-600 hover:text-emerald-700 font-medium transition duration-200 py-2"
                        onClick={() => setIsMenuOpen(false)}
                      >
                        –ú–æ–∏ –æ—Ç–ø—É—Å–∫–∏
                      </Link>
                      <Link 
                        href="/profile" 
                        className="block bg-gradient-to-r from-emerald-600 to-teal-500 text-white text-center px-6 py-3 rounded-full hover:from-emerald-700 hover:to-teal-600 transition duration-200 shadow-lg"
                        onClick={() => setIsMenuOpen(false)}
                      >
                        {user?.name || '–ü—Ä–æ—Ñ–∏–ª—å'}
                      </Link>
                      <button 
                        onClick={handleLogout}
                        className="block w-full text-gray-600 hover:text-red-600 text-center font-medium transition duration-200 py-2"
                      >
                        –í—ã–π—Ç–∏
                      </button>
                    </>
                  ) : (
                    <>
                      <Link 
                        href="/login" 
                        className="block text-emerald-600 hover:text-emerald-700 font-medium transition duration-200 py-2"
                        onClick={() => setIsMenuOpen(false)}
                      >
                        –í—Ö–æ–¥
                      </Link>
                      <Link 
                        href="/registration" 
                        className="block bg-gradient-to-r from-emerald-600 to-teal-500 text-white text-center px-6 py-3 rounded-full hover:from-emerald-700 hover:to-teal-600 transition duration-200 shadow-lg"
                        onClick={() => setIsMenuOpen(false)}
                      >
                        –ù–∞—á–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ
                      </Link>
                    </>
                  )}
                </div>
              </div>
            </div>
          )}
        </div>
      </header>

      {/* –¶–µ–Ω—Ç—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */}
      <NotificationCenter 
        isOpen={isNotificationOpen}
        onClose={() => setIsNotificationOpen(false)}
        onUpdate={fetchUnreadCount}
      />
    </>
  );
}



================================================================================
–§–ê–ô–õ: components/HeroSection.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/HeroSection.js
–†–ê–ó–ú–ï–†: 6197 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/HeroSection.js
import Link from 'next/link';

export default function HeroSection() {
  return (
    <section className="relative bg-gradient-to-br from-emerald-50 via-white to-teal-50 overflow-hidden">
      {/* –§–æ–Ω–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã */}
      <div className="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiNmMWY1ZjkiIGZpbGwtb3BhY2l0eT0iMC40Ij48Y2lyY2xlIGN4PSIzMCIgY3k9IjMwIiByPSIyIi8+PC9nPjwvZz48L3N2Zz4=')] opacity-50"></div>
      
      <div className="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20 lg:py-32">
        <div className="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
          {/* –¢–µ–∫—Å—Ç–æ–≤–∞—è —á–∞—Å—Ç—å */}
          <div className="text-center lg:text-left">
            {/* –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –±–µ–π–¥–∂ */}
            <div className="inline-flex items-center space-x-2 bg-white text-emerald-700 px-4 py-2 rounded-full text-sm font-medium shadow-sm mb-6">
              <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fillRule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clipRule="evenodd" />
              </svg>
              <span>–ù–∏–∫–∞–∫–∏—Ö —Ç–∞—Ä–∏—Ñ–æ–≤ ‚Ä¢ –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
            </div>

            <h1 className="text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 leading-tight">
              –ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –æ—Ç–ø—É—Å–∫
              <span className="block bg-gradient-to-r from-emerald-600 to-teal-500 bg-clip-text text-transparent">
                –≤–º–µ—Å—Ç–µ —Å –¥—Ä—É–∑—å—è–º–∏
              </span>
            </h1>
            
            <p className="mt-6 text-xl text-gray-600 max-w-2xl">
              –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è, –¥–µ–ª–∏—Ç–µ—Å—å –º–æ–º–µ–Ω—Ç–∞–º–∏ –∏ –Ω–∞—Ö–æ–¥–∏—Ç–µ –Ω–æ–≤—ã—Ö 
              –ø–æ–ø—É—Ç—á–∏–∫–æ–≤. –ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –Ω–∞–≤—Å–µ–≥–¥–∞.
            </p>

            {/* CTA –∫–Ω–æ–ø–∫–∏ */}
            <div className="mt-10 flex flex-col sm:flex-row gap-4 justify-center lg:justify-start">
              <Link 
                href="/registration" 
                className="bg-gradient-to-r from-emerald-600 to-teal-500 text-white px-8 py-4 rounded-full text-lg font-semibold hover:from-emerald-700 hover:to-teal-600 transition duration-200 shadow-xl hover:shadow-2xl transform hover:-translate-y-1 inline-flex items-center justify-center"
              >
                –ù–∞—á–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ
                <svg className="ml-2 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7l5 5m0 0l-5 5m5-5H6" />
                </svg>
              </Link>
              
              <Link 
                href="/features" 
                className="border border-gray-300 text-gray-700 px-8 py-4 rounded-full text-lg font-semibold hover:border-emerald-400 hover:text-emerald-600 transition duration-200 inline-flex items-center justify-center"
              >
                <svg className="mr-2 w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                –°–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
              </Link>
            </div>

            {/* –ì–∞—Ä–∞–Ω—Ç–∏—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ—Å—Ç–∏ */}
            <div className="mt-8 flex items-center justify-center lg:justify-start space-x-4 text-sm text-gray-500">
              <div className="flex items-center space-x-1">
                <svg className="w-4 h-4 text-emerald-500" fill="currentColor" viewBox="0 0 20 20">
                  <path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" />
                </svg>
                <span>–ë–µ–∑ –ø–æ–¥–ø–∏—Å–æ–∫</span>
              </div>
              <div className="flex items-center space-x-1">
                <svg className="w-4 h-4 text-emerald-500" fill="currentColor" viewBox="0 0 20 20">
                  <path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" />
                </svg>
                <span>–ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π</span>
              </div>
              <div className="flex items-center space-x-1">
                <svg className="w-4 h-4 text-emerald-500" fill="currentColor" viewBox="0 0 20 20">
                  <path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" />
                </svg>
                <span>–ù–∞–≤—Å–µ–≥–¥–∞</span>
              </div>
            </div>
          </div>

          {/* –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥–µ—Ä–æ—è */}
          <div className="relative">
            <div className="relative rounded-2xl overflow-hidden shadow-2xl">
              <div className="bg-gradient-to-br from-emerald-400 to-teal-300 aspect-[4/3] rounded-2xl flex items-center justify-center">
                <div className="text-white text-center p-8">
                  <svg className="w-24 h-24 mx-auto mb-4 opacity-80" fill="currentColor" viewBox="0 0 20 20">
                    <path fillRule="evenodd" d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2h-3a1 1 0 01-1-1v-2a1 1 0 00-1-1H9a1 1 0 00-1 1v2a1 1 0 01-1 1H4a1 1 0 110-2V4zm3 1h2v2H7V5zm2 4H7v2h2V9zm2-4h2v2h-2V5zm2 4h-2v2h2V9z" clipRule="evenodd" />
                  </svg>
                  <p className="text-xl font-semibold">Breezeway</p>
                  <p className="text-emerald-100 mt-2">–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –æ—Ç–ø—É—Å–∫–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  );
}



================================================================================
–§–ê–ô–õ: components/Notification.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/Notification.js
–†–ê–ó–ú–ï–†: 2746 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/Notification.js
'use client';

import { useEffect } from 'react';

export default function Notification({ message, type = 'error', onClose }) {
  useEffect(() => {
    if (message) {
      const timer = setTimeout(() => {
        onClose();
      }, 5000);

      return () => clearTimeout(timer);
    }
  }, [message, onClose]);

  if (!message) return null;

  const styles = {
    error: 'bg-red-50 border-red-200 text-red-600',
    success: 'bg-green-50 border-green-200 text-green-600',
    warning: 'bg-yellow-50 border-yellow-200 text-yellow-600',
    info: 'bg-blue-50 border-blue-200 text-blue-600'
  };

  const icons = {
    error: (
      <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
        <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clipRule="evenodd" />
      </svg>
    ),
    success: (
      <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
        <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
      </svg>
    ),
    warning: (
      <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
        <path fillRule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
      </svg>
    ),
    info: (
      <svg className="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
        <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clipRule="evenodd" />
      </svg>
    )
  };

  return (
    <div className={`fixed top-4 right-4 border rounded-lg p-4 shadow-lg z-50 max-w-sm ${styles[type]}`}>
      <div className="flex items-start space-x-3">
        <div className="flex-shrink-0">
          {icons[type]}
        </div>
        <div className="flex-1">
          <p className="text-sm font-medium">{message}</p>
        </div>
        <button
          onClick={onClose}
          className="flex-shrink-0 hover:opacity-70 transition-opacity"
        >
          <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    </div>
  );
}



================================================================================
–§–ê–ô–õ: components/NotificationCenter.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/NotificationCenter.js
–†–ê–ó–ú–ï–†: 7720 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/NotificationCenter.js
'use client';

import { useState, useEffect } from 'react';
import Link from 'next/link';
import NotificationFactory from './notifications/NotificationFactory';

export default function NotificationCenter({ isOpen, onClose, onUpdate }) {
  const [notifications, setNotifications] = useState([]);
  const [isLoading, setIsLoading] = useState(false);

  useEffect(() => {
    if (isOpen) {
      fetchNotifications();
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = 'unset';
    }

    return () => {
      document.body.style.overflow = 'unset';
    };
  }, [isOpen]);

  const fetchNotifications = async () => {
    setIsLoading(true);
    try {
      const response = await fetch('/api/notifications', {
        credentials: 'include'
      });
      
      if (response.ok) {
        const data = await response.json();
        setNotifications(data);
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:', error);
    } finally {
      setIsLoading(false);
    }
  };

  const markAsRead = async (notificationId = null) => {
    try {
      const response = await fetch('/api/notifications', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          notificationIds: notificationId ? [notificationId] : null
        }),
        credentials: 'include'
      });

      if (response.ok) {
        fetchNotifications();
        onUpdate?.();
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:', error);
    }
  };

  if (!isOpen) return null;

  const unreadCount = notifications.filter(n => !n.isRead).length;

  return (
    <div className="fixed inset-0 z-[9999]">
      <div className="flex items-center justify-center h-full">
        {/* –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è */}
        <div className="md:hidden w-full h-full bg-white flex flex-col">
          <Header 
            unreadCount={unreadCount} 
            onMarkAllAsRead={() => markAsRead()} 
            onClose={onClose}
            isMobile={true}
          />
          <NotificationContent 
            isLoading={isLoading}
            notifications={notifications}
            markAsRead={markAsRead}
            fetchNotifications={fetchNotifications}
          />
        </div>

        {/* –î–µ—Å–∫—Ç–æ–ø –≤–µ—Ä—Å–∏—è */}
        <div className="hidden md:block w-full max-w-2xl max-h-[90vh] bg-white rounded-2xl shadow-2xl border border-gray-200 mx-4">
          <div className="flex flex-col h-full">
            <Header 
              unreadCount={unreadCount} 
              onMarkAllAsRead={() => markAsRead()} 
              onClose={onClose}
              isMobile={false}
            />
            
            <div className="flex-1 overflow-y-auto">
              <NotificationContent 
                isLoading={isLoading}
                notifications={notifications}
                markAsRead={markAsRead}
                fetchNotifications={fetchNotifications}
              />
            </div>

            <Footer onClose={onClose} />
          </div>
        </div>
      </div>
    </div>
  );
}

// –í—ã–Ω–µ—Å–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è —á–∏—Å—Ç–æ—Ç—ã –∫–æ–¥–∞
function Header({ unreadCount, onMarkAllAsRead, onClose, isMobile }) {
  return (
    <div className={`flex items-center justify-between ${isMobile ? 'p-4 border-b border-gray-200' : 'p-6 border-b border-gray-200 rounded-t-2xl'}`}>
      <div className="flex items-center space-x-3">
        {isMobile && (
          <button onClick={onClose} className="p-2 hover:bg-gray-100 rounded-lg">
            <svg className="w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
            </svg>
          </button>
        )}
        <div className="flex items-center space-x-3">
          {!isMobile && (
            <div className="w-8 h-8 bg-emerald-500 rounded-lg flex items-center justify-center">
              <svg className="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 17h5l-5 5v-5zM10.24 8.56a5.97 5.97 0 01-3.79 2.93A2 2 0 004 13.46v.54a2 2 0 002 2h8a2 2 0 002-2v-.54a2 2 0 00-1.45-1.97 5.97 5.97 0 01-3.79-2.93 2 2 0 00-3.52 0z" />
              </svg>
            </div>
          )}
          <div>
            <h2 className="text-xl font-bold text-gray-900">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h2>
            {unreadCount > 0 && (
              <p className="text-sm text-gray-600">{unreadCount} –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö</p>
            )}
          </div>
        </div>
      </div>
      
      <div className="flex items-center space-x-3">
        {unreadCount > 0 && (
          <button
            onClick={onMarkAllAsRead}
            className="text-sm text-blue-600 hover:text-blue-700 px-3 py-1 rounded-lg hover:bg-blue-50"
          >
            –ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ
          </button>
        )}
        {!isMobile && (
          <button onClick={onClose} className="p-2 hover:bg-gray-100 rounded-lg">
            <svg className="w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        )}
      </div>
    </div>
  );
}

function Footer({ onClose }) {
  return (
    <div className="p-4 border-t border-gray-200 bg-gray-50 rounded-b-2xl">
      <Link
        href="/notifications"
        className="block w-full text-center bg-white text-gray-700 py-3 rounded-lg hover:bg-gray-100 text-sm font-medium border border-gray-300"
        onClick={onClose}
      >
        –í—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
      </Link>
    </div>
  );
}

function NotificationContent({ isLoading, notifications, markAsRead, fetchNotifications }) {
  if (isLoading) {
    return (
      <div className="space-y-4 p-6">
        {[...Array(6)].map((_, i) => (
          <div key={i} className="animate-pulse">
            <div className="flex space-x-3">
              <div className="w-2 h-2 bg-gray-200 rounded-full mt-3"></div>
              <div className="flex-1 space-y-2">
                <div className="h-4 bg-gray-200 rounded w-3/4"></div>
                <div className="h-3 bg-gray-200 rounded w-full"></div>
                <div className="h-2 bg-gray-200 rounded w-1/2"></div>
              </div>
            </div>
          </div>
        ))}
      </div>
    );
  }

  if (notifications.length === 0) {
    return (
      <div className="flex flex-col items-center justify-center h-64 text-gray-500 p-8">
        <div className="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4">
          <svg className="w-10 h-10 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 17h5l-5 5v-5zM10.24 8.56a5.97 5.97 0 01-3.79 2.93A2 2 0 004 13.46v.54a2 2 0 002 2h8a2 2 0 002-2v-.54a2 2 0 00-1.45-1.97 5.97 5.97 0 01-3.79-2.93 2 2 0 00-3.52 0z" />
          </svg>
        </div>
        <h3 className="text-lg font-semibold text-gray-900 mb-2">–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h3>
        <p className="text-center text-gray-600">–ó–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –≤–∞—à–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</p>
      </div>
    );
  }

  return (
    <div className="p-4 space-y-3">
      {notifications.map((notification) => (
        <NotificationFactory
          key={notification.id}
          notification={notification}
          onMarkAsRead={markAsRead}
          onUpdate={fetchNotifications}
        />
      ))}
    </div>
  );
}



================================================================================
–§–ê–ô–õ: components/NotificationCenter.jss
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/NotificationCenter.jss
–†–ê–ó–ú–ï–†: 14569 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/NotificationCenter.js
'use client';

import { useState, useEffect } from 'react';
import Link from 'next/link';

export default function NotificationCenter({ isOpen, onClose, onUpdate }) {
  const [notifications, setNotifications] = useState([]);
  const [isLoading, setIsLoading] = useState(false);

  useEffect(() => {
    if (isOpen) {
      fetchNotifications();
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = 'unset';
    }

    return () => {
      document.body.style.overflow = 'unset';
    };
  }, [isOpen]);

  const fetchNotifications = async () => {
    setIsLoading(true);
    try {
      const response = await fetch('/api/notifications', {
        credentials: 'include'
      });
      
      if (response.ok) {
        const data = await response.json();
        setNotifications(data);
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:', error);
    } finally {
      setIsLoading(false);
    }
  };

  const markAsRead = async (notificationId = null) => {
    try {
      const response = await fetch('/api/notifications', {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          notificationIds: notificationId ? [notificationId] : null
        }),
        credentials: 'include'
      });

      if (response.ok) {
        fetchNotifications();
        onUpdate?.();
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:', error);
    }
  };

  if (!isOpen) return null;

  const unreadCount = notifications.filter(n => !n.isRead).length;

  return (
    <div className="fixed inset-0 z-100">
      {/* –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö - –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω, –Ω–∞ –ü–ö - –ø–æ —Ü–µ–Ω—Ç—Ä—É */}
      <div className="flex items-center justify-center h-full">
        {/* –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è - –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω */}
        <div className="md:hidden w-full h-full bg-white flex flex-col">
          {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */}
          <div className="flex items-center justify-between p-4 border-b border-gray-200 bg-white">
            <div className="flex items-center space-x-3">
              <button
                onClick={onClose}
                className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
              >
                <svg className="w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                </svg>
              </button>
              <div>
                <h2 className="text-xl font-bold text-gray-900">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h2>
                {unreadCount > 0 && (
                  <p className="text-sm text-gray-600">{unreadCount} –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö</p>
                )}
              </div>
            </div>
            
            <div className="flex items-center space-x-2">
              {unreadCount > 0 && (
                <button
                  onClick={() => markAsRead()}
                  className="text-sm text-blue-600 hover:text-blue-700 px-3 py-1 rounded-lg hover:bg-blue-50 transition-colors"
                >
                  –ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ
                </button>
              )}
            </div>
          </div>

          {/* –ö–æ–Ω—Ç–µ–Ω—Ç */}
          <div className="flex-1 overflow-y-auto">
            {isLoading ? (
              <div className="space-y-4 p-4">
                {[...Array(8)].map((_, i) => (
                  <div key={i} className="animate-pulse">
                    <div className="flex space-x-3">
                      <div className="w-2 h-2 bg-gray-200 rounded-full mt-3"></div>
                      <div className="flex-1 space-y-2">
                        <div className="h-4 bg-gray-200 rounded w-3/4"></div>
                        <div className="h-3 bg-gray-200 rounded w-full"></div>
                        <div className="h-2 bg-gray-200 rounded w-1/2"></div>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            ) : notifications.length === 0 ? (
              <div className="flex flex-col items-center justify-center h-full text-gray-500 p-8">
                <div className="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4">
                  <svg className="w-10 h-10 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 17h5l-5 5v-5zM10.24 8.56a5.97 5.97 0 01-3.79 2.93A2 2 0 004 13.46v.54a2 2 0 002 2h8a2 2 0 002-2v-.54a2 2 0 00-1.45-1.97 5.97 5.97 0 01-3.79-2.93 2 2 0 00-3.52 0z" />
                  </svg>
                </div>
                <h3 className="text-lg font-semibold text-gray-900 mb-2">–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h3>
                <p className="text-center text-gray-600">–ó–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –≤–∞—à–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</p>
              </div>
            ) : (
              <div className="p-4 space-y-3">
                {notifications.map((notification) => (
                  <div
                    key={notification.id}
                    className={`p-4 rounded-xl border transition-all duration-200 ${
                      !notification.isRead 
                        ? 'bg-blue-50 border-blue-200' 
                        : 'bg-white border-gray-200 hover:shadow-md'
                    }`}
                  >
                    <div className="flex items-start space-x-3">
                      <div className={`w-2 h-2 rounded-full mt-2 flex-shrink-0 ${
                        !notification.isRead ? 'bg-blue-500' : 'bg-gray-400'
                      }`} />
                      <div className="flex-1 min-w-0">
                        <div className="flex items-start justify-between mb-2">
                          <h3 className="text-sm font-semibold text-gray-900">
                            {notification.title}
                          </h3>
                          <span className="text-xs text-gray-500 whitespace-nowrap ml-2">
                            {new Date(notification.createdAt).toLocaleDateString('ru-RU')}
                          </span>
                        </div>
                        <p className="text-sm text-gray-600 mb-3">
                          {notification.message}
                        </p>
                        {notification.type === 'invitation' && !notification.isRead && (
                          <div className="flex space-x-2">
                            <button
                              onClick={() => markAsRead(notification.id)}
                              className="flex-1 bg-emerald-500 text-white px-4 py-3 rounded-lg hover:bg-emerald-600 transition-colors font-medium"
                            >
                              –ü—Ä–∏–Ω—è—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ
                            </button>
                            <button
                              onClick={() => markAsRead(notification.id)}
                              className="flex-1 bg-gray-300 text-gray-700 px-4 py-3 rounded-lg hover:bg-gray-400 transition-colors font-medium"
                            >
                              –û—Ç–∫–ª–æ–Ω–∏—Ç—å
                            </button>
                          </div>
                        )}
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>
        </div>

        {/* –î–µ—Å–∫—Ç–æ–ø –≤–µ—Ä—Å–∏—è - –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */}
        <div className="hidden md:block w-full max-w-2xl max-h-[90vh] bg-white rounded-2xl shadow-2xl border border-gray-200 mx-4">
          <div className="flex flex-col h-full">
            {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */}
            <div className="flex items-center justify-between p-6 border-b border-gray-200 bg-white rounded-t-2xl">
              <div className="flex items-center space-x-3">
                <div className="w-8 h-8 bg-emerald-500 rounded-lg flex items-center justify-center">
                  <svg className="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 17h5l-5 5v-5zM10.24 8.56a5.97 5.97 0 01-3.79 2.93A2 2 0 004 13.46v.54a2 2 0 002 2h8a2 2 0 002-2v-.54a2 2 0 00-1.45-1.97 5.97 5.97 0 01-3.79-2.93 2 2 0 00-3.52 0z" />
                  </svg>
                </div>
                <div>
                  <h2 className="text-xl font-bold text-gray-900">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h2>
                  {unreadCount > 0 && (
                    <p className="text-sm text-gray-600">{unreadCount} –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö</p>
                  )}
                </div>
              </div>
              
              <div className="flex items-center space-x-3">
                {unreadCount > 0 && (
                  <button
                    onClick={() => markAsRead()}
                    className="text-sm text-blue-600 hover:text-blue-700 px-3 py-1 rounded-lg hover:bg-blue-50 transition-colors"
                  >
                    –ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ
                  </button>
                )}
                <button
                  onClick={onClose}
                  className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
                >
                  <svg className="w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
              </div>
            </div>

            {/* –ö–æ–Ω—Ç–µ–Ω—Ç */}
            <div className="flex-1 overflow-y-auto">
              {isLoading ? (
                <div className="space-y-4 p-6">
                  {[...Array(6)].map((_, i) => (
                    <div key={i} className="animate-pulse">
                      <div className="flex space-x-3">
                        <div className="w-2 h-2 bg-gray-200 rounded-full mt-3"></div>
                        <div className="flex-1 space-y-2">
                          <div className="h-4 bg-gray-200 rounded w-3/4"></div>
                          <div className="h-3 bg-gray-200 rounded w-full"></div>
                          <div className="h-2 bg-gray-200 rounded w-1/2"></div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              ) : notifications.length === 0 ? (
                <div className="flex flex-col items-center justify-center h-64 text-gray-500 p-8">
                  <div className="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4">
                    <svg className="w-10 h-10 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 17h5l-5 5v-5zM10.24 8.56a5.97 5.97 0 01-3.79 2.93A2 2 0 004 13.46v.54a2 2 0 002 2h8a2 2 0 002-2v-.54a2 2 0 00-1.45-1.97 5.97 5.97 0 01-3.79-2.93 2 2 0 00-3.52 0z" />
                    </svg>
                  </div>
                  <h3 className="text-lg font-semibold text-gray-900 mb-2">–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h3>
                  <p className="text-center text-gray-600">–ó–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –≤–∞—à–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</p>
                </div>
              ) : (
                <div className="p-4 space-y-3">
                  {notifications.map((notification) => (
                    <div
                      key={notification.id}
                      className={`p-4 rounded-xl border transition-all duration-200 ${
                        !notification.isRead 
                          ? 'bg-blue-50 border-blue-200' 
                          : 'bg-white border-gray-200 hover:shadow-md'
                      }`}
                    >
                      <div className="flex items-start space-x-3">
                        <div className={`w-2 h-2 rounded-full mt-2 flex-shrink-0 ${
                          !notification.isRead ? 'bg-blue-500' : 'bg-gray-400'
                        }`} />
                        <div className="flex-1 min-w-0">
                          <div className="flex items-start justify-between mb-2">
                            <h3 className="text-sm font-semibold text-gray-900">
                              {notification.title}
                            </h3>
                            <span className="text-xs text-gray-500 whitespace-nowrap ml-2">
                              {new Date(notification.createdAt).toLocaleDateString('ru-RU')}
                            </span>
                          </div>
                          <p className="text-sm text-gray-600 mb-3">
                            {notification.message}
                          </p>
                          {notification.type === 'invitation' && !notification.isRead && (
                            <div className="flex space-x-2">
                              <button
                                onClick={() => markAsRead(notification.id)}
                                className="text-sm bg-emerald-500 text-white px-4 py-2 rounded-lg hover:bg-emerald-600 transition-colors font-medium"
                              >
                                –ü—Ä–∏–Ω—è—Ç—å
                              </button>
                              <button
                                onClick={() => markAsRead(notification.id)}
                                className="text-sm bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors font-medium"
                              >
                                –û—Ç–∫–ª–æ–Ω–∏—Ç—å
                              </button>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </div>

            {/* –§—É—Ç–µ—Ä */}
            <div className="p-4 border-t border-gray-200 bg-gray-50 rounded-b-2xl">
              <Link
                href="/notifications"
                className="block w-full text-center bg-white text-gray-700 py-3 rounded-lg hover:bg-gray-100 transition-colors text-sm font-medium border border-gray-300"
                onClick={onClose}
              >
                –í—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
              </Link>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}



================================================================================
–§–ê–ô–õ: components/ProtectedRoute.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/ProtectedRoute.js
–†–ê–ó–ú–ï–†: 1206 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/ProtectedRoute.js
'use client';

import { useEffect } from 'react';
import { useRouter } from 'next/navigation';
import { useAuth } from '../contexts/AuthContext';

export default function ProtectedRoute({ children }) {
  const { user, isLoading } = useAuth();
  const router = useRouter();

  useEffect(() => {
    if (!isLoading && !user) {
      router.push('/login');
    }
  }, [user, isLoading, router]);

  if (isLoading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-center">
          <div className="w-16 h-16 border-t-4 border-emerald-500 border-solid rounded-full animate-spin mx-auto mb-4"></div>
          <p className="text-gray-600">–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...</p>
        </div>
      </div>
    );
  }

  if (!user) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="text-center">
          <div className="w-16 h-16 border-t-4 border-emerald-500 border-solid rounded-full animate-spin mx-auto mb-4"></div>
          <p className="text-gray-600">–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞...</p>
        </div>
      </div>
    );
  }

  return children;
}



================================================================================
–§–ê–ô–õ: components/RegistrationForm.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/RegistrationForm.js
–†–ê–ó–ú–ï–†: 8750 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/RegistrationForm.js
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import Link from 'next/link';
import Notification from './Notification';

export default function RegistrationForm() {
  const router = useRouter();
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    password: '',
    confirmPassword: ''
  });
  const [errors, setErrors] = useState({});
  const [isLoading, setIsLoading] = useState(false);
  const [notification, setNotification] = useState({ message: '', type: '' });

  const validateForm = () => {
    const newErrors = {};

    if (!formData.name.trim()) {
      newErrors.name = '–ò–º—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ';
    } else if (formData.name.length < 2) {
      newErrors.name = '–ò–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞';
    }

    if (!formData.email.trim()) {
      newErrors.email = 'Email –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω';
    } else if (!/\S+@\S+\.\S+/.test(formData.email)) {
      newErrors.email = '–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email';
    }

    if (!formData.password) {
      newErrors.password = '–ü–∞—Ä–æ–ª—å –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω';
    } else if (formData.password.length < 6) {
      newErrors.password = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤';
    }

    if (!formData.confirmPassword) {
      newErrors.confirmPassword = '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ';
    } else if (formData.password !== formData.confirmPassword) {
      newErrors.confirmPassword = '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç';
    }

    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData(prev => ({
      ...prev,
      [name]: value
    }));
    
    if (errors[name]) {
      setErrors(prev => ({
        ...prev,
        [name]: ''
      }));
    }
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    
    if (!validateForm()) {
      return;
    }

    setIsLoading(true);

    try {
      const response = await fetch('/api/auth/register', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          name: formData.name,
          email: formData.email,
          password: formData.password,
        }),
        credentials: 'include'
      });

      const data = await response.json();

      if (response.ok) {
        setNotification({ 
          message: '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º...', 
          type: 'success' 
        });
        
        setTimeout(() => {
          router.push('/my-vacations');
        }, 1000);
      } else {
        setNotification({ 
          message: data.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏', 
          type: 'error' 
        });
      }
    } catch (error) {
      setNotification({ 
        message: '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.', 
        type: 'error' 
      });
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <>
      <Notification 
        message={notification.message} 
        type={notification.type}
        onClose={() => setNotification({ message: '', type: '' })}
      />

      <div className="max-w-md mx-auto bg-white rounded-2xl shadow-xl p-8">
        <div className="text-center mb-8">
          <h2 className="text-3xl font-bold text-gray-900 mb-2">
            –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç
          </h2>
          <p className="text-gray-600">
            –ù–∞—á–Ω–∏—Ç–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è
          </p>
        </div>
        
        <form onSubmit={handleSubmit} className="space-y-6">
          {/* –ü–æ–ª–µ –∏–º–µ–Ω–∏ */}
          <div>
            <label htmlFor="name" className="block text-sm font-medium text-gray-700 mb-2">
              –ò–º—è
            </label>
            <input
              type="text"
              id="name"
              name="name"
              value={formData.name}
              onChange={handleChange}
              className={`text-gray-900 w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                errors.name ? 'border-red-500' : 'border-gray-300'
              }`}
              placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è"
            />
            {errors.name && (
              <p className="mt-2 text-sm text-red-600">{errors.name}</p>
            )}
          </div>

          {/* –ü–æ–ª–µ email */}
          <div>
            <label htmlFor="email" className="block text-sm font-medium text-gray-700 mb-2">
              Email
            </label>
            <input
              type="email"
              id="email"
              name="email"
              value={formData.email}
              onChange={handleChange}
              className={`text-gray-900 w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                errors.email ? 'border-red-500' : 'border-gray-300'
              }`}
              placeholder="your@email.com"
            />
            {errors.email && (
              <p className="mt-2 text-sm text-red-600">{errors.email}</p>
            )}
          </div>

          {/* –ü–æ–ª–µ –ø–∞—Ä–æ–ª—è */}
          <div>
            <label htmlFor="password" className="block text-sm font-medium text-gray-700 mb-2">
              –ü–∞—Ä–æ–ª—å
            </label>
            <input
              type="password"
              id="password"
              name="password"
              value={formData.password}
              onChange={handleChange}
              className={`text-gray-900 w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                errors.password ? 'border-red-500' : 'border-gray-300'
              }`}
              placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤"
            />
            {errors.password && (
              <p className="mt-2 text-sm text-red-600">{errors.password}</p>
            )}
          </div>

          {/* –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è */}
          <div>
            <label htmlFor="confirmPassword" className="block text-sm font-medium text-gray-700 mb-2">
              –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å
            </label>
            <input
              type="password"
              id="confirmPassword"
              name="confirmPassword"
              value={formData.confirmPassword}
              onChange={handleChange}
              className={`text-gray-900 w-full px-4 py-3 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition duration-200 ${
                errors.confirmPassword ? 'border-red-500' : 'border-gray-300'
              }`}
              placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
            />
            {errors.confirmPassword && (
              <p className="mt-2 text-sm text-red-600">{errors.confirmPassword}</p>
            )}
          </div>

          {/* –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ */}
          <button
            type="submit"
            disabled={isLoading}
            className="w-full bg-gradient-to-r from-emerald-600 to-teal-500 text-white py-4 px-6 rounded-lg text-lg font-semibold hover:from-emerald-700 hover:to-teal-600 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
          >
            {isLoading ? (
              <div className="flex items-center justify-center">
                <div className="w-5 h-5 border-t-2 border-white rounded-full animate-spin mr-2"></div>
                –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è...
              </div>
            ) : (
              '–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç –±–µ—Å–ø–ª–∞—Ç–Ω–æ'
            )}
          </button>

          {/* –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –Ω–∞–≤—Å–µ–≥–¥–∞ */}
          <div className="text-center">
            <div className="inline-flex items-center space-x-2 bg-emerald-50 text-emerald-700 px-4 py-2 rounded-full text-sm">
              <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" />
              </svg>
              <span>–ü–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–æ ‚Ä¢ –ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π</span>
            </div>
          </div>
        </form>

        <div className="mt-8 text-center">
          <p className="text-gray-600">
            –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç?{' '}
            <Link href="/login" className="text-emerald-600 hover:text-emerald-500 font-semibold transition duration-200">
              –í–æ–π–¥–∏—Ç–µ
            </Link>
          </p>
        </div>
      </div>
    </>
  );
}



================================================================================
–§–ê–ô–õ: components/TestNotif.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/TestNotif.js
–†–ê–ó–ú–ï–†: 2072 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// components/NotificationTester.js
'use client';
import { useState } from 'react';

export default function NotificationTester() {
  const [isLoading, setIsLoading] = useState(false);

  const testNotifications = [
    {
      type: 'invitation',
      title: '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –æ—Ç–ø—É—Å–∫',
      message: '–ê–Ω–Ω–∞ –ø—Ä–∏–≥–ª–∞—Å–∏–ª–∞ –≤–∞—Å –≤ –æ—Ç–ø—É—Å–∫ "–û—Ç–¥—ã—Ö –Ω–∞ –ë–∞–ª–∏"',
      buttonText: 'üì® –¢–µ—Å—Ç –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è'
    },
    {
      type: 'activity_update', 
      title: '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤',
      message: '–í –≤–∞—à–µ–º –æ—Ç–ø—É—Å–∫–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
      buttonText: 'üîÑ –¢–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è'
    },
    {
      type: 'memory_comment',
      title: '–ù–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π',
      message: '–ò–≤–∞–Ω –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª –≤–∞—à–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ',
      buttonText: 'üí¨ –¢–µ—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è'
    },
    {
      type: 'info',
      title: '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ',
      message: '–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ',
      buttonText: '‚ÑπÔ∏è –¢–µ—Å—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏'
    }
  ];

  const sendTest = async (type) => {
    setIsLoading(true);
    try {
      const response = await fetch('/api/notifications/test', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ type }),
        credentials: 'include'
      });

      if (response.ok) {
        console.log(`–¢–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "${type}" –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ`);
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞:', error);
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="bg-white rounded-lg shadow p-6">
      <h3 className="text-lg font-semibold mb-4">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</h3>
      <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
        {testNotifications.map((notification) => (
          <button
            key={notification.type}
            onClick={() => sendTest(notification.type)}
            disabled={isLoading}
            className="bg-gray-100 hover:bg-gray-200 text-gray-800 px-4 py-3 rounded-lg transition disabled:opacity-50"
          >
            {notification.buttonText}
          </button>
        ))}
      </div>
    </div>
  );
}



================================================================================
–§–ê–ô–õ: components/VacationCard.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/VacationCard.js
–†–ê–ó–ú–ï–†: 8932 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/VacationCard.js
'use client';

import Link from 'next/link';
import { useState } from 'react';

export default function VacationCard({ vacation }) {
  const [imageError, setImageError] = useState(false);
  
  const calculateDaysLeft = (startDate) => {
    const today = new Date();
    const start = new Date(startDate);
    const diffTime = start - today;
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    return diffDays > 0 ? diffDays : 0;
  };

  const formatDate = (dateString) => {
    return new Date(dateString).toLocaleDateString('ru-RU', {
      day: 'numeric',
      month: 'short',
      year: 'numeric'
    });
  };

  const getStatusInfo = (startDate, endDate) => {
    const today = new Date();
    const start = new Date(startDate);
    const end = new Date(endDate);
    const daysLeft = calculateDaysLeft(startDate);

    if (today < start) {
      return {
        type: 'upcoming',
        text: `–ß–µ—Ä–µ–∑ ${daysLeft} –¥.`,
        color: 'bg-blue-100 text-blue-800'
      };
    } else if (today >= start && today <= end) {
      return {
        type: 'current',
        text: '–°–µ–π—á–∞—Å',
        color: 'bg-green-100 text-green-800'
      };
    } else {
      return {
        type: 'past',
        text: '–ó–∞–≤–µ—Ä—à–µ–Ω',
        color: 'bg-gray-100 text-gray-800'
      };
    }
  };

  const getVacationEmoji = (destination, status) => {
    // –ï—Å–ª–∏ –µ—Å—Ç—å –º–µ—Å—Ç–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è, –ø—ã—Ç–∞–µ–º—Å—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø –ø–æ —Ç–µ–∫—Å—Ç—É
    if (destination) {
      const dest = destination.toLowerCase();
      
      // –ü–ª—è–∂–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
      if (dest.includes('–ø–ª—è–∂') || dest.includes('–º–æ—Ä–µ') || dest.includes('–æ–∫–µ–∞–Ω') || 
          dest.includes('–æ—Å—Ç—Ä–æ–≤') || dest.includes('–º–∞–ª—å–¥–∏–≤') || dest.includes('–±–∞–ª–∏') ||
          dest.includes('—Ç–∞–π–ª–∞–Ω–¥') || dest.includes('–µ–≥–∏–ø–µ—Ç') || dest.includes('—Ç—É—Ä—Ü–∏—è')) {
        return 'üèñÔ∏è';
      }
      
      // –ì–æ—Ä–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
      if (dest.includes('–≥–æ—Ä') || dest.includes('–∞–ª—å–ø') || dest.includes('–ª—ã–∂') || 
          dest.includes('—Å–Ω–µ–≥') || dest.includes('—à–∞–ª–µ')) {
        return 'üèîÔ∏è';
      }
      
      // –ì–æ—Ä–æ–¥—Å–∫–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
      if (dest.includes('–ø–∞—Ä–∏–∂') || dest.includes('—Ä–∏–º') || dest.includes('–±–∞—Ä—Å–µ–ª–æ–Ω') ||
          dest.includes('–ª–æ–Ω–¥–æ–Ω') || dest.includes('–±–µ—Ä–ª–∏–Ω') || dest.includes('–ø—Ä–∞–≥') ||
          dest.includes('–≥–æ—Ä–æ–¥') || dest.includes('—Å—Ç–æ–ª–∏—Ü')) {
        return 'üèôÔ∏è';
      }
      
      // –ü—Ä–∏—Ä–æ–¥–∞ –∏ –∫–µ–º–ø–∏–Ω–≥
      if (dest.includes('–ª–µ—Å') || dest.includes('–æ–∑–µ—Ä') || dest.includes('—Ä–µ–∫–∞') ||
          dest.includes('–∫–µ–º–ø–∏–Ω–≥') || dest.includes('–ø–∞–ª–∞—Ç–∫') || dest.includes('–ø–æ—Ö–æ–¥')) {
        return '‚õ∫';
      }
      
      // –ö—É–ª—å—Ç—É—Ä–∞ –∏ –∏—Å—Ç–æ—Ä–∏—è
      if (dest.includes('–º—É–∑–µ–π') || dest.includes('–∑–∞–º–æ–∫') || dest.includes('—Ö—Ä–∞–º') ||
          dest.includes('–ø–∏—Ä–∞–º–∏–¥') || dest.includes('–∏—Å—Ç–æ—Ä–∏')) {
        return 'üèõÔ∏è';
      }
    }

    // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ –º–µ—Å—Ç—É, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞—Ç—É—Å
    switch (status) {
      case 'upcoming':
        return 'üìÖ';
      case 'current':
        return 'üéâ';
      case 'past':
        return 'üì∏';
      default:
        return 'üå¥'; // –ü–∞–ª—å–º–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    }
  };

  const getCoverBackground = (status) => {
    const gradients = {
      upcoming: 'from-blue-400 to-cyan-500',
      current: 'from-green-400 to-emerald-500',
      past: 'from-purple-400 to-indigo-500'
    };
    
    return gradients[status] || 'from-emerald-400 to-teal-500';
  };

  const statusInfo = getStatusInfo(vacation.startDate, vacation.endDate);
  const vacationEmoji = getVacationEmoji(vacation.destination, statusInfo.type);
  const coverBackground = getCoverBackground(statusInfo.type);

  return (
    <Link 
      href={`/vacations/${vacation.id}`}
      className="group block bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden border border-gray-100 hover:border-emerald-200 transform hover:-translate-y-1"
    >
      {/* –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±–ª–æ–∂–∫–∏ */}
      <div className={`relative h-48 bg-gradient-to-br ${coverBackground} overflow-hidden flex items-center justify-center`}>
        {/* –≠–º–æ–¥–∑–∏ –Ω–∞ –≤—Å—é –∫–∞—Ä—Ç–æ—á–∫—É */}
        <div className="text-6xl opacity-90 transform group-hover:scale-110 transition-transform duration-300">
          {vacationEmoji}
        </div>
        
        {/* –°—Ç–∞—Ç—É—Å –±–∞–¥–∂ */}
        <div className={`absolute top-4 right-4 px-3 py-1 rounded-full text-xs font-medium ${statusInfo.color} backdrop-blur-sm bg-white/20`}>
          {statusInfo.text}
        </div>
        
        {/* –ì—Ä–∞–¥–∏–µ–Ω—Ç overlay */}
        <div className="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300" />
        
        {/* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–≤–µ—Ä—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è */}
        <div className="absolute bottom-4 left-4 right-4 text-white">
          <h3 className="text-xl font-semibold mb-1 line-clamp-1 drop-shadow-lg">
            {vacation.title}
          </h3>
          {vacation.destination && (
            <p className="text-sm opacity-90 line-clamp-1 drop-shadow-lg">
              {vacation.destination}
            </p>
          )}
        </div>
      </div>

      {/* –ö–æ–Ω—Ç–µ–Ω—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ */}
      <div className="p-6">
        {/* –î–∞—Ç—ã */}
        <div className="flex items-center text-gray-500 text-sm mb-4">
          <svg className="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          <span>{formatDate(vacation.startDate)} - {formatDate(vacation.endDate)}</span>
        </div>

        {/* –û–ø–∏—Å–∞–Ω–∏–µ (–µ—Å–ª–∏ –µ—Å—Ç—å) */}
        {vacation.description && (
          <p className="text-gray-600 text-sm mb-4 line-clamp-2">
            {vacation.description}
          </p>
        )}

        {/* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */}
        <div className="flex justify-between items-center text-sm text-gray-500 border-t border-gray-100 pt-4">
          <div className="flex space-x-4">
            <div className="flex items-center space-x-1" title="–£—á–∞—Å—Ç–Ω–∏–∫–∏">
              <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z" />
              </svg>
              <span>{vacation._count?.members || 0}</span>
            </div>
            
            <div className="flex items-center space-x-1" title="–ü–ª–∞–Ω—ã">
              <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
              </svg>
              <span>{vacation._count?.activities || 0}</span>
            </div>
            
            <div className="flex items-center space-x-1" title="–í–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è">
              <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              <span>{vacation._count?.memories || 0}</span>
            </div>
          </div>

          {/* –í–ª–∞–¥–µ–ª–µ—Ü/—É—á–∞—Å—Ç–Ω–∏–∫–∏ */}
          <div className="flex items-center">
            {vacation.members?.slice(0, 3).map((member, index) => (
              <div
                key={member.user.id}
                className={`w-6 h-6 rounded-full bg-gradient-to-r from-emerald-400 to-teal-500 flex items-center justify-center text-white text-xs font-medium border-2 border-white ${
                  index > 0 ? '-ml-2' : ''
                }`}
                title={member.user.name}
              >
                {member.user.avatar ? (
                  <img
                    src={member.user.avatar}
                    alt={member.user.name}
                    className="w-full h-full rounded-full object-cover"
                  />
                ) : (
                  member.user.name.charAt(0).toUpperCase()
                )}
              </div>
            ))}
            {vacation.members?.length > 3 && (
              <div 
                className="w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 text-xs font-medium border-2 border-white -ml-2"
                title={`–ï—â–µ ${vacation.members.length - 3} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤`}
              >
                +{vacation.members.length - 3}
              </div>
            )}
          </div>
        </div>
      </div>
    </Link>
  );
}



================================================================================
–§–ê–ô–õ: components/notifications/BaseNotification.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/notifications/BaseNotification.js
–†–ê–ó–ú–ï–†: 2303 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/notifications/BaseNotification.js
'use client';

import { FaBell, FaEnvelope, FaComments, FaInfoCircle } from 'react-icons/fa';

export default function BaseNotification({ notification, onMarkAsRead, children }) {
  const getTypeStyles = () => {
    switch (notification.type) {
      case 'invitation':
        return {
          bg: 'bg-gray-25 border-gray-200',
          icon: <FaEnvelope className="w-4 h-4 text-gray-600" />,
          text: 'text-gray-900'
        };
      case 'activity_update':
        return {
          bg: 'bg-gray-25 border-gray-200',
          icon: <FaBell className="w-4 h-4 text-gray-600" />,
          text: 'text-gray-900'
        };
      case 'memory_comment':
        return {
          bg: 'bg-gray-25 border-gray-200',
          icon: <FaComments className="w-4 h-4 text-gray-600" />,
          text: 'text-gray-900'
        };
      default:
        return {
          bg: 'bg-gray-25 border-gray-200',
          icon: <FaInfoCircle className="w-4 h-4 text-gray-600" />,
          text: 'text-gray-900'
        };
    }
  };

  const styles = getTypeStyles();

  return (
    <div className={`p-4 rounded-lg border transition-all duration-200 ${styles.bg} ${!notification.isRead ? 'border-l-2 border-l-gray-400' : ''}`}>
      <div className="flex items-start space-x-3">
        <div className={`mt-1 flex-shrink-0 ${notification.isRead ? 'opacity-50' : 'opacity-100'}`}>
          {styles.icon}
        </div>
        
        <div className="flex-1 min-w-0">
          <div className="flex items-start justify-between mb-2">
            <h3 className={`text-sm font-medium ${styles.text}`}>
              {notification.title}
            </h3>
            <span className="text-xs text-gray-500 whitespace-nowrap ml-2">
              {new Date(notification.createdAt).toLocaleDateString('ru-RU')}
            </span>
          </div>
          
          <p className="text-sm text-gray-700 mb-3">
            {notification.message}
          </p>

          {children}

          <p className="text-xs text-gray-500 mt-2">
            {new Date(notification.createdAt).toLocaleTimeString('ru-RU', {
              hour: '2-digit',
              minute: '2-digit'
            })}
          </p>
        </div>
      </div>
    </div>
  );
}



================================================================================
–§–ê–ô–õ: components/notifications/InfoNotification.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/notifications/InfoNotification.js
–†–ê–ó–ú–ï–†: 724 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/notifications/InfoNotification.js
'use client';

import BaseNotification from './BaseNotification';
import { FaCheck } from 'react-icons/fa';

export default function InfoNotification({ notification, onMarkAsRead }) {
  return (
    <BaseNotification notification={notification} onMarkAsRead={onMarkAsRead}>
      {!notification.isRead && (
        <button
          onClick={() => onMarkAsRead(notification.id)}
          className="flex items-center space-x-2 text-sm bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 transition-colors font-normal"
        >
          <FaCheck className="w-3 h-3" />
          <span>–ü—Ä–æ—á–∏—Ç–∞–Ω–æ</span>
        </button>
      )}
    </BaseNotification>
  );
}



================================================================================
–§–ê–ô–õ: components/notifications/InvitationNotification.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/notifications/InvitationNotification.js
–†–ê–ó–ú–ï–†: 4743 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/notifications/InvitationNotification.js
'use client';

import { useState } from 'react';
import BaseNotification from './BaseNotification';
import { useRouter } from 'next/navigation';
import { FaCheck, FaTimes, FaArrowRight, FaSpinner } from 'react-icons/fa';

export default function InvitationNotification({ notification, onMarkAsRead, onUpdate }) {
  const [isLoading, setIsLoading] = useState(false);
  const router = useRouter();

  const handleAccept = async () => {
    if (!notification.data?.invitationId) return;
    
    setIsLoading(true);
    try {
      const response = await fetch(`/api/invitations/${notification.data.invitationId}/respond`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ accept: true }),
        credentials: 'include'
      });

      const data = await response.json();

      if (response.ok) {
        await onMarkAsRead(notification.id);
        if (onUpdate) onUpdate();
        
        if (data.vacationId) {
          console.log('–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ! Vacation ID:', data.vacationId);
        }
      } else {
        alert(data.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏–Ω—è—Ç–∏—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è');
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏–Ω—è—Ç–∏—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è:', error);
      alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏');
    } finally {
      setIsLoading(false);
    }
  };

  const handleDecline = async () => {
    if (!notification.data?.invitationId) return;
    
    setIsLoading(true);
    try {
      const response = await fetch(`/api/invitations/${notification.data.invitationId}/respond`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ accept: false }),
        credentials: 'include'
      });

      if (response.ok) {
        await onMarkAsRead(notification.id);
        if (onUpdate) onUpdate();
      } else {
        const data = await response.json();
        alert(data.message || '–û—à–∏–±–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è');
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è:', error);
      alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏');
    } finally {
      setIsLoading(false);
    }
  };

  const handleGoToVacation = () => {
    if (notification.data?.vacationId) {
      router.push(`/vacations/${notification.data.vacationId}`);
      onMarkAsRead(notification.id);
    }
  };

  const getActions = () => {
    if (notification.data?.status === 'accepted') {
      return (
        <div className="flex space-x-2">
          <div className="flex items-center space-x-2 text-sm text-gray-600 px-3 py-2 border border-gray-300 rounded-md">
            <FaCheck className="w-3 h-3" />
            <span>–ü—Ä–∏–Ω—è—Ç–æ</span>
          </div>
          {notification.data?.vacationId && (
            <button
              onClick={handleGoToVacation}
              className="flex items-center space-x-2 text-sm bg-gray-800 text-white px-4 py-2 rounded-md hover:bg-gray-900 transition-colors font-normal"
            >
              <span>–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ—Ç–ø—É—Å–∫—É</span>
              <FaArrowRight className="w-3 h-3" />
            </button>
          )}
        </div>
      );
    }

    if (notification.data?.status === 'rejected') {
      return (
        <div className="flex items-center space-x-2 text-sm text-gray-600 px-3 py-2 border border-gray-300 rounded-md">
          <FaTimes className="w-3 h-3" />
          <span>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ</span>
        </div>
      );
    }

    return (
      <div className="flex space-x-2">
        <button
          onClick={handleAccept}
          disabled={isLoading}
          className="flex items-center space-x-2 text-sm bg-gray-800 text-white px-4 py-2 rounded-md hover:bg-gray-900 transition-colors font-normal disabled:opacity-50"
        >
          {isLoading ? (
            <FaSpinner className="w-3 h-3 animate-spin" />
          ) : (
            <FaCheck className="w-3 h-3" />
          )}
          <span>{isLoading ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : '–ü—Ä–∏–Ω—è—Ç—å'}</span>
        </button>
        <button
          onClick={handleDecline}
          disabled={isLoading}
          className="flex items-center space-x-2 text-sm bg-white text-gray-700 px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-50 transition-colors font-normal disabled:opacity-50"
        >
          {isLoading ? (
            <FaSpinner className="w-3 h-3 animate-spin" />
          ) : (
            <FaTimes className="w-3 h-3" />
          )}
          <span>{isLoading ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : '–û—Ç–∫–ª–æ–Ω–∏—Ç—å'}</span>
        </button>
      </div>
    );
  };

  return (
    <BaseNotification notification={notification} onMarkAsRead={onMarkAsRead}>
      {getActions()}
    </BaseNotification>
  );
}



================================================================================
–§–ê–ô–õ: components/notifications/NotificationFactory.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/notifications/NotificationFactory.js
–†–ê–ó–ú–ï–†: 711 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/notifications/NotificationFactory.js
'use client';

import InfoNotification from './InfoNotification';
import InvitationNotification from './InvitationNotification';

export default function NotificationFactory({ notification, onMarkAsRead, onUpdate }) {
  switch (notification.type) {
    case 'invitation':
      return (
        <InvitationNotification
          notification={notification}
          onMarkAsRead={onMarkAsRead}
          onUpdate={onUpdate}
        />
      );
    case 'activity_update':
    case 'memory_comment':
    default:
      return (
        <InfoNotification
          notification={notification}
          onMarkAsRead={onMarkAsRead}
        />
      );
  }
}



================================================================================
–§–ê–ô–õ: components/notifications-old/BaseNotification.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/notifications-old/BaseNotification.js
–†–ê–ó–ú–ï–†: 2115 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/notifications/BaseNotification.js
'use client';

export default function BaseNotification({ notification, onMarkAsRead, children }) {
  const getTypeStyles = () => {
    switch (notification.type) {
      case 'invitation':
        return {
          bg: 'bg-blue-50 border-blue-200',
          dot: 'bg-blue-500',
          text: 'text-blue-700'
        };
      case 'activity_update':
        return {
          bg: 'bg-green-50 border-green-200',
          dot: 'bg-green-500',
          text: 'text-green-700'
        };
      case 'memory_comment':
        return {
          bg: 'bg-purple-50 border-purple-200',
          dot: 'bg-purple-500',
          text: 'text-purple-700'
        };
      default:
        return {
          bg: 'bg-gray-50 border-gray-200',
          dot: 'bg-gray-500',
          text: 'text-gray-700'
        };
    }
  };

  const styles = getTypeStyles();

  return (
    <div className={`p-4 rounded-xl border transition-all duration-200 ${styles.bg} ${!notification.isRead ? 'border-l-4' : ''}`}>
      <div className="flex items-start space-x-3">
        <div className={`w-2 h-2 rounded-full mt-2 flex-shrink-0 ${styles.dot} ${notification.isRead ? 'opacity-50' : ''}`} />
        
        <div className="flex-1 min-w-0">
          <div className="flex items-start justify-between mb-2">
            <h3 className={`text-sm font-semibold ${styles.text}`}>
              {notification.title}
            </h3>
            <span className="text-xs text-gray-500 whitespace-nowrap ml-2">
              {new Date(notification.createdAt).toLocaleDateString('ru-RU')}
            </span>
          </div>
          
          <p className="text-sm text-gray-600 mb-3">
            {notification.message}
          </p>

          {/* –î–µ–π—Å—Ç–≤–∏—è –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–∞–∫ children */}
          {children}

          <p className="text-xs text-gray-400 mt-2">
            {new Date(notification.createdAt).toLocaleTimeString('ru-RU', {
              hour: '2-digit',
              minute: '2-digit'
            })}
          </p>
        </div>
      </div>
    </div>
  );
}



================================================================================
–§–ê–ô–õ: components/notifications-old/InfoNotification.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/notifications-old/InfoNotification.js
–†–ê–ó–ú–ï–†: 599 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/notifications/InfoNotification.js
'use client';

import BaseNotification from './BaseNotification';

export default function InfoNotification({ notification, onMarkAsRead }) {
  return (
    <BaseNotification notification={notification} onMarkAsRead={onMarkAsRead}>
      {!notification.isRead && (
        <button
          onClick={() => onMarkAsRead(notification.id)}
          className="text-sm bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors font-medium"
        >
          –ü—Ä–æ—á–∏—Ç–∞–Ω–æ
        </button>
      )}
    </BaseNotification>
  );
}



================================================================================
–§–ê–ô–õ: components/notifications-old/InvitationNotification.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/notifications-old/InvitationNotification.js
–†–ê–ó–ú–ï–†: 4103 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/notifications/InvitationNotification.js
'use client';

import { useState } from 'react';
import BaseNotification from './BaseNotification';
import { useRouter } from 'next/navigation';

export default function InvitationNotification({ notification, onMarkAsRead, onUpdate }) {
  const [isLoading, setIsLoading] = useState(false);
  const router = useRouter();

  const handleAccept = async () => {
    if (!notification.data?.invitationId) return;
    
    setIsLoading(true);
    try {
      const response = await fetch(`/api/invitations/${notification.data.invitationId}/respond`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ accept: true }),
        credentials: 'include'
      });

      const data = await response.json();

      if (response.ok) {
        await onMarkAsRead(notification.id);
        if (onUpdate) onUpdate();
        
        // –ï—Å–ª–∏ –µ—Å—Ç—å vacationId, –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –ø–µ—Ä–µ–π—Ç–∏
        if (data.vacationId) {
          // –ú–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–π—Ç–∏
          console.log('–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ! Vacation ID:', data.vacationId);
        }
      } else {
        alert(data.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏–Ω—è—Ç–∏—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è');
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏–Ω—è—Ç–∏—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è:', error);
      alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏');
    } finally {
      setIsLoading(false);
    }
  };

  const handleDecline = async () => {
    if (!notification.data?.invitationId) return;
    
    setIsLoading(true);
    try {
      const response = await fetch(`/api/invitations/${notification.data.invitationId}/respond`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ accept: false }),
        credentials: 'include'
      });

      if (response.ok) {
        await onMarkAsRead(notification.id);
        if (onUpdate) onUpdate();
      } else {
        const data = await response.json();
        alert(data.message || '–û—à–∏–±–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è');
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è:', error);
      alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏');
    } finally {
      setIsLoading(false);
    }
  };

  const handleGoToVacation = () => {
    if (notification.data?.vacationId) {
      router.push(`/vacations/${notification.data.vacationId}`);
      onMarkAsRead(notification.id);
    }
  };

  const getActions = () => {
    // –ï—Å–ª–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ
    if (notification.data?.status === 'accepted') {
      return (
        <div className="flex space-x-2">
          <span className="text-sm text-green-600 px-3 py-2">–ü—Ä–∏–Ω—è—Ç–æ</span>
          {notification.data?.vacationId && (
            <button
              onClick={handleGoToVacation}
              className="text-sm bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors font-medium"
            >
              –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ—Ç–ø—É—Å–∫—É
            </button>
          )}
        </div>
      );
    }

    if (notification.data?.status === 'rejected') {
      return (
        <span className="text-sm text-red-600 px-3 py-2">
          –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ
        </span>
      );
    }

    // –ï—Å–ª–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –µ—â–µ –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ
    return (
      <div className="flex space-x-2">
        <button
          onClick={handleAccept}
          disabled={isLoading}
          className="text-sm bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors font-medium disabled:opacity-50"
        >
          {isLoading ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : '–ü—Ä–∏–Ω—è—Ç—å'}
        </button>
        <button
          onClick={handleDecline}
          disabled={isLoading}
          className="text-sm bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors font-medium disabled:opacity-50"
        >
          {isLoading ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : '–û—Ç–∫–ª–æ–Ω–∏—Ç—å'}
        </button>
      </div>
    );
  };

  return (
    <BaseNotification notification={notification} onMarkAsRead={onMarkAsRead}>
      {getActions()}
    </BaseNotification>
  );
}



================================================================================
–§–ê–ô–õ: components/notifications-old/NotificationFactory.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/notifications-old/NotificationFactory.js
–†–ê–ó–ú–ï–†: 711 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/notifications/NotificationFactory.js
'use client';

import InfoNotification from './InfoNotification';
import InvitationNotification from './InvitationNotification';

export default function NotificationFactory({ notification, onMarkAsRead, onUpdate }) {
  switch (notification.type) {
    case 'invitation':
      return (
        <InvitationNotification
          notification={notification}
          onMarkAsRead={onMarkAsRead}
          onUpdate={onUpdate}
        />
      );
    case 'activity_update':
    case 'memory_comment':
    default:
      return (
        <InfoNotification
          notification={notification}
          onMarkAsRead={onMarkAsRead}
        />
      );
  }
}



================================================================================
–§–ê–ô–õ: components/vacation/CaptureMoment.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/vacation/CaptureMoment.js
–†–ê–ó–ú–ï–†: 1225 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/vacation/CaptureMoment.js
'use client';

import { useState } from 'react';

export default function CaptureMoment({ vacation }) {
  const [isOpen, setIsOpen] = useState(false);

  const isVacationActive = () => {
    const now = new Date();
    const start = new Date(vacation.startDate);
    const end = new Date(vacation.endDate);
    return now >= start && now <= end;
  };

  if (!isVacationActive()) {
    return null;
  }

  return (
    <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 text-center">
      <div className="w-14 h-14 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 border border-gray-300">
        <span className="text-2xl">üì∏</span>
      </div>
      <h3 className="text-lg font-semibold text-gray-900 mb-2">
        –ó–∞–ø–µ—á–∞—Ç–ª–µ–π—Ç–µ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å
      </h3>
      <p className="text-gray-600 mb-4 text-sm">
        –î–æ–±–∞–≤—å—Ç–µ –¥–æ 3 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–º–µ–Ω—Ç—ã —ç—Ç–æ–≥–æ –¥–Ω—è
      </p>
      <button
        onClick={() => setIsOpen(true)}
        className="bg-gray-700 text-white px-6 py-2 rounded-lg hover:bg-gray-800 transition duration-200 text-sm font-medium"
      >
        –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ –¥–Ω—è
      </button>
    </div>
  );
}



================================================================================
–§–ê–ô–õ: components/vacation/MemoriesSection.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/vacation/MemoriesSection.js
–†–ê–ó–ú–ï–†: 2323 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/vacation/MemoriesSection.js
'use client';

import { useState, useEffect } from 'react';

export default function MemoriesSection({ vacation, preview = false }) {
  const [memories, setMemories] = useState([]);
  const [isLoading, setIsLoading] = useState(false);

  useEffect(() => {
    // –í—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–≥–ª—É—à–∫–∞
    setMemories([]);
    setIsLoading(false);
  }, [vacation.id]);

  const displayedMemories = preview ? memories.slice(0, 6) : memories;

  if (isLoading) {
    return (
      <div className="bg-white rounded-2xl shadow-lg p-6">
        <div className="animate-pulse">
          <div className="h-6 bg-gray-200 rounded w-1/4 mb-4"></div>
          <div className="grid grid-cols-3 gap-4">
            {[...Array(6)].map((_, i) => (
              <div key={i} className="aspect-square bg-gray-200 rounded-lg"></div>
            ))}
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="bg-white rounded-2xl shadow-lg p-6">
      <div className="flex justify-between items-center mb-6">
        <h2 className="text-2xl font-bold text-gray-900">–í–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è</h2>
        {preview && memories.length > 6 && (
          <button className="text-emerald-600 hover:text-emerald-500 font-medium">
            –í—Å–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è ‚Üí
          </button>
        )}
      </div>

      {memories.length === 0 ? (
        <div className="text-center py-12">
          <div className="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <span className="text-3xl">üì∏</span>
          </div>
          <h3 className="text-lg font-semibold text-gray-900 mb-2">
            –ü–æ–∫–∞ –Ω–µ—Ç –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π
          </h3>
          <p className="text-gray-600 mb-6">
            –ù–∞—á–Ω–∏—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–º–µ–Ω—Ç—ã –≤–∞—à–µ–≥–æ –æ—Ç–ø—É—Å–∫–∞
          </p>
        </div>
      ) : (
        <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
          {displayedMemories.map((memory, index) => (
            <div
              key={index}
              className="aspect-square rounded-lg overflow-hidden group cursor-pointer relative bg-gray-100 flex items-center justify-center"
            >
              <span className="text-2xl">üì∑</span>
            </div>
          ))}
        </div>
      )}
    </div>
  );
}



================================================================================
–§–ê–ô–õ: components/vacation/PlanSection.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/vacation/PlanSection.js
–†–ê–ó–ú–ï–†: 18988 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/vacation/PlansSection.js
'use client';

import { useState, useEffect } from 'react';

export default function PlansSection({ vacation, preview = false }) {
  const [plans, setPlans] = useState([]);
  const [isLoading, setIsLoading] = useState(true);
  const [view, setView] = useState('list');
  const [showAddForm, setShowAddForm] = useState(false);
  const [isSubmitting, setIsSubmitting] = useState(false);

  // –§–æ—Ä–º–∞ –¥–ª—è –Ω–æ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
  const [newActivity, setNewActivity] = useState({
    title: '',
    description: '',
    date: '',
    startTime: '',
    endTime: '',
    type: 'activity',
    location: ''
  });

  useEffect(() => {
    fetchPlans();
  }, [vacation.id]);

  const fetchPlans = async () => {
    try {
      const response = await fetch(`/api/vacations/${vacation.id}/activities`, {
        credentials: 'include'
      });
      
      if (response.ok) {
        const data = await response.json();
        setPlans(data);
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–ª–∞–Ω–æ–≤:', error);
    } finally {
      setIsLoading(false);
    }
  };

  const handleAddActivity = async (e) => {
    e.preventDefault();
    setIsSubmitting(true);

    try {
      // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è
      const activityDate = new Date(newActivity.date);
      if (newActivity.startTime) {
        const [hours, minutes] = newActivity.startTime.split(':');
        activityDate.setHours(parseInt(hours), parseInt(minutes));
      }

      const response = await fetch('/api/activities', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          title: newActivity.title,
          description: newActivity.description,
          date: activityDate.toISOString(),
          type: newActivity.type,
          vacationId: vacation.id,
          startTime: newActivity.startTime || null,
          endTime: newActivity.endTime || null
        }),
        credentials: 'include'
      });

      const data = await response.json();

      if (response.ok) {
        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —Å–ø–∏—Å–æ–∫
        setPlans(prev => [data, ...prev]);
        
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
        setNewActivity({
          title: '',
          description: '',
          date: '',
          startTime: '',
          endTime: '',
          type: 'activity',
          location: ''
        });
        
        setShowAddForm(false);
      } else {
        alert(data.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏');
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:', error);
      alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏');
    } finally {
      setIsSubmitting(false);
    }
  };

  const handleInputChange = (e) => {
    const { name, value } = e.target;
    setNewActivity(prev => ({
      ...prev,
      [name]: value
    }));
  };

  const getUpcomingPlans = () => {
    const now = new Date();
    return plans
      .filter(plan => new Date(plan.date) >= now)
      .sort((a, b) => new Date(a.date) - new Date(b.date))
      .slice(0, preview ? 3 : 100);
  };

  const formatDate = (dateString) => {
    const date = new Date(dateString);
    return date.toLocaleDateString('ru-RU', {
      weekday: 'long',
      day: 'numeric',
      month: 'long',
      hour: '2-digit',
      minute: '2-digit'
    });
  };

  const formatTime = (dateString) => {
    const date = new Date(dateString);
    return date.toLocaleTimeString('ru-RU', {
      hour: '2-digit',
      minute: '2-digit'
    });
  };

  const getPlanEmoji = (type) => {
    const emojis = {
      flight: '‚úàÔ∏è',
      hotel: 'üè®',
      restaurant: 'üçΩÔ∏è',
      attraction: 'üèõÔ∏è',
      transportation: 'üöó',
      event: 'üé™',
      activity: 'üéØ',
      shopping: 'üõçÔ∏è',
      beach: 'üèñÔ∏è',
      hiking: 'ü•æ',
      museum: 'üèõÔ∏è',
      concert: 'üéµ',
      sports: '‚öΩ'
    };
    return emojis[type] || 'üìÖ';
  };

  const activityTypes = [
    { value: 'activity', label: 'üéØ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å', emoji: 'üéØ' },
    { value: 'flight', label: '‚úàÔ∏è –ü–µ—Ä–µ–ª–µ—Ç', emoji: '‚úàÔ∏è' },
    { value: 'hotel', label: 'üè® –û—Ç–µ–ª—å', emoji: 'üè®' },
    { value: 'restaurant', label: 'üçΩÔ∏è –†–µ—Å—Ç–æ—Ä–∞–Ω', emoji: 'üçΩÔ∏è' },
    { value: 'attraction', label: 'üèõÔ∏è –î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å', emoji: 'üèõÔ∏è' },
    { value: 'transportation', label: 'üöó –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç', emoji: 'üöó' },
    { value: 'event', label: 'üé™ –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ', emoji: 'üé™' },
    { value: 'shopping', label: 'üõçÔ∏è –®–æ–ø–ø–∏–Ω–≥', emoji: 'üõçÔ∏è' },
    { value: 'beach', label: 'üèñÔ∏è –ü–ª—è–∂', emoji: 'üèñÔ∏è' },
    { value: 'hiking', label: 'ü•æ –ü–æ—Ö–æ–¥', emoji: 'ü•æ' },
    { value: 'museum', label: 'üèõÔ∏è –ú—É–∑–µ–π', emoji: 'üèõÔ∏è' },
    { value: 'concert', label: 'üéµ –ö–æ–Ω—Ü–µ—Ä—Ç', emoji: 'üéµ' },
    { value: 'sports', label: '‚öΩ –°–ø–æ—Ä—Ç', emoji: '‚öΩ' }
  ];

  const upcomingPlans = getUpcomingPlans();
  const nearestPlan = upcomingPlans[0];

  if (isLoading) {
    return (
      <div className="bg-white rounded-2xl shadow-lg p-6">
        <div className="animate-pulse">
          <div className="h-8 bg-gray-200 rounded w-1/4 mb-6"></div>
          <div className="space-y-4">
            {[...Array(3)].map((_, i) => (
              <div key={i} className="h-20 bg-gray-200 rounded-xl"></div>
            ))}
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="bg-white rounded-2xl shadow-lg p-6">
      <div className="flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6 gap-4">
        <h2 className="text-2xl font-bold text-gray-900">–ü–ª–∞–Ω—ã –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</h2>
        
        {!preview && (
          <div className="flex items-center space-x-4">
            {/* –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∞ */}
            <div className="flex bg-gray-100 rounded-lg p-1">
              <button
                onClick={() => setView('list')}
                className={`px-4 py-2 rounded-md text-sm font-medium transition-colors ${
                  view === 'list' 
                    ? 'bg-white text-gray-900 shadow-sm' 
                    : 'text-gray-600 hover:text-gray-900'
                }`}
              >
                üìã –°–ø–∏—Å–æ–∫
              </button>
              <button
                onClick={() => setView('calendar')}
                className={`px-4 py-2 rounded-md text-sm font-medium transition-colors ${
                  view === 'calendar' 
                    ? 'bg-white text-gray-900 shadow-sm' 
                    : 'text-gray-600 hover:text-gray-900'
                }`}
              >
                üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å
              </button>
            </div>

            <button 
              onClick={() => setShowAddForm(true)}
              className="bg-emerald-500 text-white px-4 py-2 rounded-lg hover:bg-emerald-600 transition duration-200 font-semibold flex items-center space-x-2"
            >
              <span>+</span>
              <span>–î–æ–±–∞–≤–∏—Ç—å –ø–ª–∞–Ω</span>
            </button>
          </div>
        )}
      </div>

      {/* –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ */}
      {showAddForm && (
        <div className="bg-gray-50 rounded-2xl p-6 mb-6 border-2 border-dashed border-gray-300">
          <div className="flex justify-between items-center mb-4">
            <h3 className="text-lg font-semibold text-gray-900">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h3>
            <button
              onClick={() => setShowAddForm(false)}
              className="text-gray-500 hover:text-gray-700"
            >
              ‚úï
            </button>
          </div>

          <form onSubmit={handleAddActivity} className="space-y-4">
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              {/* –ù–∞–∑–≤–∞–Ω–∏–µ */}
              <div className="md:col-span-2">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  –ù–∞–∑–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ *
                </label>
                <input
                  type="text"
                  name="title"
                  value={newActivity.title}
                  onChange={handleInputChange}
                  required
                  className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"
                  placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–æ—Å–µ—â–µ–Ω–∏–µ –≠—Ä–º–∏—Ç–∞–∂–∞"
                />
              </div>

              {/* –¢–∏–ø –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  –¢–∏–ø –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ *
                </label>
                <select
                  name="type"
                  value={newActivity.type}
                  onChange={handleInputChange}
                  required
                  className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"
                >
                  {activityTypes.map(type => (
                    <option key={type.value} value={type.value}>
                      {type.label}
                    </option>
                  ))}
                </select>
              </div>

              {/* –î–∞—Ç–∞ */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  –î–∞—Ç–∞ *
                </label>
                <input
                  type="date"
                  name="date"
                  value={newActivity.date}
                  onChange={handleInputChange}
                  required
                  className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"
                />
              </div>

              {/* –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞
                </label>
                <input
                  type="time"
                  name="startTime"
                  value={newActivity.startTime}
                  onChange={handleInputChange}
                  className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"
                />
              </div>

              {/* –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  –í—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è
                </label>
                <input
                  type="time"
                  name="endTime"
                  value={newActivity.endTime}
                  onChange={handleInputChange}
                  className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"
                />
              </div>

              {/* –û–ø–∏—Å–∞–Ω–∏–µ */}
              <div className="md:col-span-2">
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  –û–ø–∏—Å–∞–Ω–∏–µ
                </label>
                <textarea
                  name="description"
                  value={newActivity.description}
                  onChange={handleInputChange}
                  rows={3}
                  className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"
                  placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏..."
                />
              </div>
            </div>

            {/* –ö–Ω–æ–ø–∫–∏ */}
            <div className="flex justify-end space-x-3 pt-4">
              <button
                type="button"
                onClick={() => setShowAddForm(false)}
                className="px-6 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition duration-200"
              >
                –û—Ç–º–µ–Ω–∞
              </button>
              <button
                type="submit"
                disabled={isSubmitting}
                className="px-6 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2"
              >
                {isSubmitting ? (
                  <>
                    <div className="w-4 h-4 border-t-2 border-white rounded-full animate-spin"></div>
                    <span>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ...</span>
                  </>
                ) : (
                  <span>–î–æ–±–∞–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</span>
                )}
              </button>
            </div>
          </form>
        </div>
      )}

      {/* –ë–ª–∏–∂–∞–π—à–∏–π –ø–ª–∞–Ω (—Ç–æ–ª—å–∫–æ –≤ –ø—Ä–µ–≤—å—é) */}
      {preview && nearestPlan && (
        <div className="bg-gradient-to-r from-blue-50 to-cyan-50 border-2 border-blue-200 rounded-2xl p-6 mb-6">
          <div className="flex items-center justify-between">
            <div className="flex-1">
              <div className="flex items-center space-x-3 mb-2">
                <div className="text-2xl">{getPlanEmoji(nearestPlan.type)}</div>
                <div>
                  <h3 className="text-xl font-bold text-gray-900">–ë–ª–∏–∂–∞–π—à–µ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ</h3>
                  <p className="text-blue-600 font-semibold">–°–ª–µ–¥—É—é—â–µ–µ –≤ –ø–ª–∞–Ω–µ</p>
                </div>
              </div>
              <h4 className="text-lg font-semibold text-gray-900 mb-1">{nearestPlan.title}</h4>
              <p className="text-gray-600">{nearestPlan.description}</p>
              <div className="flex items-center text-sm text-gray-500 mt-2">
                <svg className="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                {formatDate(nearestPlan.date)}
              </div>
            </div>
            <button className="bg-blue-500 text-white px-6 py-3 rounded-xl hover:bg-blue-600 transition duration-200 font-semibold whitespace-nowrap">
              –í—Å–µ –ø–ª–∞–Ω—ã ‚Üí
            </button>
          </div>
        </div>
      )}

      {plans.length === 0 ? (
        <div className="text-center py-12">
          <div className="w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6">
            <span className="text-3xl">üìÖ</span>
          </div>
          <h3 className="text-xl font-semibold text-gray-900 mb-3">–ü–ª–∞–Ω–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3>
          <p className="text-gray-600 mb-6 max-w-md mx-auto">
            –î–æ–±–∞–≤—å—Ç–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, —ç–∫—Å–∫—É—Ä—Å–∏–∏ –∏ –¥—Ä—É–≥–∏–µ –ø–ª–∞–Ω—ã, —á—Ç–æ–±—ã –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–±—ã—Ç—å –≤–æ –≤—Ä–µ–º—è –æ—Ç–ø—É—Å–∫–∞
          </p>
          <button 
            onClick={() => setShowAddForm(true)}
            className="bg-emerald-500 text-white px-8 py-3 rounded-xl hover:bg-emerald-600 transition duration-200 font-semibold shadow-lg"
          >
            + –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π –ø–ª–∞–Ω
          </button>
        </div>
      ) : view === 'list' ? (
        <div className="space-y-4">
          {(preview ? upcomingPlans : plans).map((plan) => (
            <div
              key={plan.id}
              className="border-2 border-gray-100 rounded-2xl p-5 hover:border-emerald-200 hover:shadow-md transition-all duration-200 group"
            >
              <div className="flex items-start justify-between">
                <div className="flex-1">
                  <div className="flex items-center space-x-3 mb-2">
                    <div className="text-2xl">{getPlanEmoji(plan.type)}</div>
                    <div>
                      <h3 className="text-lg font-semibold text-gray-900 group-hover:text-emerald-600 transition-colors">
                        {plan.title}
                      </h3>
                      <div className="flex items-center text-sm text-gray-500">
                        <svg className="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        {formatDate(plan.date)}
                        {plan.startTime && (
                          <span className="ml-2">
                            –≤ {formatTime(plan.date)}
                          </span>
                        )}
                      </div>
                    </div>
                  </div>
                  
                  {plan.description && (
                    <p className="text-gray-600 mb-3">{plan.description}</p>
                  )}
                  
                  <div className="flex flex-wrap gap-2">
                    {plan.location && (
                      <span className="inline-flex items-center px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm">
                        üìç {plan.location.name || plan.location}
                      </span>
                    )}
                    <span className="inline-flex items-center px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm">
                      {activityTypes.find(t => t.value === plan.type)?.label || plan.type}
                    </span>
                    {plan.author && (
                      <span className="inline-flex items-center px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm">
                        üë§ {plan.author.name}
                      </span>
                    )}
                    {plan.participants && plan.participants.length > 0 && (
                      <span className="inline-flex items-center px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm">
                        üë• {plan.participants.length}
                      </span>
                    )}
                  </div>
                </div>
                
                <div className="flex flex-col items-end space-y-2 ml-4">
                  <div className="w-12 h-12 bg-gradient-to-br from-blue-500 to-cyan-400 rounded-xl flex items-center justify-center text-white font-bold text-lg shadow-lg">
                    {new Date(plan.date).getDate()}
                  </div>
                  <div className="text-xs text-gray-500 text-center">
                    {new Date(plan.date).toLocaleDateString('ru-RU', { month: 'short' })}
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>
      ) : (
        /* Calendar View */
        <div className="bg-gray-50 rounded-2xl p-6">
          <p className="text-center text-gray-500">–í–∏–¥ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–∑–∂–µ</p>
        </div>
      )}

      {preview && upcomingPlans.length > 3 && (
        <div className="text-center mt-8">
          <button className="bg-gradient-to-r from-emerald-500 to-teal-400 text-white px-8 py-3 rounded-xl hover:from-emerald-600 hover:to-teal-500 transition duration-200 font-semibold shadow-lg">
            –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ {plans.length} –ø–ª–∞–Ω–æ–≤ ‚Üí
          </button>
        </div>
      )}
    </div>
  );
}



================================================================================
–§–ê–ô–õ: components/vacation/VacationManagement.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/vacation/VacationManagement.js
–†–ê–ó–ú–ï–†: 5122 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/vacation/VacationManagement.js
'use client';

import { useState } from 'react';

export default function VacationManagement({ vacation, onUpdate }) {
  const [inviteEmail, setInviteEmail] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [message, setMessage] = useState('');

  const handleInvite = async (e) => {
    e.preventDefault();
    if (!inviteEmail.trim()) return;
    
    setIsLoading(true);
    setMessage('');

    try {
      const response = await fetch(`/api/vacations/${vacation.id}/invite`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email: inviteEmail }),
        credentials: 'include'
      });

      const data = await response.json();

      if (response.ok) {
        setMessage('‚úÖ –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!');
        setInviteEmail('');
        onUpdate?.(); // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—É—Å–∫–∞
      } else {
        setMessage(`‚ùå ${data.message}`);
      }
    } catch (error) {
      setMessage('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏');
    } finally {
      setIsLoading(false);
    }
  };

  const isOwner = vacation.userId === vacation.user?.id;

  if (!isOwner) {
    return null;
  }

  return (
    <div className="space-y-6">
      {/* –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ */}
      <div className="bg-white rounded-2xl shadow-lg p-6">
        <h3 className="text-lg font-semibold mb-4">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</h3>
        
        {message && (
          <div className={`p-3 rounded-lg mb-4 ${
            message.includes('‚úÖ') ? 'bg-green-50 text-green-800 border border-green-200' : 'bg-red-50 text-red-800 border border-red-200'
          }`}>
            {message}
          </div>
        )}

        <form onSubmit={handleInvite} className="flex flex-col sm:flex-row gap-3">
          <input
            type="email"
            value={inviteEmail}
            onChange={(e) => setInviteEmail(e.target.value)}
            placeholder="Email —É—á–∞—Å—Ç–Ω–∏–∫–∞"
            className="flex-1 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"
            required
            disabled={isLoading}
          />
          <button
            type="submit"
            disabled={isLoading}
            className="bg-emerald-500 text-white px-6 py-2 rounded-lg hover:bg-emerald-600 transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap"
          >
            {isLoading ? '–û—Ç–ø—Ä–∞–≤–∫–∞...' : '–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å'}
          </button>
        </form>
        
        <p className="text-sm text-gray-500 mt-2">
          –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–∏
        </p>
      </div>

      {/* –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ */}
      <div className="bg-white rounded-2xl shadow-lg p-6">
        <h3 className="text-lg font-semibold mb-4">
          –£—á–∞—Å—Ç–Ω–∏–∫–∏ ({vacation.members?.length || 0})
        </h3>
        
        <div className="space-y-3">
          {vacation.members?.map((member) => (
            <div
              key={member.id}
              className="flex items-center justify-between p-3 border border-gray-200 rounded-lg"
            >
              <div className="flex items-center space-x-3">
                <div className="w-10 h-10 bg-gradient-to-r from-emerald-400 to-teal-500 rounded-full flex items-center justify-center text-white font-medium">
                  {member.user.avatar ? (
                    <img
                      src={member.user.avatar}
                      alt={member.user.name}
                      className="w-full h-full rounded-full object-cover"
                    />
                  ) : (
                    member.user.name.charAt(0).toUpperCase()
                  )}
                </div>
                <div>
                  <div className="font-medium text-gray-900">
                    {member.user.name}
                    {member.role === 'owner' && (
                      <span className="ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full">
                        –í–ª–∞–¥–µ–ª–µ—Ü
                      </span>
                    )}
                  </div>
                  <div className="text-sm text-gray-500">
                    {member.user.email}
                  </div>
                </div>
              </div>

              <div className="text-sm">
                {member.status === 'pending' ? (
                  <span className="text-orange-600 bg-orange-50 px-2 py-1 rounded">–û–∂–∏–¥–∞–µ—Ç –ø—Ä–∏–Ω—è—Ç–∏—è</span>
                ) : member.status === 'accepted' ? (
                  <span className="text-green-600 bg-green-50 px-2 py-1 rounded">–£—á–∞—Å—Ç–Ω–∏–∫</span>
                ) : (
                  <span className="text-red-600 bg-red-50 px-2 py-1 rounded">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</span>
                )}
              </div>
            </div>
          ))}
          
          {(!vacation.members || vacation.members.length === 0) && (
            <div className="text-center py-8 text-gray-500">
              –ü–æ–∫–∞ –Ω–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
            </div>
          )}
        </div>
      </div>
    </div>
  );
}



================================================================================
–§–ê–ô–õ: components/vacation/VacationTimer.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/components/vacation/VacationTimer.js
–†–ê–ó–ú–ï–†: 6075 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/components/vacation/VacationTimer.js
'use client';

import { useState, useEffect } from 'react';

export default function VacationTimer({ vacation }) {
  const [timeLeft, setTimeLeft] = useState({
    status: 'upcoming',
    days: 0
  });

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å–∫–ª–æ–Ω–µ–Ω–∏—è —Å–ª–æ–≤–∞ "–¥–µ–Ω—å"
  const getDaysText = (days) => {
    const lastDigit = days % 10;
    const lastTwoDigits = days % 100;
    
    if (lastTwoDigits >= 11 && lastTwoDigits <= 14) {
      return '–¥–Ω–µ–π';
    }
    
    if (lastDigit === 1) {
      return '–¥–µ–Ω—å';
    }
    
    if (lastDigit >= 2 && lastDigit <= 4) {
      return '–¥–Ω—è';
    }
    
    return '–¥–Ω–µ–π';
  };

  useEffect(() => {
    const calculateTimeLeft = () => {
      const now = new Date();
      const startDate = new Date(vacation.startDate);
      const endDate = new Date(vacation.endDate);
      
      if (now < startDate) {
        const diff = startDate - now;
        return {
          status: 'upcoming',
          days: Math.floor(diff / (1000 * 60 * 60 * 24))
        };
      } else if (now <= endDate) {
        const diff = endDate - now;
        return {
          status: 'current',
          days: Math.floor(diff / (1000 * 60 * 60 * 24))
        };
      } else {
        return {
          status: 'past',
          days: 0
        };
      }
    };

    setTimeLeft(calculateTimeLeft());
    
    const timer = setInterval(() => {
      setTimeLeft(calculateTimeLeft());
    }, 60000);

    return () => clearInterval(timer);
  }, [vacation]);

  const getStatusConfig = () => {
    switch (timeLeft.status) {
      case 'upcoming':
        return {
          text: '–î–û –ù–ê–ß–ê–õ–ê –û–¢–ü–£–°–ö–ê',
          bgGradient: 'from-blue-50/90 to-sky-50/70',
          borderColor: 'border-blue-200/30',
          textColor: 'text-blue-700',
          emoji: 'üõ©Ô∏è',
          // –ú–Ø–ì–ö–ò–ô –°–ò–ù–ò–ô –†–ê–î–ò–ê–õ–¨–ù–´–ô –ì–†–ê–î–ò–ï–ù–¢
          radialGradient: 'radial-gradient(circle at center, #93c5fd 0%, #60a5fa 40%, #3b82f6 80%)',
          daysText: 'text-white'
        };
      case 'current':
        return {
          text: '–î–û –ö–û–ù–¶–ê –û–¢–ü–£–°–ö–ê',
          bgGradient: 'from-emerald-50/90 to-teal-50/70',
          borderColor: 'border-emerald-200/30',
          textColor: 'text-emerald-700',
          emoji: 'üéâ',
          radialGradient: 'radial-gradient(circle at center, #86efac 0%, #4ade80 40%, #16a34a 80%)',
          daysText: 'text-white'
        };
      case 'past':
        return {
          text: '–û–¢–ü–£–°–ö –ó–ê–í–ï–†–®–ï–ù',
          bgGradient: 'from-purple-50/90 to-pink-50/70',
          borderColor: 'border-purple-200/30',
          textColor: 'text-purple-700',
          emoji: 'üèÜ',
          radialGradient: 'radial-gradient(circle at center, #d8b4fe 0%, #c084fc 40%, #a855f7 80%)',
          daysText: 'text-white'
        };
      default:
        return {
          text: '',
          bgGradient: 'from-gray-50/90 to-gray-100/70',
          borderColor: 'border-gray-200/30',
          textColor: 'text-gray-700',
          emoji: 'üìÖ',
          radialGradient: 'radial-gradient(circle at center, #d1d5db 0%, #9ca3af 40%, #6b7280 80%)',
          daysText: 'text-white'
        };
    }
  };

  const config = getStatusConfig();
  const daysText = getDaysText(timeLeft.days);

  if (timeLeft.status === 'past') {
    return (
      <div className="text-center">
        <div className={`bg-gradient-to-br ${config.bgGradient} backdrop-blur-sm ${config.textColor} rounded-2xl p-8 max-w-md mx-auto shadow-lg border ${config.borderColor}`}>
          <div className="text-5xl mb-4">{config.emoji}</div>
          <h2 className="text-2xl font-bold mb-2">{config.text}</h2>
          <p className="text-lg opacity-80 mb-4">–ù–∞–¥–µ–µ–º—Å—è, –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ!</p>
          {vacation.destination && (
            <div className="bg-white/30 rounded-xl py-3 px-4 border border-white/20 backdrop-blur-sm">
              <span className="text-sm font-medium">üìç {vacation.destination}</span>
            </div>
          )}
        </div>
      </div>
    );
  }

  return (
    <div className="text-center">
      <div className={`bg-gradient-to-br ${config.bgGradient} backdrop-blur-sm ${config.textColor} rounded-2xl p-8 max-w-sm mx-auto shadow-lg border ${config.borderColor}`}>
        
        {/* –°—Ç–∞—Ç—É—Å –∏ —ç–º–æ–¥–∑–∏ */}
        <div className="mb-8">
          <div className="text-4xl mb-3 opacity-90">{config.emoji}</div>
          <h2 className="text-lg font-semibold opacity-90">{config.text}</h2>
        </div>

        {/* –ö–í–ê–î–†–ê–¢ –° –ú–Ø–ì–ö–ò–ú –°–ò–ù–ò–ú –ì–†–ê–î–ò–ï–ù–¢–û–ú */}
        <div className="mb-6 flex justify-center">
          <div 
            className={`${config.daysText} rounded-2xl p-8 border border-white/40 shadow-2xl backdrop-blur-sm w-52 h-52 flex flex-col items-center justify-center transform hover:scale-105 transition-transform duration-300 relative overflow-hidden`}
            style={{ background: config.radialGradient }}
          >
            {/* –ú—è–≥–∫–∏–π –æ–≤–µ—Ä–ª–µ–π –¥–ª—è –µ—â–µ –±–æ–ª–µ–µ –Ω–µ–∂–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ */}
            <div className="absolute inset-0 bg-white/5 rounded-2xl"></div>
            
            {/* –ö–æ–Ω—Ç–µ–Ω—Ç */}
            <div className="relative z-10">
              <div className="text-6xl font-bold mb-2 leading-none drop-shadow-lg">
                {timeLeft.days}
              </div>
              <div className="text-xl font-medium opacity-95 drop-shadow">{daysText}</div>
            </div>
          </div>
        </div>

        {/* –î–∞—Ç—ã –æ—Ç–ø—É—Å–∫–∞ */}
        <div className="bg-white/40 rounded-xl py-4 px-5 border border-white/30 backdrop-blur-sm mb-3">
          <div className="text-sm font-medium opacity-80 mb-1">–î–∞—Ç—ã –æ—Ç–ø—É—Å–∫–∞</div>
          <div className="text-base font-semibold">
            {new Date(vacation.startDate).toLocaleDateString('ru-RU')} - {new Date(vacation.endDate).toLocaleDateString('ru-RU')}
          </div>
        </div>

        {/* –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ç–ø—É—Å–∫–∞ */}
        {vacation.destination && (
          <div className="text-sm opacity-70 font-medium">
            üìç {vacation.destination}
          </div>
        )}
      </div>
    </div>
  );
}



================================================================================
–§–ê–ô–õ: contexts/AuthContext.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/contexts/AuthContext.js
–†–ê–ó–ú–ï–†: 5012 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/contexts/AuthContext.js
'use client';

import { createContext, useContext, useState, useEffect } from 'react';

const AuthContext = createContext();

export function AuthProvider({ children }) {
  const [user, setUser] = useState(null);
  const [isLoading, setIsLoading] = useState(true);

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è access —Ç–æ–∫–µ–Ω–∞
  const refreshAccessToken = async () => {
    try {
      const response = await fetch('/api/auth/refresh', {
        method: 'POST',
        credentials: 'include'
      });

      if (response.ok) {
        return true; // –¢–æ–∫–µ–Ω —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω
      } else {
        // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å, —Ä–∞–∑–ª–æ–≥–∏–Ω–∏–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        await logout();
        return false;
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞:', error);
      return false;
    }
  };

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∏—Å—Ç–µ–∫—à–µ–≥–æ —Ç–æ–∫–µ–Ω–∞
  const checkAuth = async () => {
    try {
      const response = await fetch('/api/auth/me', {
        credentials: 'include'
      });

      if (response.ok) {
        const userData = await response.json();
        setUser(userData);
      } else if (response.status === 401) {
        // –¢–æ–∫–µ–Ω –∏—Å—Ç–µ–∫, –ø—ã—Ç–∞–µ–º—Å—è –æ–±–Ω–æ–≤–∏—Ç—å
        const refreshed = await refreshAccessToken();
        if (refreshed) {
          // –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ —Å–Ω–æ–≤–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
          await checkAuth();
        } else {
          setUser(null);
        }
      } else {
        setUser(null);
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', error);
      setUser(null);
    } finally {
      setIsLoading(false);
    }
  };

  useEffect(() => {
    checkAuth();
  }, []);

  const login = async (email, password, rememberMe = false) => {
    try {
      const response = await fetch('/api/auth/login', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email, password, rememberMe }),
        credentials: 'include'
      });

      const data = await response.json();

      if (response.ok) {
        await checkAuth(); // –ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
        return { success: true, user: data.user };
      } else {
        return { success: false, error: data.message };
      }
    } catch (error) {
      return { success: false, error: '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏' };
    }
  };

  const register = async (name, email, password, rememberMe = false) => {
    try {
      const response = await fetch('/api/auth/register', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ name, email, password, rememberMe }),
        credentials: 'include'
      });

      const data = await response.json();

      if (response.ok) {
        await checkAuth(); // –ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
        return { success: true, user: data.user };
      } else {
        return { success: false, error: data.message };
      }
    } catch (error) {
      return { success: false, error: '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏' };
    }
  };

  const logout = async () => {
    try {
      await fetch('/api/auth/logout', {
        method: 'POST',
        credentials: 'include'
      });
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', error);
    } finally {
      setUser(null);
    }
  };

  // –ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏
  const getSessions = async () => {
    try {
      const response = await fetch('/api/auth/sessions', {
        credentials: 'include'
      });

      if (response.ok) {
        return await response.json();
      }
      return { sessions: [] };
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Å—Å–∏–π:', error);
      return { sessions: [] };
    }
  };

  // –£–¥–∞–ª–∏—Ç—å —Å–µ—Å—Å–∏—é
  const deleteSession = async (sessionId) => {
    try {
      const response = await fetch('/api/auth/sessions', {
        method: 'DELETE',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ sessionId }),
        credentials: 'include'
      });

      return response.ok;
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏:', error);
      return false;
    }
  };

  // –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥—Ä—É–≥–∏–µ —Å–µ—Å—Å–∏–∏
  const deleteOtherSessions = async () => {
    try {
      const response = await fetch('/api/auth/sessions/all', {
        method: 'DELETE',
        credentials: 'include'
      });

      return response.ok;
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–π:', error);
      return false;
    }
  };

  const value = {
    user,
    isLoading,
    login,
    register,
    logout,
    checkAuth,
    refreshAccessToken,
    getSessions,
    deleteSession,
    deleteOtherSessions
  };

  return (
    <AuthContext.Provider value={value}>
      {children}
    </AuthContext.Provider>
  );
}

export function useAuth() {
  const context = useContext(AuthContext);
  if (!context) {
    throw new Error('useAuth must be used within an AuthProvider');
  }
  return context;
}



================================================================================
–§–ê–ô–õ: hooks/useAuth.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/hooks/useAuth.js
–†–ê–ó–ú–ï–†: 3550 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/hooks/useAuth.js
'use client';

import { useState, useEffect } from 'react';

export function useAuth() {
  const [user, setUser] = useState(null);
  const [isLoading, setIsLoading] = useState(true);

  useEffect(() => {
    checkAuth();
  }, []);

  const checkAuth = async () => {
    try {
      const response = await fetch('/api/auth/me', {
        credentials: 'include'
      });

      if (response.ok) {
        const userData = await response.json();
        setUser(userData);
      } else {
        setUser(null);
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:', error);
      setUser(null);
    } finally {
      setIsLoading(false);
    }
  };

  const login = async (email, password) => {
    try {
      const response = await fetch('/api/auth/login', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email, password }),
        credentials: 'include'
      });

      const data = await response.json();

      if (response.ok) {
        setUser(data.user);
        return { success: true };
      } else {
        return { success: false, error: data.message };
      }
    } catch (error) {
      return { success: false, error: '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏' };
    }
  };

  const register = async (name, email, password) => {
    try {
      const response = await fetch('/api/auth/register', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ name, email, password }),
        credentials: 'include'
      });

      const data = await response.json();

      if (response.ok) {
        setUser(data.user);
        return { success: true };
      } else {
        return { success: false, error: data.message };
      }
    } catch (error) {
      return { success: false, error: '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏' };
    }
  };

  const logout = async () => {
    try {
      await fetch('/api/auth/logout', {
        method: 'POST',
        credentials: 'include'
      });
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', error);
    } finally {
      setUser(null);
    }
  };

  // –ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏
  const getSessions = async () => {
    try {
      const response = await fetch('/api/auth/sessions', {
        credentials: 'include'
      });

      if (response.ok) {
        return await response.json();
      }
      return { sessions: [] };
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Å—Å–∏–π:', error);
      return { sessions: [] };
    }
  };

  // –£–¥–∞–ª–∏—Ç—å —Å–µ—Å—Å–∏—é
  const deleteSession = async (sessionId) => {
    try {
      const response = await fetch('/api/auth/sessions', {
        method: 'DELETE',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ sessionId }),
        credentials: 'include'
      });

      return response.ok;
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏:', error);
      return false;
    }
  };

  // –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥—Ä—É–≥–∏–µ —Å–µ—Å—Å–∏–∏
  const deleteOtherSessions = async () => {
    try {
      const response = await fetch('/api/auth/sessions/all', {
        method: 'DELETE',
        credentials: 'include'
      });

      return response.ok;
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–π:', error);
      return false;
    }
  };

  return {
    user,
    isLoading,
    login,
    register,
    logout,
    checkAuth,
    getSessions,
    deleteSession,
    deleteOtherSessions
  };
}



================================================================================
–§–ê–ô–õ: lib/auth.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/lib/auth.js
–†–ê–ó–ú–ï–†: 4059 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/lib/auth.js
import jwt from 'jsonwebtoken';
import bcrypt from 'bcryptjs';
import { prisma } from './prisma';

// –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ —Å–µ–∫—Ä–µ—Ç—ã –µ—Å—Ç—å
const JWT_SECRET = process.env.JWT_SECRET || 'your-fallback-secret-key-for-development-only';
const JWT_REFRESH_SECRET = process.env.JWT_REFRESH_SECRET || 'your-fallback-refresh-secret-key-for-development-only';

export async function hashPassword(password) {
  return await bcrypt.hash(password, 12);
}

export async function verifyPassword(password, hashedPassword) {
  return await bcrypt.compare(password, hashedPassword);
}

// –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ access token –¥–æ 1 —á–∞—Å–∞
export function generateAccessToken(userId, sessionId) {
  return jwt.sign({ userId, sessionId }, JWT_SECRET, { expiresIn: '1h' });
}

// –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ refresh token –¥–æ 30 –¥–Ω–µ–π
export function generateRefreshToken() {
  return jwt.sign({}, JWT_REFRESH_SECRET, { expiresIn: '30d' });
}

export function verifyAccessToken(token) {
  try {
    return jwt.verify(token, JWT_SECRET);
  } catch (error) {
    console.error('JWT verification error:', error);
    return null;
  }
}

export function verifyRefreshToken(token) {
  try {
    return jwt.verify(token, JWT_REFRESH_SECRET);
  } catch (error) {
    console.error('Refresh token verification error:', error);
    return null;
  }
}

// –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π "–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è"
export async function createSession(userId, userAgent, ipAddress, isPersistent = false) {
  try {
    const refreshToken = generateRefreshToken();
    
    // –ï—Å–ª–∏ "–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è" - —Å–µ—Å—Å–∏—è –Ω–∞ 1 –≥–æ–¥, –∏–Ω–∞—á–µ –Ω–∞ 30 –¥–Ω–µ–π
    const expiresAt = isPersistent 
      ? new Date(Date.now() + 365 * 24 * 60 * 60 * 1000) // 1 –≥–æ–¥
      : new Date(Date.now() + 30 * 24 * 60 * 60 * 1000); // 30 –¥–Ω–µ–π

    const session = await prisma.session.create({
      data: {
        userId,
        refreshToken,
        userAgent: userAgent || 'Unknown',
        ipAddress: ipAddress || 'Unknown',
        expiresAt,
        isPersistent
      }
    });

    return {
      sessionId: session.id,
      refreshToken,
      accessToken: generateAccessToken(userId, session.id)
    };
  } catch (error) {
    console.error('Error creating session:', error);
    throw error;
  }
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Å—Å–∏–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π persistent —Å–µ—Å—Å–∏–π
export async function verifySession(refreshToken) {
  try {
    const session = await prisma.session.findUnique({
      where: { refreshToken },
      include: { user: true }
    });

    if (!session) {
      return null;
    }

    // –î–ª—è persistent —Å–µ—Å—Å–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–ª–µ–≤–∞–µ–º —Å—Ä–æ–∫
    if (session.isPersistent) {
      const oneYearFromNow = new Date(Date.now() + 365 * 24 * 60 * 60 * 1000);
      if (session.expiresAt < oneYearFromNow) {
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–ª–µ–≤–∞–µ–º persistent —Å–µ—Å—Å–∏—é
        await prisma.session.update({
          where: { id: session.id },
          data: { expiresAt: oneYearFromNow }
        });
      }
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –∏—Å—Ç–µ–∫–ª–∞ –ª–∏ —Å–µ—Å—Å–∏—è
    if (new Date() > session.expiresAt) {
      await prisma.session.delete({ where: { id: session.id } });
      return null;
    }

    return session;
  } catch (error) {
    console.error('Error verifying session:', error);
    return null;
  }
}

// –£–¥–∞–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
export async function deleteSession(sessionId) {
  try {
    await prisma.session.delete({ where: { id: sessionId } });
  } catch (error) {
    console.error('Error deleting session:', error);
  }
}

// –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–µ—Å—Å–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
export async function deleteAllUserSessions(userId) {
  try {
    await prisma.session.deleteMany({ where: { userId } });
  } catch (error) {
    console.error('Error deleting user sessions:', error);
  }
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
export async function getUserSessions(userId) {
  try {
    return await prisma.session.findMany({
      where: { 
        userId,
        expiresAt: { gt: new Date() }
      },
      orderBy: { createdAt: 'desc' }
    });
  } catch (error) {
    console.error('Error getting user sessions:', error);
    return [];
  }
}



================================================================================
–§–ê–ô–õ: lib/prisma.js
–ü–û–õ–ù–´–ô –ü–£–¢–¨: src/lib/prisma.js
–†–ê–ó–ú–ï–†: 272 —Å–∏–º–≤–æ–ª–æ–≤
================================================================================

// src/lib/prisma.js
import { PrismaClient } from '@prisma/client'

const globalForPrisma = global

export const prisma =
  globalForPrisma.prisma ||
  new PrismaClient({
    log: ['query'],
  })

if (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma


